[
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "How to Build a Research Assistant using Deep Agents",
    "partialText": "&lt;p&gt;LangChain's &lt;a href=\"https://github.com/langchain-ai/deepagents\" rel=\"noopener noreferrer\"&gt;Deep Agents&lt;/a&gt; provide a new way to build structured, multi-agent systems that can plan, delegate and reason across multiple steps.&lt;/p&gt;\n\n&lt;p&gt;It comes with planning, a filesystem for context and subagent spawning built in. But connecting that agent to a live frontend and actually showing what’s happening behind the scenes in real time is still surprisingly hard.&lt;/p&gt;\n\n&lt;p&gt;Today, we will build a Deep Agents powered &lt;a href=\"https://go.copilotkit.ai/repo-deep-research-demo\" rel=\"noopener noreferrer\"&gt;research assistant&lt;/a&gt; using Tavily and connect it to a live Next.js UI with &lt;a href=\"http://copilotkit.ai/\" rel=\"noopener noreferrer\"&gt;CopilotKit&lt;/a&gt;, so every step the agent takes streams to the frontend in real time.&lt;/p&gt;\n\n&lt;p&gt;You will find architecture, the key patterns, how state flows between the UI ↔ agent and the step-by-step guide to building this from scratch.&lt;/p&gt;\n\n&lt;p&gt;Let's build it.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F8rnr34smz9hc06d9pyma.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F8rnr34smz9hc06d9pyma.png\" alt=\"deep agents research assistant\" width=\"800\" height=\"452\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  ### What is covered?\n&lt;/h2&gt;\n\n&lt;p&gt;In summary, we are covering these topics in detail.&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;What are Deep Agents?&lt;/li&gt;\n&lt;li&gt;Core Components&lt;/li&gt;\n&lt;li&gt;What are we building?&lt;/li&gt;\n&lt;li&gt;Building Frontend&lt;/li&gt;\n&lt;li&gt;Building Backend (FastAPI + Deep Agents + AG-UI)&lt;/li&gt;\n&lt;li&gt;Running Application&lt;/li&gt;\n&lt;li&gt;Data flow (frontend ↔ Agent)&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;Here is the &lt;a href=\"https://go.copilotkit.ai/repo-deep-research-demo\" rel=\"noopener noreferrer\"&gt;GitHub Repository&lt;/a&gt;, &lt;a href=\"https://go.copilotkit.ai/deep-research-demo\" rel=\"noopener noreferrer\"&gt;deployed link&lt;/a&gt; and &lt;a href=\"https://docs.copilotkit.ai/integrations/langgraph/deep-agents\" rel=\"noopener noreferrer\"&gt;official docs&lt;/a&gt; if you want to explore yourself.&lt;/p&gt;\n\n&lt;p&gt;&lt;iframe width=\"710\" height=\"399\" src=\"https://www.youtube.com/embed/oj3S605DliY\"&gt;\n&lt;/iframe&gt;\n&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  1. What are Deep Agents?\n&lt;/h2&gt;\n\n&lt;p&gt;Most agents today are just “LLM in a loop + tools”. That works but it tends to be shallow: no explicit plan, weak long-horizon execution and messy state as runs get longer.&lt;/p&gt;\n\n&lt;p&gt;Popular agents like &lt;a href=\"https://claude.com/product/claude-code\" rel=\"noopener noreferrer\"&gt;Claude Code&lt;/a&gt;, &lt;a href=\"https://openai.com/index/introducing-deep-research\" rel=\"noopener noreferrer\"&gt;Deep Research&lt;/a&gt; and &lt;a href=\"https://manus.im/\" rel=\"noopener noreferrer\"&gt;Manus&lt;/a&gt; get around this by following a common pattern: they plan first, externalize working context (often via files or a shell) and delegate isolated pieces of work to sub-agents.&lt;/p&gt;\n\n&lt;p&gt;Deep Agents package those primitives into a reusable agent runtime.&lt;/p&gt;\n\n&lt;p&gt;Instead of designing your own agent loop from scratch, you call &lt;code&gt;create_deep_agent(...)&lt;/code&gt; and get a pre-wired execution graph that already knows how to plan, delegate and manage state across many steps.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F19lat0vdgfygvhiwzslu.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F19lat0vdgfygvhiwzslu.png\" alt=\"deep agents\" width=\"800\" height=\"348\"&gt;&lt;/a&gt;&lt;/p&gt;\nCredit: &lt;a href=\"[https://blog.modelcontextprotocol.io/posts/2025-11-21-mcp-apps/](https://blog.langchain.com/deep-agents/)\"&gt;LangChain&lt;/a&gt;\n\n\n\n&lt;p&gt; &lt;/p&gt;\n\n&lt;p&gt;At a practical level, a Deep Agent created via &lt;code&gt;create_deep_agent&lt;/code&gt; is just a LangGraph graph. There’s no separate runtime or hidden orchestration layer.&lt;/p&gt;\n\n&lt;p&gt;The \"context management\" in deep agents is also very practical -- they offload large tool payloads to the filesystem and only fall back to summarization when token usage approaches the model’s context window. You can read more on &lt;a href=\"https://blog.langchain.com/context-management-for-deepagents/\" rel=\"noopener noreferrer\"&gt;Context Management for Deep Agents&lt;/a&gt; blog by LangChain.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fm6zp1g2w4qwm0ib0wd8r.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fm6zp1g2w4qwm0ib0wd8r.png\" alt=\"Offloading large tool results\" width=\"800\" height=\"542\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;h3&gt;\n  \n  \n  The mental model (how it runs)\n&lt;/h3&gt;\n\n&lt;p&gt;Conceptually, the execution flow looks like this:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;User goal\n  ↓\nDeep Agent (LangGraph StateGraph)\n  ├─ Plan: write_todos → updates \"todos\" in state\n  ├─ Delegate: task(...) → runs a subagent with its own tool loop\n  ├─ Context: ls/read_file/write_file/edit_file → persists working notes/artifacts\n  ↓\nFinal answer\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;That gives you a usable structure for “plan → do work → store intermediate artifacts → continue” without inventing your own plan format, memory layer or delegation protocol.&lt;/p&gt;\n\n&lt;p&gt;You can check &lt;a href=\"https://docs.langchain.com/oss/python/deepagents/overview\" rel=\"noopener noreferrer\"&gt;official docs&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt; &lt;/p&gt;\n&lt;h3&gt;\n  \n  \n  Where CopilotKit Fits\n&lt;/h3&gt;\n\n&lt;p&gt;Deep Agents push key parts into explicit state (e.g. &lt;code&gt;todos&lt;/code&gt; + files + messages), which makes runs easier to inspect. That explicit state is also what makes &lt;a href=\"http://copilotkit.ai/\" rel=\"noopener noreferrer\"&gt;Copilotkit&lt;/a&gt; integration possible. &lt;/p&gt;\n\n&lt;p&gt;CopilotKit is a frontend runtime that keeps UI state in sync with agent execution by streaming agent events and state updates in real time (using &lt;a href=\"https://github.com/ag-ui-protocol/ag-ui\" rel=\"noopener noreferrer\"&gt;AG-UI&lt;/a&gt; under the hood).&lt;/p&gt;\n\n&lt;p&gt;This middleware (&lt;code&gt;CopilotKitMiddleware&lt;/code&gt;) is what allows the frontend to stay in lock-step with the agent as it runs. You can read the docs at &lt;a href=\"https://docs.copilotkit.ai/langgraph/deep-agents\" rel=\"noopener noreferrer\"&gt;docs.copilotkit.ai/langgraph/deep-agents&lt;/a&gt;.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight python\"&gt;&lt;code&gt;&lt;span class=\"n\"&gt;agent&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;create_deep_agent&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"n\"&gt;model&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;openai:gpt-4o&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"n\"&gt;tools&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"n\"&gt;get_weather&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n    &lt;span class=\"n\"&gt;middleware&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nc\"&gt;CopilotKitMiddleware&lt;/span&gt;&lt;span class=\"p\"&gt;()],&lt;/span&gt; &lt;span class=\"c1\"&gt;# for frontend tools and context\n&lt;/span&gt;    &lt;span class=\"n\"&gt;system_prompt&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;You are a helpful research assistant.&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;\n&lt;span class=\"p\"&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;h2&gt;\n  \n  \n  2. Core Components\n&lt;/h2&gt;\n\n&lt;p&gt;Here are the core components that we will be using later on:&lt;/p&gt;\n\n&lt;p&gt;1) Planning Tools (built-in via Deep Agents) - built-in planning/to‑do behavior so the agent can break the workflow into steps without you writing a separate planning tool.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight python\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;# Conceptual example (not required in codebase)\n&lt;/span&gt;&lt;span class=\"nd\"&gt;@tool&lt;/span&gt;\n&lt;span class=\"k\"&gt;def&lt;/span&gt; &lt;span class=\"nf\"&gt;todo_write&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;tasks&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"n\"&gt;List&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nb\"&gt;str&lt;/span&gt;&lt;span class=\"p\"&gt;])&lt;/span&gt; &lt;span class=\"o\"&gt;-&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;str&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;\n    &lt;span class=\"n\"&gt;formatted&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"se\"&gt;\\n&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;join&lt;/span&gt;&lt;span class=\"p\"&gt;([&lt;/span&gt;&lt;span class=\"sa\"&gt;f&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;- &lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"n\"&gt;task&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt; &lt;span class=\"k\"&gt;for&lt;/span&gt; &lt;span class=\"n\"&gt;task&lt;/span&gt; &lt;span class=\"ow\"&gt;in&lt;/span&gt; &lt;span class=\"n\"&gt;tasks&lt;/span&gt;&lt;span class=\"p\"&gt;])&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"sa\"&gt;f&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;Todo list created:&lt;/span&gt;&lt;span class=\"se\"&gt;\\n&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"n\"&gt;formatted&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;2) Subagents - let the main agent delegate focused tasks into isolated execution loops. Each sub-agent has its own prompt, tools and context.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight python\"&gt;&lt;code&gt;&lt;span class=\"n\"&gt;subagents&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;[&lt;/span&gt;\n    &lt;span class=\"p\"&gt;{&lt;/span&gt;\n        &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;name&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;job-search-agent&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;description&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;Finds relevant jobs and outputs structured job candidates.&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;system_prompt&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"n\"&gt;JOB_SEARCH_PROMPT&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;tools&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"n\"&gt;internet_search&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;span class=\"p\"&gt;]&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;3) Tools - this is how the agent actually does things. Here, &lt;code&gt;finalize()&lt;/code&gt; signals completion.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight python\"&gt;&lt;code&gt;&lt;span class=\"nd\"&gt;@tool&lt;/span&gt;\n&lt;span class=\"k\"&gt;def&lt;/span&gt; &lt;span class=\"nf\"&gt;finalize&lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;-&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;dict&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;\n    &lt;span class=\"sh\"&gt;\"\"\"&lt;/span&gt;&lt;span class=\"s\"&gt;Signal that the agent is done.&lt;/span&gt;&lt;span class=\"sh\"&gt;\"\"\"&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;status&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;done&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt; &lt;/p&gt;\n&lt;h3&gt;\n  \n  \n  How Deep Agents are implemented (Middleware)\n&lt;/h3&gt;\n\n&lt;p&gt;If you are wondering how &lt;code&gt;create_deep_agent()&lt;/code&gt; actually injects planning, files and subagents into a normal LangGraph agent, the answer is middleware.&lt;/p&gt;\n\n&lt;p&gt;Each feature is implemented as a separate middleware. By default, three are attached:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=\"https://docs.langchain.com/oss/python/deepagents/middleware#to-do-list-middleware\" rel=\"noopener noreferrer\"&gt;To-do list middleware&lt;/a&gt; - adds the &lt;code&gt;write_todos&lt;/code&gt; tool and instructions that push the agent to explicitly plan and update a live todo list during multi-step tasks.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=\"https://docs.langchain.com/oss/python/deepagents/middleware#filesystem-middleware\" rel=\"noopener noreferrer\"&gt;Filesystem middleware&lt;/a&gt; - adds file tools (&lt;code&gt;ls&lt;/code&gt;, &lt;code&gt;read_file&lt;/code&gt;, &lt;code&gt;write_file&lt;/code&gt;, &lt;code&gt;edit_file&lt;/code&gt;) so the agent can externalize notes and artifacts instead of stuffing everything into chat history.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=\"https://docs.langchain.com/oss/python/deepagents/middleware#subagent-middleware\" rel=\"noopener noreferrer\"&gt;Subagent middleware&lt;/a&gt; - adds the &lt;code&gt;task&lt;/code&gt; tool, allowing the main agent to delegate work to subagents with isolated context and their own prompts/tools.&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;This is what makes Deep Agents feel “pre-wired” without introducing a new runtime. If you want to go deeper, the &lt;a href=\"https://docs.langchain.com/oss/python/deepagents/middleware\" rel=\"noopener noreferrer\"&gt;middleware docs&lt;/a&gt; show the exact implementation details.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fazupvw798vmjgp2w5lzz.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fazupvw798vmjgp2w5lzz.png\" alt=\"components involved\" width=\"606\" height=\"331\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n\n&lt;h2&gt;\n  \n  \n  3. What are we building?\n&lt;/h2&gt;\n\n&lt;p&gt;Let's create an agent that: &lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Accepts a research question from the user&lt;/li&gt;\n&lt;li&gt;Uses Deep Agents to plan multi-step and orchestrate sub-agents&lt;/li&gt;\n&lt;li&gt;Searches the web using &lt;a href=\"https://www.tavily.com/\" rel=\"noopener noreferrer\"&gt;Tavily&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;Writes intermediate research artifacts using the filesystem middleware&lt;/li&gt;\n&lt;li&gt;Streams tool results back to the UI via CopilotKit (AG-UI)&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;The interface is a two-panel app where the left side is a CopilotKit chat UI and the right side is a live workspace that shows the agent’s plan, generated files and sources as the agent works. &lt;/p&gt;\n\n&lt;p&gt;Here's a simplified call request → response flow of what will happen:&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;[User asks research question]\n        ↓\nNext.js Frontend (CopilotChat + Workspace)\n        ↓\nCopilotKit Runtime → LangGraphHttpAgent\n        ↓\nPython Backend (FastAPI + AG-UI)\n        ↓\nDeep Agent (research_assistant)\n    ├── write_todos        (planning, built-in)\n    ├── write_file         (filesystem, built-in)\n    ├── read_file          (filesystem, built-in)\n    └── research(query)\n            └── internal Deep Agent [thread-isolated]\n                    └── internet_search (Tavily)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;We will see the concepts in action as we build the agent.&lt;/p&gt;\n\n\n&lt;h2&gt;\n  \n  \n  4. Frontend: wiring the agent to the UI\n&lt;/h2&gt;\n\n&lt;p&gt;Let's first build the frontend part. This is how our directory will look.&lt;/p&gt;\n\n&lt;p&gt;The &lt;code&gt;src&lt;/code&gt; directory hosts the Next.js frontend, including the UI, shared components and the CopilotKit API route (&lt;code&gt;/api/copilotkit&lt;/code&gt;) used for agent communication.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;.\n├── src/                             ← Next.js frontend\n│   ├── app/\n│   │   ├── page.tsx          \n│   │   ├── layout.tsx               ← CopilotKit provider\n│   │   └── api/\n│   │       └── copilotkit/route.ts  ← CopilotKit AG-UI runtime\n│   ├── components/\n│   │   ├── FileViewerModal.tsx      ← Markdown file viewer\n│   │   ├── WorkSpace.tsx            ← Research progress display\n│   │   └── ToolCard.tsx             ← Tool call visualizer\n├── lib/\n│   └── types.ts\n├── package.json                     \n├── next.config.ts                   \n└── README.md  \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;If you don’t have a frontend, you can create a new Next.js app with TypeScript.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight shell\"&gt;&lt;code&gt;// creates a nextjs app  \nnpx create-next-app@latest &lt;span class=\"nb\"&gt;.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fm9if3eh460rjb87zvz06.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fm9if3eh460rjb87zvz06.png\" alt=\"installing next.js frontend\" width=\"626\" height=\"247\"&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;h3&gt;\n  \n  \n  Step 1: CopilotKit Provider &amp;amp; Layout\n&lt;/h3&gt;\n\n&lt;p&gt;Install the necessary CopilotKit packages.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;npm install @copilotkit/react-core @copilotkit/react-ui @copilotkit/runtime\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;@copilotkit/react-core&lt;/code&gt; provides the core React hooks and context that connect your UI to an AG-UI compatible agent backend.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;@copilotkit/react-ui&lt;/code&gt; offers ready-made UI components like &lt;code&gt;&amp;lt;CopilotChat /&amp;gt;&lt;/code&gt; to build AI chat or assistant interfaces quickly.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;@copilotkit/runtime&lt;/code&gt; is the server-side runtime that exposes an API endpoint and bridges the frontend with an AG-UI compatible backend (e.g., a LangGraph HTTP agent).&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F51i4rps9wxwjalnggnap.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F51i4rps9wxwjalnggnap.png\" alt=\"copilotkit packages\" width=\"800\" height=\"291\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;The &lt;code&gt;&amp;lt;CopilotKit&amp;gt;&lt;/code&gt; component must wrap the Copilot-aware parts of your application. In most cases, it's best to place it around the entire app, like in &lt;code&gt;layout.tsx&lt;/code&gt;.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"kd\"&gt;type&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;Metadata&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;next&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;CopilotKit&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;@copilotkit/react-core&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;./globals.css&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;@copilotkit/react-ui/styles.css&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;metadata&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;Metadata&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"na\"&gt;title&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;Deep Research Assistant | CopilotKit Deep Agents Demo&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"na\"&gt;description&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;A research assistant powered by Deep Agents and CopilotKit - demonstrating planning, memory, subagents, and generative UI&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n&lt;span class=\"p\"&gt;};&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"k\"&gt;default&lt;/span&gt; &lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;RootLayout&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;children&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n&lt;span class=\"p\"&gt;}:&lt;/span&gt; &lt;span class=\"nb\"&gt;Readonly&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"na\"&gt;children&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;React&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;ReactNode&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;html&lt;/span&gt; &lt;span class=\"nx\"&gt;lang&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;en&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;body&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;antialiased&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;CopilotKit&lt;/span&gt; &lt;span class=\"nx\"&gt;runtimeUrl&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;/api/copilotkit&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"nx\"&gt;agent&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;research_assistant&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n          &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;children&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/CopilotKit&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/body&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/html&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Here, &lt;code&gt;runtimeUrl=\"/api/copilotkit\"&lt;/code&gt; points to the Next.js API route CopilotKit uses to talk to the agent backend.&lt;/p&gt;\n\n&lt;p&gt;Each page is wrapped in this context so UI components know which agent to invoke and where to send requests.&lt;/p&gt;\n\n&lt;p&gt; &lt;/p&gt;\n&lt;h3&gt;\n  \n  \n  Step 2: Next.js API Route: Proxy to FastAPI\n&lt;/h3&gt;\n\n&lt;p&gt;This Next.js API route acts as a thin proxy between the browser and the Deep Agents. It:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Accepts CopilotKit requests from the UI&lt;/li&gt;\n&lt;li&gt;Forwards them to the agent over AG-UI&lt;/li&gt;\n&lt;li&gt;Streams agent state and events back to the frontend&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Instead of letting the frontend talk to the FastAPI agent directly, all requests go through a single endpoint &lt;code&gt;/api/copilotkit&lt;/code&gt;.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;CopilotRuntime&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;ExperimentalEmptyAdapter&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;copilotRuntimeNextJSAppRouterEndpoint&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;@copilotkit/runtime&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;LangGraphHttpAgent&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;@copilotkit/runtime/langgraph&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;NextRequest&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;next/server&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"c1\"&gt;// Empty adapter since the LLM is handled by the remote agent&lt;/span&gt;\n&lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;serviceAdapter&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;ExperimentalEmptyAdapter&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n\n&lt;span class=\"c1\"&gt;// Configure CopilotKit runtime with the Deep Agents backend&lt;/span&gt;\n&lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;runtime&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;CopilotRuntime&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt;\n  &lt;span class=\"na\"&gt;agents&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"na\"&gt;research_assistant&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;LangGraphHttpAgent&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt;\n      &lt;span class=\"na\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;process&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;env&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;LANGGRAPH_DEPLOYMENT_URL&lt;/span&gt; &lt;span class=\"o\"&gt;||&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;http://localhost:8123&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}),&lt;/span&gt;\n  &lt;span class=\"p\"&gt;},&lt;/span&gt;\n&lt;span class=\"p\"&gt;});&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;POST&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;async &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;req&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;NextRequest&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;handleRequest&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;copilotRuntimeNextJSAppRouterEndpoint&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt;\n    &lt;span class=\"nx\"&gt;runtime&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"nx\"&gt;serviceAdapter&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"na\"&gt;endpoint&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;/api/copilotkit&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"p\"&gt;});&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"nf\"&gt;handleRequest&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;req&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;};&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Here's a simple explanation of the above code:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;The code above registers the &lt;code&gt;research_assistant&lt;/code&gt; agent.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;LangGraphHttpAgent&lt;/code&gt; : defines a remote LangGraph agent endpoint. It points to the Deep Agents backend running on FastAPI.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;ExperimentalEmptyAdapter&lt;/code&gt; : simple no-op adapter used when the agent backend handles its own LLM calls and orchestration&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;copilotRuntimeNextJSAppRouterEndpoint&lt;/code&gt; : small helper that adapts the Copilot runtime to a Next.js App Router API route and returns a &lt;code&gt;handleRequest&lt;/code&gt; function&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt; &lt;/p&gt;\n&lt;h3&gt;\n  \n  \n  Step 3: Types (Research State)\n&lt;/h3&gt;\n\n&lt;p&gt;Before building components, let's define shared state for todos, files, and sources in &lt;code&gt;lib/types/research.ts&lt;/code&gt;. These are the contracts between the tool results from the agent and the local React state.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;// Uses local state + useDefaultTool instead of CoAgent (avoids type issues with Python FilesystemMiddleware)&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kr\"&gt;interface&lt;/span&gt; &lt;span class=\"nx\"&gt;Todo&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;id&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;status&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;pending&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;in_progress&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;completed&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kr\"&gt;interface&lt;/span&gt; &lt;span class=\"nx\"&gt;ResearchFile&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;path&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;createdAt&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n&lt;span class=\"c1\"&gt;// Sources found via internet_search (includes content)&lt;/span&gt;\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kr\"&gt;interface&lt;/span&gt; &lt;span class=\"nx\"&gt;Source&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;title&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;?:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;status&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;found&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;scraped&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;failed&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kr\"&gt;interface&lt;/span&gt; &lt;span class=\"nx\"&gt;ResearchState&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;Todo&lt;/span&gt;&lt;span class=\"p\"&gt;[];&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;ResearchFile&lt;/span&gt;&lt;span class=\"p\"&gt;[];&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;Source&lt;/span&gt;&lt;span class=\"p\"&gt;[];&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;INITIAL_STATE&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;ResearchState&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"na\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;[],&lt;/span&gt;\n  &lt;span class=\"na\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;[],&lt;/span&gt;\n  &lt;span class=\"na\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;[],&lt;/span&gt;\n&lt;span class=\"p\"&gt;};&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Instead of dumping raw tool JSON into chat, each tool result routes into a dedicated state slot - &lt;code&gt;write_todos&lt;/code&gt; updates &lt;code&gt;todos&lt;/code&gt;, &lt;code&gt;write_file&lt;/code&gt; appends to &lt;code&gt;files&lt;/code&gt; and &lt;code&gt;research&lt;/code&gt; appends to &lt;code&gt;sources&lt;/code&gt;. This becomes the foundation of the Workspace panel.&lt;/p&gt;\n\n&lt;p&gt; &lt;/p&gt;\n&lt;h3&gt;\n  \n  \n  Step 4: Building Key Components\n&lt;/h3&gt;\n\n&lt;p&gt;I'm only covering the core logic behind each component since the overall code is huge. You can find all the components in the repository at &lt;a href=\"https://github.com/CopilotKit/deep-agents-demo/tree/main/src/components\" rel=\"noopener noreferrer\"&gt;&lt;code&gt;src/components&lt;/code&gt;&lt;/a&gt;. &lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;✅ ToolCard Component&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;This is the client component that renders every tool call inline inside chat. It has two modes:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;SpecializedToolCard&lt;/code&gt; for known tools (&lt;code&gt;write_todos&lt;/code&gt;, &lt;code&gt;research&lt;/code&gt;, &lt;code&gt;write_file&lt;/code&gt;, &lt;code&gt;read_file&lt;/code&gt;) with icons, status indicators and result previews&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;DefaultToolCard&lt;/code&gt; for unknown tools that fall back to expandable JSON.&lt;br&gt;\n&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;use client&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;useState&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;react&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;Pencil&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;ClipboardList&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;Search&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;Save&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;BookOpen&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;Check&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;ChevronDown&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;lucide-react&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;TOOL_CONFIG&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"na\"&gt;write_todos&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"na\"&gt;icon&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;Pencil&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"na\"&gt;getDisplayText&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;Updating research plan...&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"na\"&gt;getResultSummary&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;result&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;todos&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;args&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;?:&lt;/span&gt; &lt;span class=\"nx\"&gt;unknown&lt;/span&gt;&lt;span class=\"p\"&gt;[]&lt;/span&gt; &lt;span class=\"p\"&gt;})?.&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n      &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nb\"&gt;Array&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;isArray&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;))&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n        &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt; todo&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt; &lt;span class=\"o\"&gt;!==&lt;/span&gt; &lt;span class=\"mi\"&gt;1&lt;/span&gt; &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;s&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt; updated`&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n      &lt;span class=\"p\"&gt;}&lt;/span&gt;\n      &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"kc\"&gt;null&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n    &lt;span class=\"p\"&gt;},&lt;/span&gt;\n  &lt;span class=\"p\"&gt;},&lt;/span&gt;\n  &lt;span class=\"na\"&gt;research&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"na\"&gt;icon&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;Search&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"na\"&gt;getDisplayText&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt;\n      &lt;span class=\"s2\"&gt;`Researching: &lt;/span&gt;&lt;span class=\"p\"&gt;${((&lt;/span&gt;&lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;query&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;||&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;...&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;).&lt;/span&gt;&lt;span class=\"nf\"&gt;slice&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"mi\"&gt;50&lt;/span&gt;&lt;span class=\"p\"&gt;)}${(&lt;/span&gt;&lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;query&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;)?.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt; &lt;span class=\"mi\"&gt;50&lt;/span&gt; &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;...&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"na\"&gt;getResultSummary&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;result&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"k\"&gt;typeof&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;object&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;sources&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"k\"&gt;in&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n        &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;sources&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"na\"&gt;summary&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt; &lt;span class=\"nl\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;unknown&lt;/span&gt;&lt;span class=\"p\"&gt;[]&lt;/span&gt; &lt;span class=\"p\"&gt;};&lt;/span&gt;\n        &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"s2\"&gt;`Found &lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt; source&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt; &lt;span class=\"o\"&gt;!==&lt;/span&gt; &lt;span class=\"mi\"&gt;1&lt;/span&gt; &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;s&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n      &lt;span class=\"p\"&gt;}&lt;/span&gt;\n      &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;Research complete&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n    &lt;span class=\"p\"&gt;},&lt;/span&gt;\n  &lt;span class=\"p\"&gt;},&lt;/span&gt;\n  &lt;span class=\"na\"&gt;write_file&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"na\"&gt;icon&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;Save&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"na\"&gt;getDisplayText&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;path&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;path&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"kc\"&gt;undefined&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n      &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;filename&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;path&lt;/span&gt;&lt;span class=\"p\"&gt;?.&lt;/span&gt;&lt;span class=\"nf\"&gt;split&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;/&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;).&lt;/span&gt;&lt;span class=\"nf\"&gt;pop&lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;||&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;filename&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"kc\"&gt;undefined&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n      &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"s2\"&gt;`Writing: &lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;filename&lt;/span&gt; &lt;span class=\"o\"&gt;||&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;file&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n    &lt;span class=\"p\"&gt;},&lt;/span&gt;\n    &lt;span class=\"na\"&gt;getResultSummary&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;_result&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;content&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;content&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"kc\"&gt;undefined&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n      &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n        &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;firstLine&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;split&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"se\"&gt;\\n&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)[&lt;/span&gt;&lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;].&lt;/span&gt;&lt;span class=\"nf\"&gt;slice&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"mi\"&gt;50&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n        &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"nx\"&gt;firstLine&lt;/span&gt; &lt;span class=\"o\"&gt;+&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt; &lt;span class=\"mi\"&gt;50&lt;/span&gt; &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;...&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n      &lt;span class=\"p\"&gt;}&lt;/span&gt;\n      &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;File written&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n    &lt;span class=\"p\"&gt;},&lt;/span&gt;\n  &lt;span class=\"p\"&gt;},&lt;/span&gt;\n  &lt;span class=\"c1\"&gt;// read_todos, read_file follow the same pattern&lt;/span&gt;\n&lt;span class=\"p\"&gt;};&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;ToolCard&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;status&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"p\"&gt;}:&lt;/span&gt; &lt;span class=\"nx\"&gt;ToolCardProps&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;config&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;TOOL_CONFIG&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;];&lt;/span&gt;\n  &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;config&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;SpecializedToolCard&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;status&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;status&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;result&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;result&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;config&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;config&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n      &lt;span class=\"sr\"&gt;/&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;    &lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"p\"&gt;}&lt;/span&gt;\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;DefaultToolCard&lt;/span&gt; &lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"nx\"&gt;status&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;status&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;result&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"sr\"&gt;/&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Here's a brief explanation:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;research&lt;/code&gt; and &lt;code&gt;write_todos&lt;/code&gt; are expandable, clicking reveals the full query + findings or the live todo checklist with &lt;code&gt;pending&lt;/code&gt; / &lt;code&gt;inprogress&lt;/code&gt; / &lt;code&gt;completed&lt;/code&gt; states.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;resultSummary&lt;/code&gt; appears as a small green line below the display text so you can glance at the output without expanding.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;DefaultToolCard&lt;/code&gt; handles any tool not in &lt;code&gt;TOOL_CONFIG&lt;/code&gt;, showing collapsible args and result JSON.&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;In this component, &lt;code&gt;ExpandedDetails&lt;/code&gt; handles the per-tool expanded view. &lt;code&gt;research&lt;/code&gt; and &lt;code&gt;write_todos&lt;/code&gt; get structured layouts; everything else falls back to a JSON pre block.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;ExpandedDetails&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt; &lt;span class=\"p\"&gt;})&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;name&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;research&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;summary&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;typeof&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;object&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;summary&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"k\"&gt;in&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt;\n      &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"kr\"&gt;any&lt;/span&gt;&lt;span class=\"p\"&gt;).&lt;/span&gt;&lt;span class=\"nx\"&gt;summary&lt;/span&gt;\n      &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;p&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"nx\"&gt;Query&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;query&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/p&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;p&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;summary&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/p&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;    &lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;name&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;write_todos&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;todos&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;args&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"kr\"&gt;any&lt;/span&gt;&lt;span class=\"p\"&gt;)?.&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;?.&lt;/span&gt;&lt;span class=\"nf\"&gt;map&lt;/span&gt;&lt;span class=\"p\"&gt;((&lt;/span&gt;&lt;span class=\"na\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;any&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"na\"&gt;i&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;number&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;\n          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;key&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;id&lt;/span&gt; &lt;span class=\"o\"&gt;||&lt;/span&gt; &lt;span class=\"nx\"&gt;i&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;span&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;status&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;completed&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;✓&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;status&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;inprogress&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;●&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;○&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/span&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;span&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/span&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;        &lt;span class=\"p\"&gt;))}&lt;/span&gt;\n      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;    &lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n  &lt;span class=\"c1\"&gt;// Fallback&lt;/span&gt;\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;pre&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n      &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"k\"&gt;typeof&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;string&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;JSON&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;stringify&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;result&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"kc\"&gt;null&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"mi\"&gt;2&lt;/span&gt;&lt;span class=\"p\"&gt;)}&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/pre&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Check out the complete code at &lt;a href=\"https://github.com/CopilotKit/deep-agents-demo/blob/main/src/components/ToolCard.tsx\" rel=\"noopener noreferrer\"&gt;src/components/ToolCard.tsx&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt; &lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;✅ Workspace Component&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;This is the right-side panel that displays research progress as it happens. It has three collapsible sections: Research Plan, Files and Sources - each with a live badge count and an empty state when nothing has arrived yet.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;Workspace&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"nx\"&gt;state&lt;/span&gt; &lt;span class=\"p\"&gt;}:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nl\"&gt;state&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;ResearchState&lt;/span&gt; &lt;span class=\"p\"&gt;})&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;sources&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;state&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;fileCount&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"err\"&gt; &lt;/span&gt; &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;todoCount&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"err\"&gt; &lt;/span&gt; &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;sourceCount&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"err\"&gt; &lt;/span&gt; \n&lt;span class=\"err\"&gt; &lt;/span&gt; &lt;span class=\"c1\"&gt;// State for file viewer modal&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nx\"&gt;selectedFile&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;setSelectedFile&lt;/span&gt;&lt;span class=\"p\"&gt;]&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;useState&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;ResearchFile&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"kc\"&gt;null&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"kc\"&gt;null&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;workspace-panel p-6&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;mb-6&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;h2&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;text-xl font-bold&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"nx\"&gt;Workspace&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/h2&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;p&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;text-sm&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"nx\"&gt;Research&lt;/span&gt; &lt;span class=\"nx\"&gt;progress&lt;/span&gt; &lt;span class=\"nx\"&gt;and&lt;/span&gt; &lt;span class=\"nx\"&gt;artifacts&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/p&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;Section&lt;/span&gt; &lt;span class=\"nx\"&gt;title&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;Research Plan&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"nx\"&gt;icon&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;ListTodo&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"nx\"&gt;badge&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;TodoList&lt;/span&gt; &lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"sr\"&gt;/&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/Section&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;Section&lt;/span&gt; &lt;span class=\"nx\"&gt;title&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;Files&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"nx\"&gt;icon&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;FileText&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"nx\"&gt;badge&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;FileList&lt;/span&gt; &lt;span class=\"nx\"&gt;files&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"nx\"&gt;onFileClick&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;setSelectedFile&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"sr\"&gt;/&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/Section&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;Section&lt;/span&gt; &lt;span class=\"nx\"&gt;title&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;Sources&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"nx\"&gt;icon&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;Globe&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"nx\"&gt;badge&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;SourceList&lt;/span&gt; &lt;span class=\"nx\"&gt;sources&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"sr\"&gt;/&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/Section&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;FileViewerModal&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;selectedFile&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;onClose&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nf\"&gt;setSelectedFile&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"kc\"&gt;null&lt;/span&gt;&lt;span class=\"p\"&gt;)}&lt;/span&gt;\n      &lt;span class=\"sr\"&gt;/&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n&lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;TodoList&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"nx\"&gt;todos&lt;/span&gt; &lt;span class=\"p\"&gt;}:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nl\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;Todo&lt;/span&gt;&lt;span class=\"p\"&gt;[]&lt;/span&gt; &lt;span class=\"p\"&gt;})&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&amp;gt;; /&lt;/span&gt;&lt;span class=\"o\"&gt;/&lt;/span&gt; &lt;span class=\"nx\"&gt;empty&lt;/span&gt; &lt;span class=\"nx\"&gt;state&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;space-y-1&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n      &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;map&lt;/span&gt;&lt;span class=\"p\"&gt;((&lt;/span&gt;&lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt;\n          &lt;span class=\"nx\"&gt;key&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;id&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n          &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"s2\"&gt;`todo-item &lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;\n            &lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;status&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;completed&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;\n              &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;todo-item-completed&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;\n              &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;status&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;in_progress&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;\n                &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;todo-item-inprogress&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;\n                &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;todo-item-pending&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;\n          &lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;span&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"cm\"&gt;/* Check / CircleDot / Circle icon based on status */&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/span&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;span&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;text-sm&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/span&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"p\"&gt;))}&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n&lt;span class=\"c1\"&gt;// FileList — same pattern, items are clickable (onFileClick)&lt;/span&gt;\n&lt;span class=\"c1\"&gt;// each row has a download button with e.stopPropagation()&lt;/span&gt;\n&lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;FileList&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;onFileClick&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n&lt;span class=\"p\"&gt;}:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;ResearchFile&lt;/span&gt;&lt;span class=\"p\"&gt;[];&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;onFileClick&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;ResearchFile&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"k\"&gt;void&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"p\"&gt;})&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&amp;gt;; /&lt;/span&gt;&lt;span class=\"o\"&gt;/&lt;/span&gt; &lt;span class=\"nx\"&gt;empty&lt;/span&gt; &lt;span class=\"nx\"&gt;state&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;space-y-2&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n      &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;map&lt;/span&gt;&lt;span class=\"p\"&gt;((&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;i&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt;\n          &lt;span class=\"nx\"&gt;key&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;path&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;-&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;i&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n          &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;file-item&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;\n          &lt;span class=\"nx\"&gt;onClick&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nf\"&gt;onFileClick&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;)}&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;flex items-center gap-3&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"cm\"&gt;/* FileText icon */&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n              &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;p&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;text-sm font-medium&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n                &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;path&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;split&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;/&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;).&lt;/span&gt;&lt;span class=\"nf\"&gt;pop&lt;/span&gt;&lt;span class=\"p\"&gt;()}&lt;/span&gt;\n              &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/p&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;              &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;p&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;text-xs&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;path&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/p&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;button&lt;/span&gt;\n            &lt;span class=\"nx\"&gt;onClick&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n              &lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;stopPropagation&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n              &lt;span class=\"nf\"&gt;downloadFile&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n            &lt;span class=\"p\"&gt;}}&lt;/span&gt;\n          &lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"cm\"&gt;/* Download icon */&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/button&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"p\"&gt;))}&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n&lt;span class=\"c1\"&gt;// SourceList — same pattern, colour-codes by source.status &lt;/span&gt;\n&lt;span class=\"c1\"&gt;// (scraped → green check, failed → red X, found → grey circle) &lt;/span&gt;\n&lt;span class=\"c1\"&gt;// each source links to source.url&lt;/span&gt;\n&lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;SourceList&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"nx\"&gt;sources&lt;/span&gt; &lt;span class=\"p\"&gt;}:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nl\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;Source&lt;/span&gt;&lt;span class=\"p\"&gt;[]&lt;/span&gt; &lt;span class=\"p\"&gt;})&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&amp;gt;; /&lt;/span&gt;&lt;span class=\"o\"&gt;/&lt;/span&gt; &lt;span class=\"nx\"&gt;empty&lt;/span&gt; &lt;span class=\"nx\"&gt;state&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;space-y-2&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n      &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;map&lt;/span&gt;&lt;span class=\"p\"&gt;((&lt;/span&gt;&lt;span class=\"nx\"&gt;source&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;i&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt;\n          &lt;span class=\"nx\"&gt;key&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;source&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;-&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;i&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n          &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"s2\"&gt;`file-item &lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;source&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;status&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;failed&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;source-failed&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;span&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"cm\"&gt;/* Check / X / Circle based on source.status */&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/span&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;flex-1 min-w-0&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;p&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;text-sm font-medium truncate&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n              &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;source&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;title&lt;/span&gt; &lt;span class=\"o\"&gt;||&lt;/span&gt; &lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;URL&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;source&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;).&lt;/span&gt;&lt;span class=\"nx\"&gt;hostname&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/p&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;a&lt;/span&gt;\n              &lt;span class=\"nx\"&gt;href&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;source&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n              &lt;span class=\"nx\"&gt;target&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;_blank&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;\n              &lt;span class=\"nx\"&gt;rel&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;noopener noreferrer&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;\n              &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;text-xs truncate block&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;\n            &lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n              &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;source&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/a&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"p\"&gt;))}&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;A brief explanation:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;TodoList&lt;/code&gt; renders each todo with a &lt;code&gt;pending&lt;/code&gt; / &lt;code&gt;inprogress&lt;/code&gt; / &lt;code&gt;completed&lt;/code&gt; icon. Completed items get a strikethrough.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;FileList&lt;/code&gt; items are clickable: they open &lt;code&gt;FileViewerModal&lt;/code&gt; with full Markdown rendering and a download button.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;SourceList&lt;/code&gt; colour-codes sources: green check for scraped, red X for failed, grey circle for found-but-not-yet-scraped.&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Check out the complete code at &lt;a href=\"https://github.com/CopilotKit/deep-agents-demo/blob/main/src/components/Workspace.tsx\" rel=\"noopener noreferrer\"&gt;&lt;code&gt;src/components/WorkSpace.tsx&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt; &lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;✅ FileViewerModal Component&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;This component renders a modal that displays the contents of a research file written by the Deep Agent. It renders file content as formatted Markdown using the &lt;a href=\"https://www.npmjs.com/package/react-markdown\" rel=\"noopener noreferrer\"&gt;&lt;code&gt;react-markdown&lt;/code&gt;&lt;/a&gt; package.&lt;/p&gt;\n\n&lt;p&gt;Install it using the following command.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;npm install react-markdown\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Here is the full core implementation:&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;FileViewerModal&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;onClose&lt;/span&gt; &lt;span class=\"p\"&gt;}:&lt;/span&gt; &lt;span class=\"nx\"&gt;FileViewerModalProps&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;useCallback&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;KeyboardEvent&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;Escape&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"nf\"&gt;onClose&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt; &lt;span class=\"p\"&gt;},&lt;/span&gt;\n    &lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nx\"&gt;onClose&lt;/span&gt;&lt;span class=\"p\"&gt;]&lt;/span&gt;\n  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n\n  &lt;span class=\"nf\"&gt;useEffect&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"nb\"&gt;document&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;addEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n      &lt;span class=\"nb\"&gt;document&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;body&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;style&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;overflow&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;hidden&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"nb\"&gt;document&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;removeEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n      &lt;span class=\"nb\"&gt;document&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;body&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;style&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;overflow&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"dl\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n    &lt;span class=\"p\"&gt;};&lt;/span&gt;\n  &lt;span class=\"p\"&gt;},&lt;/span&gt; &lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt;&lt;span class=\"p\"&gt;]);&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"o\"&gt;!&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"kc\"&gt;null&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;filename&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;path&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;split&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;/&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;).&lt;/span&gt;&lt;span class=\"nf\"&gt;pop&lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;||&lt;/span&gt; &lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;path&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;handleDownload&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;blob&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;Blob&lt;/span&gt;&lt;span class=\"p\"&gt;([&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"na\"&gt;type&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;text/markdown&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;});&lt;/span&gt;\n    &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;url&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;URL&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;createObjectURL&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;blob&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;a&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nb\"&gt;document&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;createElement&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;a&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"nx\"&gt;a&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;href&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n    &lt;span class=\"nx\"&gt;a&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;download&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;filename&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n    &lt;span class=\"nb\"&gt;document&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;body&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;appendChild&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;a&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"nx\"&gt;a&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;click&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n    &lt;span class=\"nb\"&gt;document&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;body&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;removeChild&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;a&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"nx\"&gt;URL&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;revokeObjectURL&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"p\"&gt;};&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;fixed inset-0 z-50 flex items-center justify-center p-4&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;absolute inset-0 bg-black/30 backdrop-blur-sm&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"nx\"&gt;onClick&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;onClose&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"nx\"&gt;aria&lt;/span&gt;&lt;span class=\"o\"&gt;-&lt;/span&gt;&lt;span class=\"nx\"&gt;hidden&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;true&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;/&amp;gt;&lt;/span&gt;\n      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;relative max-w-3xl w-full max-h-[85vh] flex flex-col&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"nx\"&gt;role&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;dialog&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"nx\"&gt;aria&lt;/span&gt;&lt;span class=\"o\"&gt;-&lt;/span&gt;&lt;span class=\"nx\"&gt;modal&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;true&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"cm\"&gt;/* Header -- filename + download + close */&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;flex items-center justify-between border-b ...&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;flex items-center gap-3&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"cm\"&gt;/* FileText icon */&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;h2&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;truncate max-w-md&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;filename&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/h2&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;flex items-center gap-2&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;button&lt;/span&gt; &lt;span class=\"nx\"&gt;onClick&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;handleDownload&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/button&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;button&lt;/span&gt; &lt;span class=\"nx\"&gt;onClick&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;onClose&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/button&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;\n        &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"cm\"&gt;/* Scrollable Markdown body */&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;flex-1 overflow-y-auto p-8&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;prose prose-sm prose-slate max-w-none&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;ReactMarkdown&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/ReactMarkdown&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;\n        &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"cm\"&gt;/* Footer -- full file path */&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;border-t ...&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;code&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;file&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;path&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/code&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Here's a brief explanation:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;useEffect&lt;/code&gt; registers the &lt;code&gt;Escape&lt;/code&gt; listener and locks body scroll only when a file is open, and cleans both up on close.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;handleDownload&lt;/code&gt; creates a temporary anchor element to trigger a browser download without any server round-trip.&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Check out the complete code at &lt;a href=\"https://github.com/CopilotKit/deep-agents-demo/blob/main/src/components/FileViewerModal.tsx\" rel=\"noopener noreferrer\"&gt;&lt;code&gt;src/components/FileViewerModal.tsx&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt; &lt;/p&gt;\n&lt;h3&gt;\n  \n  \n  Step 5: Connecting the Chat UI to the Agent\n&lt;/h3&gt;\n\n&lt;p&gt;At this point, all the pieces are in place. This page owns &lt;code&gt;ResearchState&lt;/code&gt;, passes it to &lt;code&gt;Workspace&lt;/code&gt;, uses &lt;a href=\"https://docs.copilotkit.ai/reference/v1/components/chat/CopilotChat\" rel=\"noopener noreferrer\"&gt;CopilotChat&lt;/a&gt; component for the conversational UI, runs &lt;code&gt;useDefaultTool&lt;/code&gt; to intercept every tool call and routes results into state.&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;code&gt;research&lt;/code&gt; → appends to &lt;code&gt;sources&lt;/code&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;code&gt;write_todos&lt;/code&gt; → replaces &lt;code&gt;todos&lt;/code&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;code&gt;write_file&lt;/code&gt; → appends to &lt;code&gt;files&lt;/code&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Here's the code.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;use client&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;useState&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;useRef&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;react&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;CopilotChat&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;@copilotkit/react-ui&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;useDefaultTool&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;@copilotkit/react-core&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;Workspace&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;@/components/Workspace&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;ResearchState&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;INITIAL_STATE&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;Todo&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;@/types/research&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;ToolCard&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;@/components/ToolCard&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"k\"&gt;default&lt;/span&gt; &lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;Page&lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nx\"&gt;state&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;setState&lt;/span&gt;&lt;span class=\"p\"&gt;]&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;useState&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;ResearchState&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;INITIAL_STATE&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;processedKeysRef&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;useRef&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nb\"&gt;Set&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;Set&lt;/span&gt;&lt;span class=\"p\"&gt;());&lt;/span&gt;\n\n  &lt;span class=\"nf\"&gt;useDefaultTool&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt;\n    &lt;span class=\"na\"&gt;render&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;props&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;status&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;props&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n      &lt;span class=\"c1\"&gt;// Deduplicate on re-renders&lt;/span&gt;\n      &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;status&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;complete&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n        &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;resultStr&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"nx\"&gt;JSON&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;stringify&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;result&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n        &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;resultHash&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;resultStr&lt;/span&gt;\n          &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;resultStr&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;-&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;resultStr&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;slice&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"mi\"&gt;100&lt;/span&gt;&lt;span class=\"p\"&gt;)}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;\n          &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n        &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;key&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;-&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;JSON&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;stringify&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;)}&lt;/span&gt;&lt;span class=\"s2\"&gt;-&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;resultHash&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n        &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;processedKeysRef&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;current&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;has&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt;&lt;span class=\"p\"&gt;))&lt;/span&gt; &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;ToolCard&lt;/span&gt; &lt;span class=\"p\"&gt;{...&lt;/span&gt;&lt;span class=\"nx\"&gt;props&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"sr\"&gt;/&amp;gt;&lt;/span&gt;&lt;span class=\"err\"&gt;;\n&lt;/span&gt;        &lt;span class=\"nx\"&gt;processedKeysRef&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;current&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;add&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n      &lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n      &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;name&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;research&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;status&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;complete&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n        &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;researchResult&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;result&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n          &lt;span class=\"na\"&gt;summary&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n          &lt;span class=\"nl\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nb\"&gt;Array&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;\n            &lt;span class=\"na\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n            &lt;span class=\"nl\"&gt;title&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n            &lt;span class=\"nl\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;?:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n            &lt;span class=\"nl\"&gt;status&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;found&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;scraped&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;failed&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n          &lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n        &lt;span class=\"p\"&gt;};&lt;/span&gt;\n        &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;researchResult&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;sources&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;researchResult&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;length&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt; &lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n          &lt;span class=\"nf\"&gt;queueMicrotask&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt;\n            &lt;span class=\"nf\"&gt;setState&lt;/span&gt;&lt;span class=\"p\"&gt;((&lt;/span&gt;&lt;span class=\"nx\"&gt;prev&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;({&lt;/span&gt;\n              &lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"nx\"&gt;prev&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n              &lt;span class=\"na\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;[...&lt;/span&gt;&lt;span class=\"nx\"&gt;prev&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"nx\"&gt;researchResult&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n            &lt;span class=\"p\"&gt;})),&lt;/span&gt;\n          &lt;span class=\"p\"&gt;);&lt;/span&gt;\n        &lt;span class=\"p\"&gt;}&lt;/span&gt;\n      &lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n      &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;name&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;write_todos&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;status&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;complete&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;?.&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n        &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;todosWithIds&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;\n          &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;todos&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"nb\"&gt;Array&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;id&lt;/span&gt;&lt;span class=\"p\"&gt;?:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt; &lt;span class=\"nl\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt; &lt;span class=\"nl\"&gt;status&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"p\"&gt;).&lt;/span&gt;&lt;span class=\"nf\"&gt;map&lt;/span&gt;&lt;span class=\"p\"&gt;((&lt;/span&gt;&lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;index&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;({&lt;/span&gt;\n          &lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n          &lt;span class=\"na\"&gt;id&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;todo&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;id&lt;/span&gt; &lt;span class=\"o\"&gt;||&lt;/span&gt; &lt;span class=\"s2\"&gt;`todo-&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nb\"&gt;Date&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;now&lt;/span&gt;&lt;span class=\"p\"&gt;()}&lt;/span&gt;&lt;span class=\"s2\"&gt;-&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;index&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"p\"&gt;}));&lt;/span&gt;\n        &lt;span class=\"nf\"&gt;queueMicrotask&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt;\n          &lt;span class=\"nf\"&gt;setState&lt;/span&gt;&lt;span class=\"p\"&gt;((&lt;/span&gt;&lt;span class=\"nx\"&gt;prev&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"nx\"&gt;prev&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"na\"&gt;todos&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;todosWithIds&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"nx\"&gt;Todo&lt;/span&gt;&lt;span class=\"p\"&gt;[]&lt;/span&gt; &lt;span class=\"p\"&gt;})),&lt;/span&gt;\n        &lt;span class=\"p\"&gt;);&lt;/span&gt;\n      &lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n      &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;name&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;write_file&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;status&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;complete&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;?.&lt;/span&gt;&lt;span class=\"nx\"&gt;file_path&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n        &lt;span class=\"nf\"&gt;queueMicrotask&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt;\n          &lt;span class=\"nf\"&gt;setState&lt;/span&gt;&lt;span class=\"p\"&gt;((&lt;/span&gt;&lt;span class=\"nx\"&gt;prev&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;({&lt;/span&gt;\n            &lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"nx\"&gt;prev&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n            &lt;span class=\"na\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;[&lt;/span&gt;\n              &lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"nx\"&gt;prev&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;files&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n              &lt;span class=\"p\"&gt;{&lt;/span&gt;\n                &lt;span class=\"na\"&gt;path&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;file_path&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n                &lt;span class=\"na\"&gt;content&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;content&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n                &lt;span class=\"na\"&gt;createdAt&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;Date&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;toISOString&lt;/span&gt;&lt;span class=\"p\"&gt;(),&lt;/span&gt;\n              &lt;span class=\"p\"&gt;},&lt;/span&gt;\n            &lt;span class=\"p\"&gt;],&lt;/span&gt;\n          &lt;span class=\"p\"&gt;})),&lt;/span&gt;\n        &lt;span class=\"p\"&gt;);&lt;/span&gt;\n      &lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n      &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;ToolCard&lt;/span&gt; &lt;span class=\"p\"&gt;{...&lt;/span&gt;&lt;span class=\"nx\"&gt;props&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"sr\"&gt;/&amp;gt;&lt;/span&gt;&lt;span class=\"err\"&gt;;\n&lt;/span&gt;    &lt;span class=\"p\"&gt;},&lt;/span&gt;\n  &lt;span class=\"p\"&gt;});&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;relative min-h-screen&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;main&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;relative z-10 h-screen flex overflow-hidden&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"cm\"&gt;/* Chat panel -- left side */&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;w-[38%] h-full border-r flex flex-col&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n          &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"cm\"&gt;/* Header */&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;style&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{{&lt;/span&gt; &lt;span class=\"na\"&gt;flex&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"mi\"&gt;1&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"na\"&gt;minHeight&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"na\"&gt;overflow&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;hidden&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;}}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;CopilotChat&lt;/span&gt;\n              &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;h-full&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;\n              &lt;span class=\"nx\"&gt;labels&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{{&lt;/span&gt;\n                &lt;span class=\"na\"&gt;title&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;Deep Research Assistant&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n                &lt;span class=\"na\"&gt;initial&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;What topic would you like me to research?&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n                &lt;span class=\"na\"&gt;placeholder&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;Ask me to research any topic...&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n              &lt;span class=\"p\"&gt;}}&lt;/span&gt;\n            &lt;span class=\"sr\"&gt;/&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;\n        &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"cm\"&gt;/* Workspace panel -- right side */&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;div&lt;/span&gt; &lt;span class=\"nx\"&gt;className&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;w-[62%] h-full overflow-hidden&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n          &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;Workspace&lt;/span&gt; &lt;span class=\"nx\"&gt;state&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;state&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"sr\"&gt;/&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;        &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;      &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/main&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;    &lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"sr\"&gt;/div&lt;/span&gt;&lt;span class=\"err\"&gt;&amp;gt;\n&lt;/span&gt;  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;A few things worth noting:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;useDefaultTool&lt;/code&gt; intercepts every tool call and renders a &lt;code&gt;ToolCard&lt;/code&gt; inline inside &lt;code&gt;CopilotChat&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;queueMicrotask&lt;/code&gt; defers &lt;code&gt;setState&lt;/code&gt; so it never fires mid-render.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;processedKeysRef&lt;/code&gt; deduplicates results since the render callback fires multiple times as status updates stream in.&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n\n&lt;h2&gt;\n  \n  \n  4. Backend: Building the Agent Service (FastAPI + Deep Agents + Tavily)\n&lt;/h2&gt;\n\n&lt;p&gt;We will now build the FastAPI backend that hosts our Deep Agent. &lt;/p&gt;\n\n&lt;p&gt;Under the &lt;code&gt;/agent&lt;/code&gt; directory lives a FastAPI server that runs the research agent. Here's the project structure of the backend.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;agent/\n├── main.py           ← FastAPI server + AG-UI\n├── agent.py          ← Deep Agents graph\n├── tools.py          ← Tavily search tools\n├── pyproject.toml    ← Python deps (uv)\n├── uv.lock\n└── .env\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;At a high level, the backend:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Builds a Deep Agent graph&lt;/li&gt;\n&lt;li&gt;Uses Tavily for real-time web search&lt;/li&gt;\n&lt;li&gt;Wraps research in an isolated sub-agent&lt;/li&gt;\n&lt;li&gt;Exposes a CopilotKit-compatible AG-UI endpoint&lt;/li&gt;\n&lt;li&gt;Streams tool calls to the frontend&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;The backend uses &lt;code&gt;uv&lt;/code&gt; for dependency management. Install it if you don't have it:&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;pip install uv\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Initialize a new uv project. This will generate a fresh &lt;code&gt;pyproject.toml&lt;/code&gt;.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;cd agent\nuv init\nuv python pin 3.12\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Then install the dependencies:&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;uv add copilotkit deepagents fastapi langchain langchain-openai python-dotenv tavily-python \"uvicorn[standard]\" ag-ui-langgraph\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;copilotkit&lt;/code&gt; : connects agents to a frontend with streaming, tools and shared state.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;deepagents&lt;/code&gt; : planning-first agent framework for multi-step execution&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;fastapi&lt;/code&gt; : web framework that exposes the agent API&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;langchain&lt;/code&gt; : agent and tool orchestration layer.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;langchain-openai&lt;/code&gt; : OpenAI model integration for LangChain.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;tavily-python&lt;/code&gt; : web search for real-time research&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;ag-ui-langgraph&lt;/code&gt; : AG-UI protocol adapter for LangGraph&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;uvicorn[standard]&lt;/code&gt; : ASGI server to run FastAPI&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Now run the following command to generate a &lt;code&gt;uv.lock&lt;/code&gt; file pinned with exact versions.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;uv sync\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n&lt;h3&gt;\n  \n  \n  Add necessary API Keys\n&lt;/h3&gt;\n\n&lt;p&gt;Create a &lt;code&gt;.env&lt;/code&gt; file under the &lt;code&gt;agent&lt;/code&gt; directory and add your &lt;a href=\"https://platform.openai.com/settings/organization/api-keys\" rel=\"noopener noreferrer\"&gt;OpenAI API Key&lt;/a&gt; and &lt;a href=\"https://app.tavily.com/home\" rel=\"noopener noreferrer\"&gt;Tavily API Key&lt;/a&gt; to the file. I have attached the docs link so it's easy to follow.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;OPENAI_API_KEY=sk-proj-...\nTAVILY_API_KEY=tvly-dev-...\nOPENAI_MODEL=gpt-5.2\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fqkm60jj3vsf72jjdgvav.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fqkm60jj3vsf72jjdgvav.png\" alt=\"OpenAI API Key\" width=\"800\" height=\"201\"&gt;&lt;/a&gt;&lt;/p&gt;\nOpenAI API Key\n\n\n\n&lt;p&gt; &lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Frxc4m82vbsozg04z8nxv.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Frxc4m82vbsozg04z8nxv.png\" alt=\"Tavily API Key\" width=\"800\" height=\"463\"&gt;&lt;/a&gt;&lt;/p&gt;\nTavily API Key\n\n\n\n&lt;p&gt; &lt;/p&gt;\n&lt;h3&gt;\n  \n  \n  Step 1: Implement Research Tools\n&lt;/h3&gt;\n\n&lt;p&gt;Let's define two tools (&lt;code&gt;tools.py&lt;/code&gt;):&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;internet_search&lt;/code&gt; is the low-level Tavily wrapper. It runs a search and returns up to &lt;code&gt;max_results&lt;/code&gt; formatted results.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;research&lt;/code&gt; wraps an internal Deep Agent that runs in a &lt;strong&gt;separate thread&lt;/strong&gt; to prevent its streaming events from leaking to the frontend via LangChain callback propagation.&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Here is the code.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight python\"&gt;&lt;code&gt;&lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;os&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;typing&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;Any&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;concurrent.futures&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;ThreadPoolExecutor&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;langchain_core.tools&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;tool&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;langchain_core.messages&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;HumanMessage&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;tavily&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;TavilyClient&lt;/span&gt;\n\n\n&lt;span class=\"k\"&gt;def&lt;/span&gt; &lt;span class=\"nf\"&gt;_do_internet_search&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;query&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nb\"&gt;str&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"n\"&gt;max_results&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nb\"&gt;int&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"mi\"&gt;5&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;-&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;list&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nb\"&gt;dict&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nb\"&gt;str&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"n\"&gt;Any&lt;/span&gt;&lt;span class=\"p\"&gt;]]:&lt;/span&gt;\n    &lt;span class=\"n\"&gt;tavily_key&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"n\"&gt;os&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"n\"&gt;environ&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;TAVILY_API_KEY&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if&lt;/span&gt; &lt;span class=\"ow\"&gt;not&lt;/span&gt; &lt;span class=\"n\"&gt;tavily_key&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;\n        &lt;span class=\"k\"&gt;raise&lt;/span&gt; &lt;span class=\"nc\"&gt;RuntimeError&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;TAVILY_API_KEY not set&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n    &lt;span class=\"k\"&gt;try&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;\n        &lt;span class=\"n\"&gt;client&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nc\"&gt;TavilyClient&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;api_key&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;tavily_key&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n        &lt;span class=\"n\"&gt;results&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"n\"&gt;client&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;search&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n            &lt;span class=\"n\"&gt;query&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;query&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n            &lt;span class=\"n\"&gt;max_results&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;max_results&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n            &lt;span class=\"n\"&gt;include_raw_content&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"bp\"&gt;False&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n            &lt;span class=\"n\"&gt;topic&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;general&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"p\"&gt;)&lt;/span&gt;\n        &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"p\"&gt;[&lt;/span&gt;\n            &lt;span class=\"p\"&gt;{&lt;/span&gt;\n                &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;url&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"n\"&gt;r&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;url&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt;\n                &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;title&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"n\"&gt;r&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;title&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt;\n                &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;content&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;r&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;content&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"ow\"&gt;or&lt;/span&gt; &lt;span class=\"sh\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;)[:&lt;/span&gt;&lt;span class=\"mi\"&gt;3000&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n            &lt;span class=\"p\"&gt;}&lt;/span&gt;\n            &lt;span class=\"k\"&gt;for&lt;/span&gt; &lt;span class=\"n\"&gt;r&lt;/span&gt; &lt;span class=\"ow\"&gt;in&lt;/span&gt; &lt;span class=\"n\"&gt;results&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;results&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;[])&lt;/span&gt;\n        &lt;span class=\"p\"&gt;]&lt;/span&gt;\n    &lt;span class=\"k\"&gt;except&lt;/span&gt; &lt;span class=\"nb\"&gt;Exception&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"n\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;\n        &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"p\"&gt;[{&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;error&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nf\"&gt;str&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;)}]&lt;/span&gt;\n\n\n&lt;span class=\"nd\"&gt;@tool&lt;/span&gt;\n&lt;span class=\"k\"&gt;def&lt;/span&gt; &lt;span class=\"nf\"&gt;internet_search&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;query&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nb\"&gt;str&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"n\"&gt;max_results&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nb\"&gt;int&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"mi\"&gt;5&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;-&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;list&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nb\"&gt;dict&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nb\"&gt;str&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"n\"&gt;Any&lt;/span&gt;&lt;span class=\"p\"&gt;]]:&lt;/span&gt;\n    &lt;span class=\"sh\"&gt;\"\"\"&lt;/span&gt;&lt;span class=\"s\"&gt;Search the web and return results with content.&lt;/span&gt;&lt;span class=\"sh\"&gt;\"\"\"&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"nf\"&gt;_do_internet_search&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;query&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"n\"&gt;max_results&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n\n&lt;span class=\"nd\"&gt;@tool&lt;/span&gt;\n&lt;span class=\"k\"&gt;def&lt;/span&gt; &lt;span class=\"nf\"&gt;research&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;query&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nb\"&gt;str&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;-&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;dict&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;\n    &lt;span class=\"sh\"&gt;\"\"\"&lt;/span&gt;&lt;span class=\"s\"&gt;Research a topic using web search. Returns structured data with sources.&lt;/span&gt;&lt;span class=\"sh\"&gt;\"\"\"&lt;/span&gt;\n\n    &lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;deepagents&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;create_deep_agent&lt;/span&gt;\n    &lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;langchain_openai&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;ChatOpenAI&lt;/span&gt;\n\n    &lt;span class=\"k\"&gt;def&lt;/span&gt; &lt;span class=\"nf\"&gt;_run_research_isolated&lt;/span&gt;&lt;span class=\"p\"&gt;():&lt;/span&gt;\n        &lt;span class=\"n\"&gt;search_results&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;[]&lt;/span&gt;\n\n        &lt;span class=\"k\"&gt;def&lt;/span&gt; &lt;span class=\"nf\"&gt;internet_search_tracked&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;query&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nb\"&gt;str&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"n\"&gt;max_results&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nb\"&gt;int&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"mi\"&gt;5&lt;/span&gt;&lt;span class=\"p\"&gt;):&lt;/span&gt;\n            &lt;span class=\"sh\"&gt;\"\"\"&lt;/span&gt;&lt;span class=\"s\"&gt;Search the web and return results with content.&lt;/span&gt;&lt;span class=\"sh\"&gt;\"\"\"&lt;/span&gt;\n            &lt;span class=\"n\"&gt;results&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;_do_internet_search&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;query&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"n\"&gt;max_results&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n            &lt;span class=\"n\"&gt;search_results&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;extend&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;results&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n            &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"n\"&gt;results&lt;/span&gt;\n\n        &lt;span class=\"n\"&gt;llm&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nc\"&gt;ChatOpenAI&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n            &lt;span class=\"n\"&gt;model&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;os&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"n\"&gt;environ&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;OPENAI_MODEL&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;gpt-5.2&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt;\n            &lt;span class=\"n\"&gt;temperature&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"mf\"&gt;0.7&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n            &lt;span class=\"n\"&gt;api_key&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;os&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"n\"&gt;environ&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;OPENAI_API_KEY&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt;\n        &lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n        &lt;span class=\"n\"&gt;research_agent&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;create_deep_agent&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n            &lt;span class=\"n\"&gt;model&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;llm&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n            &lt;span class=\"n\"&gt;system_prompt&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"sh\"&gt;\"\"\"&lt;/span&gt;&lt;span class=\"s\"&gt;You are a Research Specialist.\nUse internet_search to find information. Return a prose summary of findings.\nRules:\n- Call internet_search ONCE with a focused query\n- Return a brief summary (2-3 sentences) of key findings\n- No JSON, no code blocks, just prose&lt;/span&gt;&lt;span class=\"sh\"&gt;\"\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n            &lt;span class=\"n\"&gt;tools&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"n\"&gt;internet_search_tracked&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n        &lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n        &lt;span class=\"n\"&gt;result&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"n\"&gt;research_agent&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;invoke&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;messages&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nc\"&gt;HumanMessage&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;content&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;query&lt;/span&gt;&lt;span class=\"p\"&gt;)]})&lt;/span&gt;\n\n        &lt;span class=\"n\"&gt;summary&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"n\"&gt;result&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;messages&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;][&lt;/span&gt;&lt;span class=\"o\"&gt;-&lt;/span&gt;&lt;span class=\"mi\"&gt;1&lt;/span&gt;&lt;span class=\"p\"&gt;].&lt;/span&gt;&lt;span class=\"n\"&gt;content&lt;/span&gt;\n        &lt;span class=\"n\"&gt;sources&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;[&lt;/span&gt;\n            &lt;span class=\"p\"&gt;{&lt;/span&gt;\n                &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;url&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"n\"&gt;r&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;url&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n                &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;title&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"n\"&gt;r&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;title&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt;\n                &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;content&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"n\"&gt;r&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;content&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"\"&lt;/span&gt;&lt;span class=\"p\"&gt;)[:&lt;/span&gt;&lt;span class=\"mi\"&gt;3000&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n                &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;status&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;found&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n            &lt;span class=\"p\"&gt;}&lt;/span&gt;\n            &lt;span class=\"k\"&gt;for&lt;/span&gt; &lt;span class=\"n\"&gt;r&lt;/span&gt; &lt;span class=\"ow\"&gt;in&lt;/span&gt; &lt;span class=\"n\"&gt;search_results&lt;/span&gt;\n            &lt;span class=\"k\"&gt;if&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;url&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt; &lt;span class=\"ow\"&gt;in&lt;/span&gt; &lt;span class=\"n\"&gt;r&lt;/span&gt; &lt;span class=\"ow\"&gt;and&lt;/span&gt; &lt;span class=\"ow\"&gt;not&lt;/span&gt; &lt;span class=\"n\"&gt;r&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;error&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n        &lt;span class=\"p\"&gt;]&lt;/span&gt;\n\n        &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;summary&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"n\"&gt;summary&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;sources&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"n\"&gt;sources&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n    &lt;span class=\"k\"&gt;with&lt;/span&gt; &lt;span class=\"nc\"&gt;ThreadPoolExecutor&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;max_workers&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"mi\"&gt;1&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"n\"&gt;executor&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;\n        &lt;span class=\"n\"&gt;future&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"n\"&gt;executor&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;submit&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;_run_research_isolated&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n        &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"n\"&gt;future&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;result&lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Here's what's happening:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;_do_internet_search&lt;/code&gt; caps each result at 3000 chars to stay within token limits and returns an error dict instead of crashing.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;internet_search_tracked&lt;/code&gt; extends &lt;code&gt;search_results&lt;/code&gt; on every call, building a clean source list to return alongside the final summary.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;research_agent&lt;/code&gt; is constrained to call &lt;code&gt;internet_search&lt;/code&gt; once -- prevents looping and keeps latency predictable.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;ThreadPoolExecutor&lt;/code&gt; isolates the subagent in a separate thread so its stream events don't leak into the frontend chat.&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt; &lt;/p&gt;\n&lt;h3&gt;\n  \n  \n  Step 2: Define the Agent Behavior\n&lt;/h3&gt;\n\n&lt;p&gt;This is the brain of the system. The agent is a Deep Agents graph that:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Creates a research plan using &lt;code&gt;write_todos&lt;/code&gt;\n&lt;/li&gt;\n&lt;li&gt;Calls &lt;code&gt;research()&lt;/code&gt; for each research question&lt;/li&gt;\n&lt;li&gt;Writes a final report to &lt;code&gt;/reports/final_report.md&lt;/code&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Here is the main system prompt that enforces this workflow:&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;MAIN_SYSTEM_PROMPT = \"\"\"You are a Deep Research Assistant, an expert at planning and\nexecuting comprehensive research on any topic.\n\nHard rules (ALWAYS follow):\n- NEVER output raw JSON, data structures, or code blocks in your messages\n- Communicate with the user only in natural, readable prose\n- When you receive data from research, synthesize it into insights\n\nYour workflow:\n1. PLAN: Create a research plan using write_todos with clear, actionable steps\n2. RESEARCH: Use research(query) tool to investigate each topic\n3. SYNTHESIZE: Write a final report to /reports/final_report.md using write_file\n\nImportant guidelines:\n- Always start by creating a research plan with write_todos\n- Call research() for each distinct research question\n- The research tool returns prose summaries of findings\n- You write all files - compile findings into a comprehensive report\n- Update todos as you complete each step\n\nExample workflow:\n1. write_todos([\"Research topic A\", \"Research topic B\", \"Synthesize findings\"])\n2. research(\"Find information about topic A\") -&amp;gt; receives prose summary\n3. research(\"Find information about topic B\") -&amp;gt; receives prose summary\n4. write_file(\"/reports/final_report.md\", \"# Research Report\\n\\n...\")\n\nAlways maintain a professional, comprehensive research style.\"\"\"\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Here is the core agent graph (&lt;code&gt;build_agent&lt;/code&gt;):&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight python\"&gt;&lt;code&gt;&lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;os&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;dotenv&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;load_dotenv&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;langchain_openai&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;ChatOpenAI&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;deepagents&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;create_deep_agent&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;langgraph.checkpoint.memory&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;MemorySaver&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;copilotkit&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;CopilotKitMiddleware&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;tools&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;research&lt;/span&gt;\n\n&lt;span class=\"nf\"&gt;load_dotenv&lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;def&lt;/span&gt; &lt;span class=\"nf\"&gt;build_agent&lt;/span&gt;&lt;span class=\"p\"&gt;():&lt;/span&gt;\n    &lt;span class=\"n\"&gt;api_key&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"n\"&gt;os&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"n\"&gt;environ&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;OPENAI_API_KEY&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if&lt;/span&gt; &lt;span class=\"ow\"&gt;not&lt;/span&gt; &lt;span class=\"n\"&gt;api_key&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;\n        &lt;span class=\"k\"&gt;raise&lt;/span&gt; &lt;span class=\"nc\"&gt;RuntimeError&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;Missing OPENAI_API_KEY environment variable&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n    &lt;span class=\"n\"&gt;tavily_key&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"n\"&gt;os&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"n\"&gt;environ&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;TAVILY_API_KEY&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if&lt;/span&gt; &lt;span class=\"ow\"&gt;not&lt;/span&gt; &lt;span class=\"n\"&gt;tavily_key&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;\n        &lt;span class=\"k\"&gt;raise&lt;/span&gt; &lt;span class=\"nc\"&gt;RuntimeError&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;Missing TAVILY_API_KEY environment variable&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n    &lt;span class=\"n\"&gt;model_name&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"n\"&gt;os&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"n\"&gt;environ&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;OPENAI_MODEL&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;gpt-5.2&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n    &lt;span class=\"n\"&gt;llm&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nc\"&gt;ChatOpenAI&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n        &lt;span class=\"n\"&gt;model&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;model_name&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"n\"&gt;temperature&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"mf\"&gt;0.7&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"n\"&gt;api_key&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;api_key&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n    &lt;span class=\"n\"&gt;agent_graph&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;create_deep_agent&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n        &lt;span class=\"n\"&gt;model&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;llm&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"n\"&gt;system_prompt&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;MAIN_SYSTEM_PROMPT&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"n\"&gt;tools&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"n\"&gt;research&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n        &lt;span class=\"n\"&gt;middleware&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nc\"&gt;CopilotKitMiddleware&lt;/span&gt;&lt;span class=\"p\"&gt;()],&lt;/span&gt;\n        &lt;span class=\"n\"&gt;checkpointer&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"nc\"&gt;MemorySaver&lt;/span&gt;&lt;span class=\"p\"&gt;(),&lt;/span&gt;\n    &lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n    &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"n\"&gt;agent_graph&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;with_config&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;recursion_limit&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"mi\"&gt;100&lt;/span&gt;&lt;span class=\"p\"&gt;})&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Here's what's happening:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;code&gt;CopilotKitMiddleware()&lt;/code&gt; enables AG-UI streaming to the frontend&lt;/li&gt;\n&lt;li&gt;\n&lt;code&gt;MemorySaver()&lt;/code&gt; enables stateful execution&lt;/li&gt;\n&lt;li&gt;Recursion limit increased to support multi-step research&lt;/li&gt;\n&lt;li&gt;\n&lt;code&gt;research&lt;/code&gt; is the only explicit tool since &lt;code&gt;write_todos&lt;/code&gt;, &lt;code&gt;read_file&lt;/code&gt;, &lt;code&gt;write_file&lt;/code&gt; are built into Deep Agents automatically&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt; &lt;/p&gt;\n&lt;h3&gt;\n  \n  \n  Step 3: Expose the Agent via FastAPI + AG-UI\n&lt;/h3&gt;\n\n&lt;p&gt;The last step is to wire everything together and expose it as a FastAPI app. The &lt;code&gt;main.py&lt;/code&gt; builds the agent graph, configures which tool calls to emit to the frontend and registers the AG-UI endpoint.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight python\"&gt;&lt;code&gt;&lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;os&lt;/span&gt;\n&lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;uvicorn&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;fastapi&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;FastAPI&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;fastapi.middleware.cors&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;CORSMiddleware&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;dotenv&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;load_dotenv&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;ag_ui_langgraph&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;add_langgraph_fastapi_endpoint&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;copilotkit&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;LangGraphAGUIAgent&lt;/span&gt;\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;copilotkit.langgraph&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;copilotkit_customize_config&lt;/span&gt;\n\n&lt;span class=\"kn\"&gt;from&lt;/span&gt; &lt;span class=\"n\"&gt;agent&lt;/span&gt; &lt;span class=\"kn\"&gt;import&lt;/span&gt; &lt;span class=\"n\"&gt;build_agent&lt;/span&gt;\n\n&lt;span class=\"nf\"&gt;load_dotenv&lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt;\n\n&lt;span class=\"n\"&gt;app&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nc\"&gt;FastAPI&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;title&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;Deep Research Assistant&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"n\"&gt;version&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;1.0.0&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n&lt;span class=\"n\"&gt;app&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;add_middleware&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"n\"&gt;CORSMiddleware&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"n\"&gt;allow_origins&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;*&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n    &lt;span class=\"n\"&gt;allow_credentials&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"bp\"&gt;True&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"n\"&gt;allow_methods&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;*&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n    &lt;span class=\"n\"&gt;allow_headers&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;*&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n&lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n&lt;span class=\"nd\"&gt;@app.get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;/health&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;\n&lt;span class=\"k\"&gt;def&lt;/span&gt; &lt;span class=\"nf\"&gt;health&lt;/span&gt;&lt;span class=\"p\"&gt;():&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;status&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;ok&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;service&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;deep-research-agent&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n&lt;span class=\"n\"&gt;agent_graph&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;build_agent&lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt;\n\n&lt;span class=\"c1\"&gt;# Only emit main agent tools — suppress internal subagent tool calls\n&lt;/span&gt;&lt;span class=\"n\"&gt;agui_config&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;copilotkit_customize_config&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"n\"&gt;emit_tool_calls&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;research&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;write_todos&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;write_file&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;read_file&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;edit_file&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;]&lt;/span&gt;\n&lt;span class=\"p\"&gt;)&lt;/span&gt;\n&lt;span class=\"n\"&gt;agui_config&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;recursion_limit&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;]&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"mi\"&gt;100&lt;/span&gt;\n\n&lt;span class=\"nf\"&gt;add_langgraph_fastapi_endpoint&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"n\"&gt;app&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;app&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"n\"&gt;agent&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"nc\"&gt;LangGraphAGUIAgent&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n        &lt;span class=\"n\"&gt;name&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;research_assistant&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"n\"&gt;description&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;A deep research assistant that plans, searches, and synthesizes research reports&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"n\"&gt;graph&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;agent_graph&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"n\"&gt;config&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;agui_config&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"p\"&gt;),&lt;/span&gt;\n    &lt;span class=\"n\"&gt;path&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;/&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n&lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;def&lt;/span&gt; &lt;span class=\"nf\"&gt;main&lt;/span&gt;&lt;span class=\"p\"&gt;():&lt;/span&gt;\n    &lt;span class=\"n\"&gt;uvicorn&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;run&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n        &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;main:app&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"n\"&gt;host&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"n\"&gt;os&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;getenv&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;SERVER_HOST&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;0.0.0.0&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt;\n        &lt;span class=\"n\"&gt;port&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"nf\"&gt;int&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;os&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;getenv&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;SERVER_PORT&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;8123&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;)),&lt;/span&gt;\n        &lt;span class=\"nb\"&gt;reload&lt;/span&gt;&lt;span class=\"o\"&gt;=&lt;/span&gt;&lt;span class=\"bp\"&gt;True&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"p\"&gt;)&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;if&lt;/span&gt; &lt;span class=\"n\"&gt;__name__&lt;/span&gt; &lt;span class=\"o\"&gt;==&lt;/span&gt; &lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"s\"&gt;__main__&lt;/span&gt;&lt;span class=\"sh\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;\n    &lt;span class=\"nf\"&gt;main&lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;The &lt;code&gt;emit_tool_calls&lt;/code&gt; config controls exactly which tool calls CopilotKit streams to the frontend. Without it, the subagent's internal &lt;code&gt;internet_search&lt;/code&gt; calls leak through as raw JSON noise in the chat UI.&lt;/p&gt;\n\n\n&lt;h2&gt;\n  \n  \n  5. Running the Application\n&lt;/h2&gt;\n\n&lt;p&gt;After completing all the parts of the code, it's time to run it locally. Please make sure you have added the credentials to the &lt;code&gt;agent/.env&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;From the project root, navigate to the &lt;code&gt;agent&lt;/code&gt; directory and start the FastAPI server:&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;cd agent\nuv run python main.py\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;The backend will start on &lt;code&gt;http://localhost:8123&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;In a new terminal window, start the frontend development server using:&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;npm run dev\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n&lt;p&gt;Once both servers are running, open the frontend in your browser at &lt;a href=\"http://localhost:3000/\" rel=\"noopener noreferrer\"&gt;http://localhost:3000/&lt;/a&gt; to view it locally.&lt;/p&gt;\n\n&lt;p&gt;Here is the complete demo!&lt;/p&gt;\n\n&lt;p&gt;&lt;iframe width=\"710\" height=\"399\" src=\"https://www.youtube.com/embed/oj3S605DliY\"&gt;\n&lt;/iframe&gt;\n&lt;/p&gt;\n\n\n&lt;h2&gt;\n  \n  \n  6. Data flow\n&lt;/h2&gt;\n\n&lt;p&gt;Now that we have built both the frontend and the agent service, this is how data actually flows between them. This should be easy to follow if you have been building along so far.&lt;br&gt;\n&lt;/p&gt;\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;[User sends research question]\n        ↓\nNext.js Frontend (CopilotChat + Workspace)\n        ↓\nPOST /api/copilotkit (AG-UI protocol)\n        ↓\nCopilotKit Runtime → LangGraphHttpAgent (localhost:8123)\n        ↓\nFastAPI Backend (AG-UI endpoint \"/\")\n        ↓\nDeep Agent (research_assistant)\n        ↓\nDeep Agents orchestration\n    ├── write_todos  → todos state   → Workspace (Research Plan)\n    ├── research()   → sources state → Workspace (Sources)\n    │       └── internal Deep Agent [thread-isolated]\n    │               └── internet_search (Tavily API)\n    └── write_file   → files state   → Workspace (Files)\n        ↓\nAG-UI streaming (SSE)\n        ↓\nuseDefaultTool intercepts tool calls\n        ↓\nToolCard renders in chat + Workspace updates live\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n\n&lt;p&gt;That's it! 🎉&lt;/p&gt;\n\n&lt;p&gt;You now have a fully working Deep Agents research assistant that plans, searches, and writes reports, with every step visible in the frontend as it happens.&lt;/p&gt;\n\n&lt;p&gt;The real win here is visibility. CopilotKit's AG-UI layer turns what would otherwise be a black-box agent into something users can actually follow and trust.&lt;/p&gt;\n\n&lt;div class=\"table-wrapper-paragraph\"&gt;&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;You can check&lt;br&gt;my work at &lt;a href=\"https://anmolbaranwal.com/\" rel=\"noopener noreferrer\"&gt;anmolbaranwal.com&lt;/a&gt;. &lt;br&gt;Thank you for reading! 🥰&lt;/th&gt;\n&lt;th&gt;\n&lt;a href=\"https://x.com/Anmol_Codes\" rel=\"noopener noreferrer\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F0fecryc64ezd414va3hn.png\" alt=\"twitter\" width=\"84\" height=\"28\"&gt;&lt;/a&gt; &lt;a href=\"https://github.com/Anmol-Baranwal\" rel=\"noopener noreferrer\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fzdf3y9wzwtsl3ffjw2qm.png\" alt=\"github\" width=\"76\" height=\"28\"&gt;&lt;/a&gt; &lt;a href=\"https://www.linkedin.com/in/Anmol-Baranwal/\" rel=\"noopener noreferrer\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F25hxajrjdmt2wqmiigf0.png\" alt=\"linkedin\" width=\"91\" height=\"28\"&gt;&lt;/a&gt;\n&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;/div&gt;\n\n&lt;p&gt;Follow CopilotKit on &lt;a href=\"https://go.copilotkit.ai/socials-twitter\" rel=\"noopener noreferrer\"&gt;Twitter&lt;/a&gt; and say hi, and if you'd like to build something cool, join the &lt;a href=\"https://go.copilotkit.ai/discord-community\" rel=\"noopener noreferrer\"&gt;Discord&lt;/a&gt; community.&lt;/p&gt;\n\n\n&lt;div class=\"ltag__user ltag__user__id__7820\"&gt;\n  &lt;a href=\"/copilotkit\" class=\"ltag__user__link profile-image-link\"&gt;\n    &lt;div class=\"ltag__user__pic\"&gt;\n      &lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Forganization%2Fprofile_image%2F7820%2F85b7e418-7abd-4fb5-8be6-69eb48a30e53.gif\" alt=\"copilotkit image\"&gt;\n    &lt;/div&gt;\n  &lt;/a&gt;\n  &lt;div class=\"ltag__user__content\"&gt;\n    &lt;h2&gt;\n      &lt;a href=\"/copilotkit\" class=\"ltag__user__link\"&gt;CopilotKit&lt;/a&gt;\n      Follow\n    &lt;/h2&gt;\n    &lt;div class=\"ltag__user__summary\"&gt;\n      &lt;a href=\"/copilotkit\" class=\"ltag__user__link\"&gt;\n        React UI + elegant infrastructure for AI Copilots, in-app AI agents, AI chatbots, and AI-powered Textareas 🪁\n      &lt;/a&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;",
    "date": "2026-02-20T14:22:05.000Z",
    "url": "https://dev.to/copilotkit/how-to-build-a-research-assistant-using-deep-agents-2bpg"
  },
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "Why Your React Keyboard Handler Always Reads Old State",
    "partialText": "&lt;p&gt;You add a keyboard shortcut with &lt;code&gt;useEffect&lt;/code&gt;. It works — until it doesn't. After a few state updates, the handler starts behaving as if nothing changed. Values are stale. Actions fire on outdated data.&lt;/p&gt;\n\n&lt;p&gt;This is the &lt;strong&gt;stale closure problem&lt;/strong&gt;, and it bit me hard while building &lt;a href=\"https://blocktexu.com/en/\" rel=\"noopener noreferrer\"&gt;BlockTeXu&lt;/a&gt;, a block-based visual LaTeX editor.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fxfkbnvl35builwtvb126.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fxfkbnvl35builwtvb126.png\" alt=\"Site Top View\" width=\"800\" height=\"399\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  The Setup: A Global Keyboard Handler\n&lt;/h2&gt;\n\n&lt;p&gt;BlockTeXu has keyboard shortcuts throughout: &lt;code&gt;Ctrl+Z&lt;/code&gt; for undo, &lt;code&gt;Delete&lt;/code&gt; to remove blocks, &lt;code&gt;Enter&lt;/code&gt; to confirm dialogs. The natural way to add these is:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"nf\"&gt;useEffect&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"na\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;KeyboardEvent&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;Delete&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"nf\"&gt;deleteSelectedBlock&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;selectedBlockId&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;  &lt;span class=\"c1\"&gt;// ← uses state&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;ctrlKey&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;z&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"nf\"&gt;undo&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}&lt;/span&gt;\n  &lt;span class=\"p\"&gt;};&lt;/span&gt;\n\n  &lt;span class=\"nb\"&gt;window&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;addEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;window&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;removeEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;},&lt;/span&gt; &lt;span class=\"p\"&gt;[]);&lt;/span&gt;  &lt;span class=\"c1\"&gt;// ← empty dependency array&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;This seems fine. But there's a subtle bug hiding here.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  The Problem: Closures Capture Values, Not References\n&lt;/h2&gt;\n\n&lt;p&gt;When &lt;code&gt;handleKeyDown&lt;/code&gt; is created inside &lt;code&gt;useEffect&lt;/code&gt;, it &lt;strong&gt;closes over&lt;/strong&gt; the current value of &lt;code&gt;selectedBlockId&lt;/code&gt;. With an empty dependency array &lt;code&gt;[]&lt;/code&gt;, the effect runs only once — on mount. The event listener is registered once and never re-registered.&lt;/p&gt;\n\n&lt;p&gt;Here's what that means:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;Mount:  selectedBlockId = null  → handler captures null\nUser clicks block A:  selectedBlockId = 'block-A'\nUser presses Delete:  handler still sees null  ← stale!\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;The function you passed to &lt;code&gt;addEventListener&lt;/code&gt; is frozen in time. It will always read the value that existed when it was first created.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Key Insight:&lt;/strong&gt; This isn't a React bug or an event listener quirk — it's how JavaScript closures work. The function literally holds a reference to the scope that existed at creation time, not a live pointer to current state.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Attempted Fix: Add Everything to the Dependency Array\n&lt;/h2&gt;\n\n&lt;p&gt;The obvious fix:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"nf\"&gt;useEffect&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"na\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;KeyboardEvent&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;Delete&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"nf\"&gt;deleteSelectedBlock&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;selectedBlockId&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}&lt;/span&gt;\n  &lt;span class=\"p\"&gt;};&lt;/span&gt;\n\n  &lt;span class=\"nb\"&gt;window&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;addEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;window&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;removeEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;},&lt;/span&gt; &lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nx\"&gt;selectedBlockId&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;deleteSelectedBlock&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;undo&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"cm\"&gt;/* ... */&lt;/span&gt;&lt;span class=\"p\"&gt;]);&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;This works, but has a cost: &lt;strong&gt;the listener is removed and re-added every time any dependency changes.&lt;/strong&gt; With many state values in the dependency array, you get constant register/unregister cycles. For a global keyboard handler that touches most of the app's state, this becomes impractical.&lt;/p&gt;\n\n&lt;p&gt;You'd also need to be careful about referential stability of the callbacks (&lt;code&gt;useCallback&lt;/code&gt; on everything they depend on), which adds more boilerplate and more opportunities to miss a dependency.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  The Solution: useRef as a Stable Bridge\n&lt;/h2&gt;\n\n&lt;p&gt;The cleanest fix uses &lt;code&gt;useRef&lt;/code&gt; to bridge between the stable event listener and the current state:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;// 1. Keep a ref that always points to the latest handler&lt;/span&gt;\n&lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;handlerRef&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;useRef&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;KeyboardEvent&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"k\"&gt;void&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{});&lt;/span&gt;\n\n&lt;span class=\"c1\"&gt;// 2. Update the ref on every render — this is intentional&lt;/span&gt;\n&lt;span class=\"nf\"&gt;useEffect&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;handlerRef&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;current&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"na\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;KeyboardEvent&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;Delete&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"nf\"&gt;deleteSelectedBlock&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;selectedBlockId&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;ctrlKey&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;z&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"nf\"&gt;undo&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}&lt;/span&gt;\n    &lt;span class=\"c1\"&gt;// ... all your keyboard logic&lt;/span&gt;\n  &lt;span class=\"p\"&gt;};&lt;/span&gt;\n&lt;span class=\"p\"&gt;});&lt;/span&gt;  &lt;span class=\"c1\"&gt;// no dependency array — runs every render&lt;/span&gt;\n\n&lt;span class=\"c1\"&gt;// 3. Register a stable listener that calls through the ref&lt;/span&gt;\n&lt;span class=\"nf\"&gt;useEffect&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;stable&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"na\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;KeyboardEvent&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nx\"&gt;handlerRef&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;current&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"nb\"&gt;window&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;addEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;stable&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;window&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;removeEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;stable&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;},&lt;/span&gt; &lt;span class=\"p\"&gt;[]);&lt;/span&gt;  &lt;span class=\"c1\"&gt;// runs only once&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;Why this works:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;The &lt;strong&gt;stable listener&lt;/strong&gt; (&lt;code&gt;stable&lt;/code&gt;) is registered once and never removed until unmount&lt;/li&gt;\n&lt;li&gt;\n&lt;code&gt;stable&lt;/code&gt; always calls &lt;code&gt;handlerRef.current&lt;/code&gt; — a ref lookup, not a closure capture&lt;/li&gt;\n&lt;li&gt;The &lt;strong&gt;ref's value&lt;/strong&gt; is updated on every render with a fresh function that closes over current state&lt;/li&gt;\n&lt;li&gt;When the user presses a key, &lt;code&gt;stable&lt;/code&gt; fires, reads &lt;code&gt;handlerRef.current&lt;/code&gt;, and gets the latest handler&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;The ref acts as a mutable variable that the stable function can \"look through\" at runtime.&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;Mount:       stable = (e) =&amp;gt; handlerRef.current(e)   ← registered once\nRender 1:    handlerRef.current = fn that sees selectedBlockId = null\nUser clicks: selectedBlockId = 'block-A'\nRender 2:    handlerRef.current = fn that sees selectedBlockId = 'block-A'\nKey press:   stable() → handlerRef.current() → sees 'block-A' ✅\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n\n\n\n&lt;h2&gt;\n  \n  \n  The Complete Pattern\n&lt;/h2&gt;\n\n&lt;p&gt;Here's the full implementation in BlockTeXu:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;useKeyboardHandler&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;blocks&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;PlacedBlock&lt;/span&gt;&lt;span class=\"p\"&gt;[],&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;selectedId&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;number&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"kc\"&gt;null&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;onDelete&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;id&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;number&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"k\"&gt;void&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;onUndo&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"k\"&gt;void&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;onRedo&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"k\"&gt;void&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;handlerRef&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;useRef&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;KeyboardEvent&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"k\"&gt;void&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{});&lt;/span&gt;\n\n  &lt;span class=\"c1\"&gt;// Update ref every render&lt;/span&gt;\n  &lt;span class=\"nf\"&gt;useEffect&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"nx\"&gt;handlerRef&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;current&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"na\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;KeyboardEvent&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"c1\"&gt;// Ignore if focus is inside an input/textarea&lt;/span&gt;\n      &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;target&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;target&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"nx\"&gt;HTMLElement&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n      &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;target&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;tagName&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;INPUT&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt; &lt;span class=\"o\"&gt;||&lt;/span&gt; &lt;span class=\"nx\"&gt;target&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;tagName&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;TEXTAREA&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"k\"&gt;return&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n      &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;Delete&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;selectedId&lt;/span&gt; &lt;span class=\"o\"&gt;!==&lt;/span&gt; &lt;span class=\"kc\"&gt;null&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;preventDefault&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n        &lt;span class=\"nf\"&gt;onDelete&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;selectedId&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n      &lt;span class=\"p\"&gt;}&lt;/span&gt;\n      &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;ctrlKey&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;z&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;preventDefault&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n        &lt;span class=\"nf\"&gt;onUndo&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n      &lt;span class=\"p\"&gt;}&lt;/span&gt;\n      &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;ctrlKey&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;y&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;preventDefault&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n        &lt;span class=\"nf\"&gt;onRedo&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n      &lt;span class=\"p\"&gt;}&lt;/span&gt;\n    &lt;span class=\"p\"&gt;};&lt;/span&gt;\n  &lt;span class=\"p\"&gt;});&lt;/span&gt;\n\n  &lt;span class=\"c1\"&gt;// Register stable listener once&lt;/span&gt;\n  &lt;span class=\"nf\"&gt;useEffect&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;handler&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"na\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;KeyboardEvent&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nx\"&gt;handlerRef&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;current&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"nb\"&gt;window&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;addEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;handler&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;window&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;removeEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;handler&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"p\"&gt;},&lt;/span&gt; &lt;span class=\"p\"&gt;[]);&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;One important detail: &lt;strong&gt;&lt;code&gt;if target is INPUT/TEXTAREA, return early.&lt;/code&gt;&lt;/strong&gt; Without this, pressing Delete while typing in an input field would trigger your delete shortcut. Always guard global key handlers against active form elements.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  React 19.2 Update: useEffectEvent\n&lt;/h2&gt;\n\n&lt;p&gt;After publishing the Japanese version of this article on Zenn, a reader pointed out that React 19.2 (released as stable) ships &lt;code&gt;useEffectEvent&lt;/code&gt; — an official solution to exactly this problem.&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;useEffectEvent&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;react&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;useKeyboardHandler&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;selectedId&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;number&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"kc\"&gt;null&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;onDelete&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;...)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;useEffectEvent&lt;/span&gt;&lt;span class=\"p\"&gt;((&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;KeyboardEvent&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;e&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;key&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;Delete&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt; &lt;span class=\"o\"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=\"nx\"&gt;selectedId&lt;/span&gt; &lt;span class=\"o\"&gt;!==&lt;/span&gt; &lt;span class=\"kc\"&gt;null&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"nf\"&gt;onDelete&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;selectedId&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}&lt;/span&gt;\n  &lt;span class=\"p\"&gt;});&lt;/span&gt;\n\n  &lt;span class=\"nf\"&gt;useEffect&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"nb\"&gt;window&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;addEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;window&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;removeEventListener&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;keydown&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;handleKeyDown&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"p\"&gt;},&lt;/span&gt; &lt;span class=\"p\"&gt;[]);&lt;/span&gt;  &lt;span class=\"c1\"&gt;// no need to list selectedId in deps&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;&lt;code&gt;useEffectEvent&lt;/code&gt; creates a function that:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Always reads the latest values&lt;/strong&gt; (like our &lt;code&gt;useRef&lt;/code&gt; approach)&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Has a stable identity&lt;/strong&gt; (like a ref wrapper)&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Is excluded from dependency lint rules&lt;/strong&gt; (React knows it's always fresh)&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;The &lt;code&gt;useRef&lt;/code&gt; pattern we built manually is essentially what &lt;code&gt;useEffectEvent&lt;/code&gt; does under the hood. The hook makes the intent explicit and removes the boilerplate.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;As of React 19.2, &lt;code&gt;useEffectEvent&lt;/code&gt; is the canonical solution.&lt;/strong&gt; If you're on React 19.2+, use it directly. For earlier versions, the &lt;code&gt;useRef&lt;/code&gt; bridge pattern is the way to go.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Comparison\n&lt;/h2&gt;\n\n&lt;div class=\"table-wrapper-paragraph\"&gt;&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;Approach&lt;/th&gt;\n&lt;th&gt;Pros&lt;/th&gt;\n&lt;th&gt;Cons&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;Empty deps &lt;code&gt;[]&lt;/code&gt;\n&lt;/td&gt;\n&lt;td&gt;Simple&lt;/td&gt;\n&lt;td&gt;Always reads stale state&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;Full deps array&lt;/td&gt;\n&lt;td&gt;Correct&lt;/td&gt;\n&lt;td&gt;Re-registers on every change, dependency hell&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;\n&lt;code&gt;useRef&lt;/code&gt; bridge&lt;/td&gt;\n&lt;td&gt;Correct, registers once&lt;/td&gt;\n&lt;td&gt;Two &lt;code&gt;useEffect&lt;/code&gt; calls, manual boilerplate&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;code&gt;useEffectEvent&lt;/code&gt;&lt;/td&gt;\n&lt;td&gt;Correct, clean&lt;/td&gt;\n&lt;td&gt;Requires React 19.2+&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;/div&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Key Takeaways\n&lt;/h2&gt;\n\n&lt;ol&gt;\n&lt;li&gt;\n&lt;strong&gt;Stale closures&lt;/strong&gt; happen when an event listener captures state from a specific render and never updates&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;code&gt;useRef&lt;/code&gt; bridge pattern&lt;/strong&gt;: update a ref every render, register one stable listener that reads through the ref&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;code&gt;useEffectEvent&lt;/code&gt;&lt;/strong&gt; (React 19.2+) is the official replacement — same semantics, no boilerplate&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Always guard&lt;/strong&gt; global key handlers against &lt;code&gt;INPUT&lt;/code&gt;/&lt;code&gt;TEXTAREA&lt;/code&gt; focus&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;The &lt;code&gt;useRef&lt;/code&gt; bridge isn't React-specific. The same pattern applies whenever you need a stable function reference that always reads current values — WebSocket message handlers, &lt;code&gt;requestAnimationFrame&lt;/code&gt; callbacks, timer callbacks, and more.&lt;/p&gt;\n\n\n\n\n&lt;p&gt;&lt;strong&gt;Next post:&lt;/strong&gt; How KaTeX + html-to-image produced blank white images — the SVG foreignObject font-loading problem and the two-call workaround.&lt;/p&gt;\n\n&lt;p&gt;Try BlockTeXu at &lt;a href=\"https://blocktexu.com/en/\" rel=\"noopener noreferrer\"&gt;blocktexu.com/en&lt;/a&gt;&lt;/p&gt;",
    "date": "2026-02-20T14:14:46.000Z",
    "url": "https://dev.to/x_kernel27795/why-your-react-keyboard-handler-always-reads-old-state-3ofl"
  },
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "This Week In React #269 : State of React, TanStack, Next.js | Hermes, Sparkling, Yoga | Interop, Electrobun, Module Federation",
    "partialText": "&lt;p&gt;Hi everyone!&lt;/p&gt;\n\n&lt;p&gt;Huge thanks ❤️ — &lt;strong&gt;we just hit &lt;a href=\"https://2025.stateofreact.com/en-US/resources/#blogs_news_magazines\" rel=\"noopener noreferrer\"&gt;#1 resource&lt;/a&gt;&lt;/strong&gt; on the State of React 2025 survey. Wild.&lt;/p&gt;\n\n&lt;p&gt;This week leans heavily into TanStack and Next.js content, plus a few notable releases worth your time.&lt;/p&gt;\n\n&lt;p&gt;On mobile, Hermes is clearly ramping up, and ByteDance just lowered the barrier to building Lynx apps.&lt;/p&gt;\n\n&lt;p&gt;Let’s dive in.&lt;/p&gt;\n\n\n\n\n&lt;p&gt;💡 Subscribe to the &lt;a href=\"https://thisweekinreact.com?utm_source=dev_crosspost\" rel=\"noopener noreferrer\"&gt;official newsletter&lt;/a&gt; to receive an email every week!&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://thisweekinreact.com?utm_source=dev_crosspost\" rel=\"noopener noreferrer\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fz4uz6ixhzg21rrks3os9.png\" alt=\"banner\" width=\"800\" height=\"373\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  💸 Sponsor\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;a href=\"https://coderabbit.link/twir\" rel=\"noopener noreferrer\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Flw04v71ftw7jo1cg7bie.jpg\" alt=\"Cut Code Review Time &amp;amp; Bugs in Half\" width=\"800\" height=\"418\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;&lt;a href=\"https://coderabbit.link/twir\" rel=\"noopener noreferrer\"&gt;Cut Code Review Time &amp;amp; Bugs in Half&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Code reviews are critical but time-consuming. CodeRabbit acts as your AI co-pilot, providing instant Code review comments and potential impacts of every pull request.&lt;/p&gt;\n\n&lt;p&gt;Beyond just flagging issues, CodeRabbit provides one-click fix suggestions and lets you define custom code quality rules using AST Grep patterns, catching subtle issues that traditional static analysis tools might miss.&lt;/p&gt;\n\n&lt;p&gt;CodeRabbit reviews 1 million PRs every week across 3 million repositories and is used by 100 thousand Open-source projects.&lt;/p&gt;\n\n&lt;p&gt;CodeRabbit is free for all open-source repo's.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://coderabbit.link/twir\" rel=\"noopener noreferrer\"&gt;Get started today&lt;/a&gt;&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  ⚛️ React\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;a href=\"https://2025.stateofreact.com/\" rel=\"noopener noreferrer\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fw4a6a3zqriuj63a8s7de.jpg\" alt=\"State of React 2025 - Survey Results\" width=\"800\" height=\"485\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;&lt;a href=\"https://2025.stateofreact.com/\" rel=\"noopener noreferrer\"&gt;State of React 2025 - Survey Results&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;The State of React 2025 survey results are out. It’s impossible to summarize it all here, but here's what I've taken away:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;code&gt;useEffect&lt;/code&gt; remains the most disliked hook&lt;/li&gt;\n&lt;li&gt;\n&lt;code&gt;&amp;lt;Suspense&amp;gt;&lt;/code&gt; increased in both adoption and satisfaction&lt;/li&gt;\n&lt;li&gt;React Server Components and Server Functions divide&lt;/li&gt;\n&lt;li&gt;Although usage is still low, &lt;code&gt;&amp;lt;Activity&amp;gt;&lt;/code&gt; reaches a 100% satisfaction score&lt;/li&gt;\n&lt;li&gt;TanStack Query and Zustand remain the favorite libraries&lt;/li&gt;\n&lt;li&gt;Your favorite resources are the official docs, this newsletter (❤️), Syntax.fm, Theo.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Read also the &lt;a href=\"https://certificates.dev/blog/breaking-down-state-of-react-2025-results\" rel=\"noopener noreferrer\"&gt;breakdown from Aurora Scharff&lt;/a&gt;, who wrote the survey conclusion.&lt;/p&gt;\n\n\n\n\n&lt;ul&gt;\n&lt;li&gt;💸 &lt;a href=\"https://frontendmasters.com/courses/react-performance-v2/?utm_source=reactweekly&amp;amp;utm_medium=email&amp;amp;utm_campaign=reactperf\" rel=\"noopener noreferrer\"&gt;Make React apps fast where it actually matters. Learn how to diagnose real bottlenecks and fix slow, janky React apps using modern React 19 patterns.&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;🔐 &lt;a href=\"https://socket.dev/blog/high-severity-rce-vulnerability-disclosed-in-next-mdx-remote\" rel=\"noopener noreferrer\"&gt;High-Severity RCE Vulnerability Disclosed in next-mdx-remote&lt;/a&gt; - Member that MDX is code and it’s unsafe to evaluate untrusted MDX strings.&lt;/li&gt;\n&lt;li&gt;🗓 &lt;a href=\"https://react.paris/?utm_source=thisweekinreact\" rel=\"noopener noreferrer\"&gt;React Paris 2026&lt;/a&gt; - 🇫🇷 Paris - 26 &amp;amp; 27 March. Last chance to join! Ticket sales close on March 4th - don't miss this premier React event. Get a 10% discount with code \"TWIR\".&lt;/li&gt;\n&lt;li&gt;📜 &lt;a href=\"https://vercel.com/blog/we-ralph-wiggumed-webstreams-to-make-them-10x-faster\" rel=\"noopener noreferrer\"&gt;Vercel - We Ralph Wiggumed WebStreams to make them 10x faster&lt;/a&gt; - For Next.js and other React/SSR/RSC heavy workloads, the Node.js native implementation of WebStreams can be major a bottleneck. They implemented a much faster spec-compliant alternative, until upstream performance improvements land in Node.js. No doubt Next.js is going to benefit from all this soon.&lt;/li&gt;\n&lt;li&gt;📜 &lt;a href=\"https://nextjs.org/blog/agentic-future\" rel=\"noopener noreferrer\"&gt;Building Next.js for an agentic future&lt;/a&gt; - The Next.js team realized they need to treats agents as first-class users, thinking from their perspective.&lt;/li&gt;\n&lt;li&gt;📜 &lt;a href=\"https://rednegra.net/blog/20260212-virtual-scroll/\" rel=\"noopener noreferrer\"&gt;Virtual Scrolling for Billions of Rows&lt;/a&gt; - 5 vertical scrolling techniques from the &lt;code&gt;`hightable`&lt;/code&gt; React virtualization library.&lt;/li&gt;\n&lt;li&gt;📜 &lt;a href=\"https://shadcnspace.com/blog/radix-ui-vs-base-ui\" rel=\"noopener noreferrer\"&gt;Radix UI vs Base UI - Detailed Guide&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📜 &lt;a href=\"https://dev.to/elvissautet/nextjs-finally-has-competition-2lg7\"&gt;Next.js Finally Has Competition (TanStack Start)&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📜 &lt;a href=\"https://engineering.gusto.com/the-journey-to-a-safer-frontend-why-we-removed-react-fc-095ff0b3e2e4\" rel=\"noopener noreferrer\"&gt;The Journey to a Safer Frontend: Why Gusto Removed&lt;/a&gt; &lt;a href=\"http://React.FC\" rel=\"noopener noreferrer\"&gt;&lt;code&gt;React.FC&lt;/code&gt;&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;💸 &lt;a href=\"https://r2trck.com/twir-7?utm_medium=email-media-newsletter&amp;amp;utm_source=twir-cpa&amp;amp;utm_campaign=the-secret-to-faster-rag-systems-cpa&amp;amp;utm_content=paid&amp;amp;utm_term=1-1-2026\" rel=\"noopener noreferrer\"&gt;The Secret to Faster RAG Systems by ElevenLabs&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://github.com/tailwindlabs/tailwindcss/releases/tag/v4.2.0\" rel=\"noopener noreferrer\"&gt;Tailwind 4.2 - Webpack plugin, new utilities and color palettes&lt;/a&gt; - The Webpack plugin has been contributed by Tim Neutkens and should lead to &lt;a href=\"https://x.com/timneutkens/status/2024140710786523301\" rel=\"noopener noreferrer\"&gt;significant&lt;/a&gt; performance improvements for frameworks like Next.js (even for Turbopack).&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://base-ui.com/react/overview/releases/v1-2-0\" rel=\"noopener noreferrer\"&gt;Base UI 1.2 - Drawer component, support lazy/async components in &lt;code&gt;render&lt;/code&gt;, new &lt;code&gt;useFilteredItems&lt;/code&gt; hook&lt;/a&gt; - The new Drawer component is in preview (&lt;a href=\"https://base-ui.com/react/components/drawer\" rel=\"noopener noreferrer\"&gt;docs&lt;/a&gt;) for now. Unlike Radix, it’s not based on Vaul (now unmaintained).&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://tanstack.com/hotkeys/latest\" rel=\"noopener noreferrer\"&gt;TanStack Hotkeys alpha&lt;/a&gt; - This brand-new TanStack library is framework-agnostic, but initially comes with a first-class React integration. It provides a type-safe API, normalizes modifiers across platforms, supports multi-step keyboard sequences, and more.&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://tanstack.com/start/latest/docs/framework/react/guide/import-protection\" rel=\"noopener noreferrer\"&gt;TanStack Start 1.161 - Import protection&lt;/a&gt; - Ensures your code runs in the right client/server environment.&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://github.com/preactjs/preact/releases/tag/11.0.0-beta.1\" rel=\"noopener noreferrer\"&gt;Preact 11.0 beta.1&lt;/a&gt; - By the way, TanStack query now &lt;a href=\"https://github.com/TanStack/query/releases/tag/%40tanstack%2Fpreact-query%405.91.0\" rel=\"noopener noreferrer\"&gt;supports Preact&lt;/a&gt;.&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://github.com/millionco/react-doctor\" rel=\"noopener noreferrer\"&gt;React Doctor - Scan your codebase, let coding agents diagnose/fix your React code&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://github.com/vercel-labs/json-render/releases/tag/%40json-render%2Fshadcn%400.7.0\" rel=\"noopener noreferrer\"&gt;json-render 0.7 - Generative UI framework - Add 30+ shadcn/ui components, and more&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;🎥 &lt;a href=\"https://www.youtube.com/watch?v=Ab01W6h4Giw\" rel=\"noopener noreferrer\"&gt;Austin Davis - TanStack Router - How to Become a Routing God in React&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;🎥 &lt;a href=\"https://www.youtube.com/watch?v=3jJ2Xz-oWt8\" rel=\"noopener noreferrer\"&gt;Josef Bender - TanStack Loaders vs Context: What I Got Wrong&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;🎥 &lt;a href=\"https://www.youtube.com/watch?v=vKsh_qrv7lM\" rel=\"noopener noreferrer\"&gt;Shruti Kapoor - Build a YouTube content dashboard with generative UI (Tambo)&lt;/a&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  💸 Sponsor\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;a href=\"https://sentry.io/resources/seer-workshop-series/?utm_source=thisweekinreact&amp;amp;utm_medium=paid-community&amp;amp;utm_campaign=seer-fy27q1-seerworkshop&amp;amp;utm_content=newsletter-workshop-register\" rel=\"noopener noreferrer\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fqtbnoe7m0ltd8e6av9jq.jpg\" alt=\"Free Workshop: Debug React Apps With AI From Dev to Prod\" width=\"800\" height=\"418\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;&lt;a href=\"https://sentry.io/resources/seer-workshop-series/?utm_source=thisweekinreact&amp;amp;utm_medium=paid-community&amp;amp;utm_campaign=seer-fy27q1-seerworkshop&amp;amp;utm_content=newsletter-workshop-register\" rel=\"noopener noreferrer\"&gt;Free Workshop: Debug React Apps With AI From Dev to Prod&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;🧠 &lt;a href=\"https://sentry.io/product/seer/?utm_source=thisweekinreact&amp;amp;utm_medium=paid-community&amp;amp;utm_campaign=seer-fy27q1-seerlaunch&amp;amp;utm_content=newsletter-product-trysentry\" rel=\"noopener noreferrer\"&gt;&lt;strong&gt;Seer&lt;/strong&gt; is Sentry's AI debugging agent&lt;/a&gt;. It root causes errors, suggests fixes, and catches bugs in code review before they hit production.&lt;/p&gt;\n\n&lt;p&gt;This free 4-part workshop series covers the full workflow: production error triage, root cause analysis, AI code review, and debugging via MCP. Each session goes hands-on with a specific feature so you can actually set it up and use it in your own projects. No fluff, just walkthroughs you can follow along with.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://sentry.io/resources/seer-workshop-series/?utm_source=thisweekinreact&amp;amp;utm_medium=paid-community&amp;amp;utm_campaign=seer-fy27q1-seerworkshop&amp;amp;utm_content=newsletter-workshop-register\" rel=\"noopener noreferrer\"&gt;&lt;strong&gt;Register today&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  📱 React-Native\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;a href=\"https://x.com/tmikov/status/2023821160241393839\" rel=\"noopener noreferrer\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fo5y7hkij1pib70f58xhc.jpg\" alt=\"WebAssembly Comes to Hermes\" width=\"800\" height=\"319\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;&lt;a href=\"https://x.com/tmikov/status/2023821160241393839\" rel=\"noopener noreferrer\"&gt;WebAssembly Comes to Hermes&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;An exciting early preview of WebAssembly support in Hermes, unlocking new ways to integrate C, C++, Rust, and more into your React Native app. It’s even possible to precompile WASM to Hermes bytecode &lt;code&gt;.hbc&lt;/code&gt; files.&lt;/p&gt;\n\n\n\n\n&lt;p&gt;&lt;a href=\"https://tiktok.github.io/sparkling/\" rel=\"noopener noreferrer\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fiwbf3h5pdicg5flj6l85.jpg\" alt=\"Sparkling - Unlocks Lynx at TikTok Scale\" width=\"800\" height=\"394\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;&lt;a href=\"https://tiktok.github.io/sparkling/\" rel=\"noopener noreferrer\"&gt;Sparkling - Unlocks Lynx at TikTok Scale&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;ByteDance unveiled Lynx last year as an interesting framework-agnostic alternative to React Native. So far, the DX has been limited, and there has been no easy way to create a new Lynx app from scratch. Sparkling changes that, and offers the tooling that Lynx apps deserve. By the way, &lt;a href=\"https://lynxjs.org/blog/lynx-3-6\" rel=\"noopener noreferrer\"&gt;Lynx 3.6&lt;/a&gt; is out, improving support for React, AI, and CSS.&lt;/p&gt;\n\n&lt;p&gt;See also:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;📦 &lt;a href=\"https://lynxjs.org/blog/lynx-3-6\" rel=\"noopener noreferrer\"&gt;Lynx 3.6 - Lynx for AI, ReactLynx hooks, CSS for Design&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;🎥 &lt;a href=\"https://www.callstack.com/events/sparkling-a-new-framework-for-lynx\" rel=\"noopener noreferrer\"&gt;Sparkling: A New Framework for Lynx&lt;/a&gt; - A 2h event with Callstack and the Lynx team.&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;ul&gt;\n&lt;li&gt;💸 &lt;a href=\"https://go.posthog.com/twir-feb18\" rel=\"noopener noreferrer\"&gt;Product for Engineers - 10x job posts for 10x engineers&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;👀 &lt;a href=\"https://github.com/facebook/yoga/pull/1874\" rel=\"noopener noreferrer\"&gt;Yoga PR - Add core Yoga support for CSS &lt;code&gt;calc()&lt;/code&gt;&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📜 &lt;a href=\"https://expo.dev/blog/the-production-playbook-for-ota-updates\" rel=\"noopener noreferrer\"&gt;Expo - The production playbook for OTA updates&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📜 &lt;a href=\"https://www.callstack.com/blog/agent-device-ai-native-mobile-automation-for-ios-android\" rel=\"noopener noreferrer\"&gt;Agent Device: iOS &amp;amp; Android Automation for AI Agents&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📜 &lt;a href=\"https://www.callstack.com/blog/a-practical-guide-to-react-native-monorepo-with-yarn-workspaces\" rel=\"noopener noreferrer\"&gt;A Practical Guide to React Native Monorepo With Yarn Workspaces&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://www.react-native-ai.dev/docs/json-ui/getting-started\" rel=\"noopener noreferrer\"&gt;@react-native-ai/json-ui alpha - Generative UI, tailor-made for small, local language models&lt;/a&gt; - Similar to json-render, but on-device.&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://github.com/getsentry/sentry-react-native/releases/tag/8.0.0\" rel=\"noopener noreferrer\"&gt;Sentry React Native 8.0 - Capture App Start errors and crashes&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://github.com/callstackincubator/agent-device/releases/tag/v0.4.0\" rel=\"noopener noreferrer\"&gt;Agent Device 0.4 - CLI to control iOS/Android devices - Supports testing on physical devices&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://github.com/software-mansion/react-native-enriched/releases/tag/v0.4.0\" rel=\"noopener noreferrer\"&gt;Enriched 0.4 - Rich text editor - Support animated gifs, pasting images, checkbox lists&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://github.com/software-mansion-labs/react-native-enriched-markdown/releases/tag/0.2.0\" rel=\"noopener noreferrer\"&gt;Enriched Markdown 0.2 - Layout controls, a11y, font scaling, strikethrough/underline&lt;/a&gt; - The next release will be even better, &lt;a href=\"https://github.com/software-mansion-labs/react-native-enriched-markdown/issues/47#issuecomment-3914681397\" rel=\"noopener noreferrer\"&gt;bringing full GitHub Flavored Markdown support&lt;/a&gt; (support for tables/autolinks already merged).&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://github.com/arekkubaczkowski/react-native-bottom-sheet-stack/releases/tag/v1.8.0\" rel=\"noopener noreferrer\"&gt;Bottom Sheet Stack 1.8 - Stack manager for bottom sheets and modals - Now library-agnostic, including built-in adapters&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://github.com/callstackincubator/voltra/releases/tag/v1.2.0\" rel=\"noopener noreferrer\"&gt;Voltra 1.2 - Widgets/Live Activities framework - New iOS layout engine, improved Expo support, new &lt;code&gt;getActiveWidgets()&lt;/code&gt; API&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;🤖 &lt;a href=\"https://skills.sh/callstack/react-native-testing-library/react-native-testing\" rel=\"noopener noreferrer\"&gt;React Native Testing Library Skill&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;🤖 &lt;a href=\"https://skills.sh/react-native-community/skills/upgrade-react-native\" rel=\"noopener noreferrer\"&gt;React Native Community - Upgrade RN Skill&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;🎥 &lt;a href=\"https://www.youtube.com/watch?v=ycYM_zKEF_4\" rel=\"noopener noreferrer\"&gt;Beto - How to Add Rich Push Notifications in Expo (iOS Images)&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;🎥 &lt;a href=\"https://www.youtube.com/watch?v=nARu6acI5kM\" rel=\"noopener noreferrer\"&gt;Simon Grimm - How I’d Learn React Native Today (2026 Edition)&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;🎙️ &lt;a href=\"https://www.callstack.com/podcasts/local-first-voice-ai-and-app-security\" rel=\"noopener noreferrer\"&gt;React Universe on Air - From Teddy Bears to Voice Agents: Kraen Hansen on Voice AI, Local-First &amp;amp; App Security&lt;/a&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  🔀 Other\n&lt;/h2&gt;\n\n&lt;ul&gt;\n&lt;li&gt;👀 &lt;a href=\"https://webkit.org/blog/17818/announcing-interop-2026/\" rel=\"noopener noreferrer\"&gt;Interop 2026&lt;/a&gt; - Web browsers unveiled their focus areas for the year. This includes new features (cross-document view transitions, scroll-driven animations, container style queries…), but also stabilizing carryovers from Interop 2025 (anchor positioning, navigation API…).&lt;/li&gt;\n&lt;li&gt;👀 &lt;a href=\"https://www.w3.org/TR/2026/WD-selectors-5-20260217/\" rel=\"noopener noreferrer\"&gt;Selectors Level 5 - W3C First Public Working Draft&lt;/a&gt; - Preview of new CSS selectors and pseudo-classes being worked.&lt;/li&gt;\n&lt;li&gt;📜 &lt;a href=\"https://frontendmasters.com/blog/fun-with-typescript-generics/\" rel=\"noopener noreferrer\"&gt;Fun with TypeScript Generics&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📜 &lt;a href=\"https://cpojer.net/posts/fastest-frontend-tooling\" rel=\"noopener noreferrer\"&gt;Fastest Frontend Tooling for Humans &amp;amp; AI&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://module-federation.io/blog/v2-stable-version.html\" rel=\"noopener noreferrer\"&gt;Module Federation 2.0 - Micro-Frontend Architecture&lt;/a&gt; - Adds support for SSR among many other things. They also plan to add support for React Server Components later.&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://blackboard.sh/blog/electrobun-v1/\" rel=\"noopener noreferrer\"&gt;Electrobun 1.0 - Build ultra fast, tiny, and cross-platform desktop apps with TypeScript&lt;/a&gt; - An alternative to Tauri based on Bun/Zig.&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://developer.chrome.com/blog/new-in-devtools-145\" rel=\"noopener noreferrer\"&gt;Chrome 145 DevTools&lt;/a&gt; - The performance panel now includes Soft Navigation markers, improving the DX when troubleshooting client-side navigation (SPA/CSR apps).&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://biomejs.dev/blog/biome-v2-4/\" rel=\"noopener noreferrer\"&gt;Biome 2.4 - Embedded Snippets, HTML Accessibility, and Better Framework Support&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;📦 &lt;a href=\"https://pnpm.io/blog/releases/10.30\" rel=\"noopener noreferrer\"&gt;pnpm 10.30 - Improves &lt;code&gt;pnpm why&lt;/code&gt;, showing an easier-to-understand reverse dependency tree&lt;/a&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  🤭 Fun\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;a href=\"https://x.com/DavidKPiano/status/1981470720166154567\" rel=\"noopener noreferrer\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Facgrcabrm1ehll3lz9wt.jpg\" alt=\"alt\" width=\"800\" height=\"691\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://x.com/swyx/status/2022854115748122909\" rel=\"noopener noreferrer\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fq4mlsna45cpq7sgc6k9c.jpg\" alt=\"alt\" width=\"800\" height=\"936\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;See ya! 👋&lt;/p&gt;",
    "date": "2026-02-20T13:31:28.000Z",
    "url": "https://dev.to/sebastienlorber/this-week-in-react-269-state-of-react-tanstack-nextjs-hermes-sparkling-yoga-interop-g7j"
  },
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "A Guide to Multi-Server MCP with React & FastMCP",
    "partialText": "&lt;p&gt;The Model Context Protocol (MCP) is rapidly becoming the \"universal connector\" for AI. But while many tutorials focus on using MCP with Claude Desktop, the real power lies in building your own custom client-server architecture.&lt;/p&gt;\n\n&lt;p&gt;Today, we’re building a full-stack local agentic hub:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;MCP Server (Python): A tools-heavy server using fastmcp to fetch real-time news and weather.&lt;/li&gt;\n&lt;li&gt;MCP Client (Node.js): A backend gateway using mcp-use-ts to manage multiple server connections.&lt;/li&gt;\n&lt;li&gt;Frontend (React): A sleek chat interface for interacting with your AI agent.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;&lt;strong&gt;Part 1: The Python MCP Server&lt;/strong&gt;&lt;br&gt;\nWe’ll use FastMCP, a high-level framework that makes tool definition as easy as writing a Python function.&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Setup\n&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;pip install fastmcp httpx\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;ul&gt;\n&lt;li&gt;Server\n&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;from fastmcp import FastMCP\nimport httpx\n\nmcp = FastMCP(\"LocalInsights\")\n\n@mcp.tool()\nasync def get_weather(latitude: float, longitude: float) -&amp;gt; str:\n    \"\"\"Get the weather forecast for specific coordinates.\"\"\"\n    async with httpx.AsyncClient() as client:\n        # NWS API Example\n        resp = await client.get(f\"https://api.weather.gov/points/{latitude},{longitude}\")\n        forecast_url = resp.json()[\"properties\"][\"forecast\"]\n        forecast = await client.get(forecast_url)\n        return forecast.json()[\"properties\"][\"periods\"][0][\"detailedForecast\"]\n\n@mcp.tool()\nasync def get_news(category: str = \"technology\") -&amp;gt; str:\n    \"\"\"Get latest news headlines for a category.\"\"\"\n    # Example using a mock/free news aggregator\n    return f\"Latest {category} news: MCP is taking over the world! (Mocked response)\"\n\nif __name__ == \"__main__\":\n    mcp.run()\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;&lt;strong&gt;Part 2: The Node.js Client Gateway&lt;/strong&gt;&lt;br&gt;\nNext, we build the \"orchestrator\" using mcp-use-ts. This layer connects to our Python server (and others) and exposes a unified API for our React frontend.&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Setup\n&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;npm install @mcp-use/mcp-use-ts express cors\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;ul&gt;\n&lt;li&gt;The Node Client (client.ts)\n&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;import { McpClient } from \"@mcp-use/mcp-use-ts\";\nimport express from \"express\";\nimport cors from \"cors\";\n\nconst app = express();\napp.use(cors());\napp.use(express.json());\n\n// Configure MCP servers\nconst client = MCPClient.fromDict({\n  mcpServers: {\n    filesystem: {\n      command: 'npx',\n      args: ['@modelcontextprotocol/server-filesystem']\n    },\n    github: {\n      command: 'npx',\n      args: ['@modelcontextprotocol/server-github'],\n      env: { GITHUB_TOKEN: process.env.GITHUB_TOKEN }\n    },\n    insights: {\n      command: \"python\",\n      args: [\"server.py\"],\n    }\n  }\n})\n\n// Create an AI agent\nconst agent = new MCPAgent({\n  llm: new ChatOpenAI({ model: 'gpt-4' }),\n  client,\n  maxSteps: 10\n})\n\napp.post('/chat', async (req, res) =&amp;gt; {\n  try {\n    const { message } = req.body;\n\n    // Process message with MCP servers\n    const response = await agent.run(message);\n\n    // Send AI response back to client\n    res.json({\n      type: 'assistant',\n      message: response,\n      timestamp: new Date().toISOString(),\n      userId: 'assistant',\n    });\n  } catch (error) {\n    console.error('Error processing message:', error);\n    res.status(500).json({\n      type: 'error',\n      message: 'Sorry, I encountered an error processing your request.',\n      timestamp: new Date().toISOString(),\n    });\n  }\n});\n\napp.listen(3001, () =&amp;gt; console.log(\"Node Gateway running on port 3001\"));\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;&lt;strong&gt;Part 3: The React Chat Interface&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Finally, we need a UI. We’ll build a simple React chat that sends messages to our Node.js gateway.&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;The Chat Component (Chat.jsx)\nWe want a clean, agent-style interface.\n&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;import React, { useState } from 'react';\n\nconst ChatInterface = () =&amp;gt; {\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState(\"\");\n\n  const handleSend = async () =&amp;gt; {\n    const userMsg = { role: 'user', text: input };\n    setMessages([...messages, userMsg]);\n\n    const response = await fetch(\"http://localhost:3001/chat\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ message: input })\n    });\n\n    const data = await response.json();\n    setMessages(prev =&amp;gt; [...prev, { role: 'bot', text: data.response }]);\n    setInput(\"\");\n  };\n\n  return (\n    &amp;lt;div className=\"p-4 max-w-2xl mx-auto border rounded shadow\"&amp;gt;\n      &amp;lt;div className=\"h-64 overflow-y-auto mb-4 border-b\"&amp;gt;\n        {messages.map((m, i) =&amp;gt; (\n          &amp;lt;div key={i} className={`p-2 ${m.role === 'user' ? 'text-right' : 'text-left'}`}&amp;gt;\n            &amp;lt;span className={`inline-block p-2 rounded ${m.role === 'user' ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}&amp;gt;\n              {m.text}\n            &amp;lt;/span&amp;gt;\n          &amp;lt;/div&amp;gt;\n        ))}\n      &amp;lt;/div&amp;gt;\n      &amp;lt;div className=\"flex gap-2\"&amp;gt;\n        &amp;lt;input \n          className=\"flex-1 p-2 border rounded\" \n          value={input} \n          onChange={(e) =&amp;gt; setInput(e.target.value)} \n          placeholder=\"Ask about the weather...\"\n        /&amp;gt;\n        &amp;lt;button onClick={handleSend} className=\"bg-blue-600 text-white px-4 py-2 rounded\"&amp;gt;Send&amp;lt;/button&amp;gt;\n      &amp;lt;/div&amp;gt;\n    &amp;lt;/div&amp;gt;\n  );\n};\n\nexport default ChatInterface;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;Why This Architecture Wins&lt;br&gt;\nBy decoupling the Client (Node) from the Server (Python), you gain two massive advantages:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;u&gt;Language Polyglotism:&lt;/u&gt; Your server can be Python (great for data/ML), but your client can be TypeScript (great for web/concurrency).&lt;/li&gt;\n&lt;li&gt;\n&lt;u&gt;Scalability:&lt;/u&gt; You can connect your Node.js gateway to 10 different MCP servers—one for GitHub, one for Postgres, one for your local Weather tool—and the React frontend only needs to talk to one endpoint.&lt;/li&gt;\n&lt;/ul&gt;",
    "date": "2026-02-20T13:10:30.000Z",
    "url": "https://dev.to/alapati_suryapruthvi_955e/a-guide-to-multi-server-mcp-with-react-fastmcp-59f8"
  },
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "What are the best Stern pinball machines",
    "partialText": "&lt;p&gt;What Are the Best Stern Pinball Machines? (Full Guide for Collectors &amp;amp; New Buyers)&lt;br&gt;\nWhat Are the Best Stern Pinball Machines. Stern Pinball has been the heartbeat of the pinball world for decades, and wow — their machines just keep getting better! Whether you’re a hardcore collector, an operator wanting top-tier earnings, or a home buyer looking for an unforgettable game room centerpiece, Stern delivers excitement, immersion, and incredible build quality. &lt;a href=\"https://mojopinballlimited.com/what-are-the-best-stern-pinball-machines/\" rel=\"noopener noreferrer\"&gt;Stern pinball machines for sale Europe&lt;br&gt;\n&lt;/a&gt;&lt;br&gt;\nLet’s dive into the best Stern pinball machines that consistently stand out for players, operators, and enthusiasts worldwide. &lt;a href=\"https://mojopinballlimited.com/what-are-the-best-stern-pinball-machines/\" rel=\"noopener noreferrer\"&gt;Stern pinball machines Europe&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;Jurassic Park (Premium/LE) – An All-Time Modern Classic&lt;br&gt;\nWhat are the best Stern pinball machines. Stern’s Jurassic Park is a legendary masterpiece and one of the most praised pinball machines ever created. Its mix of deep rules, chaotic dinosaur escapes, and adrenaline-packed shots makes every playthrough feel like an adventure. Stern Premium vs Pro comparison&lt;/p&gt;\n\n&lt;p&gt;Why it’s amazing: Brilliant layout with nonstop flow, Stunning artwork and electrifying animations, Extremely high resale value, One of Stern’s best-earning location games. If you want a modern machine that impresses everyone — &lt;a href=\"https://mojopinballlimited.com/what-are-the-best-stern-pinball-machines/\" rel=\"noopener noreferrer\"&gt;Pinball machines for sale EU&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;Godzilla (Premium/LE) – The King of Modern Pinball&lt;br&gt;\nStern pinball distributors list Europe. Keith Elwin’s Godzilla is simply a phenomenon. Players around the world rave about its insane flow and satisfying shots. One of the smoothest layouts ever made, Mech-loaded destruction: bridges, buildings, and monsters, Deep rule set yet beginner-friendly, Awarded Game of the Year multiple times. This machine is a must-have for serious collectors. &lt;a href=\"https://mojopinballlimited.com/what-are-the-best-stern-pinball-machines/\" rel=\"noopener noreferrer\"&gt;Pinball arcade machines Europe&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;Deadpool (Premium/LE) – Fun, Humor &amp;amp; Style in One Package&lt;br&gt;\nDeadpool brings pure entertainment to the playfield. With hilarious callouts and a fast, flowing layout, it’s beloved by casual players and experts alike. Stern pinball machines in stock Europe&lt;br&gt;\nExtremely entertaining animations, Great mix of flow and controlled shots, Colorful, comic-book art style, Home-friendly and beginner-friendly. If you want a machine everyone laughs and enjoys instantly — &lt;a href=\"https://mojopinballlimited.com/what-are-the-best-stern-pinball-machines/\" rel=\"noopener noreferrer\"&gt;Stern pinball maszyny Polska&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;Metallica (Premium/LE) – A Hard-Hitting Rock Machine&lt;br&gt;\nMetallica remains one of Stern’s most iconic rock-themed games. Packed with energy, custom tracks, and exciting toys, it appeals to both pinball fans and music lovers. Flippery Stern na sprzedaż PL&lt;br&gt;\nOne of Stern’s best sound packages, Fast action and challenging gameplay, Explosive light shows, Highly collectible, Operators also love its longevity on location. &lt;a href=\"https://mojopinballlimited.com/what-are-the-best-stern-pinball-machines/\" rel=\"noopener noreferrer\"&gt;Pinball EU dystrybutor&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;Batman ’66 (Premium/LE) – Retro TV Magic Meets Modern Pinball&lt;br&gt;\nThis machine blends nostalgic charm with Stern’s cutting-edge technology, creating a visually stunning and feature-rich experience. &lt;a href=\"https://mojopinballlimited.com/what-are-the-best-stern-pinball-machines/\" rel=\"noopener noreferrer\"&gt;Maszyna pinball Stern Europa&lt;/a&gt;&lt;br&gt;\nIconic Adam West TV callouts, Colorful, campy 1960s theme, Deep modes and rewarding gameplay, Beautiful hand-drawn artwork. It’s a conversation piece in any game room. &lt;a href=\"https://mojopinballlimited.com/what-are-the-best-stern-pinball-machines/\" rel=\"noopener noreferrer\"&gt;Máquinas pinball Stern en venta España&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;Final Thoughts: Which Stern Pinball Machine Is Best?&lt;/p&gt;\n\n&lt;p&gt;What are the best Stern pinball machines. If you want pure gameplay excellence, go for Godzilla or Jurassic Park. If you want fun and personality, Deadpool is unbeatable. Comprar pinball Stern España&lt;br&gt;\nFor music lovers, Metallica still dominates. For nostalgia, Batman ’66 delivers timeless charm. The magic of Stern is that every machine brings something special — but any of the above models will raise the excitement level in your home or business instantly. &lt;a href=\"https://mojopinballlimited.com/what-are-the-best-stern-pinball-machines/\" rel=\"noopener noreferrer\"&gt;Mejor pinball Stern 2025 España&lt;/a&gt;&lt;/p&gt;",
    "date": "2026-02-20T10:46:43.000Z",
    "url": "https://dev.to/gilvo_tradebvba_6c5242eb/what-are-the-best-stern-pinball-machines-4109"
  },
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "Orchestrating Scalable Frontends: The Power of the Composition Root",
    "partialText": "&lt;p&gt;In previous chapters, we built the foundations of our frontend architecture. With Atomic Design, we organized our UI into shared/components, separating reusable, domain-agnostic elements from specific contexts. With Feature-Driven Architecture, we isolated the domain by introducing features/ as autonomous business units.&lt;/p&gt;\n\n&lt;p&gt;But a real-world application isn't just a collection of isolated modules. It is a system where domains must collaborate. The question becomes inevitable: How can we allow features to communicate with each other without destroying the isolation we just built?&lt;/p&gt;\n\n&lt;p&gt;The answer lies in introducing a higher level of orchestration: the Pages layer acting as a Composition Root.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Revisiting the Structure\n&lt;/h2&gt;\n\n&lt;p&gt;Our architecture, consistent with our previous principles, looks like this:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;src/\n├─ shared/             # Reusable UI &amp;amp; utilities (Atomic Design)\n├─ features/           # Isolated domains (Feature-Driven)\n│   ├─ cart/\n│   └─ checkout/\n├─ pages/              # Orchestration &amp;amp; Composition Layer\n└─ app/                # Global bootstrapping\n\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;We have already defined a fundamental rule: &lt;strong&gt;A feature can depend on &lt;code&gt;shared/&lt;/code&gt;, but it must not know about the existence of other features.&lt;/strong&gt; &lt;code&gt;features/cart&lt;/code&gt; should never import anything from &lt;code&gt;features/checkout&lt;/code&gt;. This is not a technical limitation; it is a design choice that preserves domain independence.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  The Risk of the \"Cannibal Feature\" (God Feature)\n&lt;/h2&gt;\n\n&lt;p&gt;Why can't we just let features talk to each other? Because refusing a higher orchestration layer exposes us to a fatal risk: &lt;strong&gt;Feature Cannibalization&lt;/strong&gt;.&lt;/p&gt;\n\n&lt;p&gt;In a flat architecture, if the &lt;code&gt;Cart&lt;/code&gt; needs to trigger the &lt;code&gt;Checkout&lt;/code&gt;, a developer will eventually be forced to import the Checkout module into the Cart. At that moment, isolation vanishes. One of the two features \"eats\" the other, becoming a bloated module—a &lt;strong&gt;God Feature&lt;/strong&gt;—that drags along dependencies, logic, and types that do not belong to it.&lt;/p&gt;\n\n&lt;h3&gt;\n  \n  \n  The Illusion of Simplicity\n&lt;/h3&gt;\n\n&lt;p&gt;Eliminating the &lt;code&gt;pages/&lt;/code&gt; layer might seem like a simplification. In reality, we are just hiding complexity. If the &lt;code&gt;Cart&lt;/code&gt; feature contains the navigation logic to the &lt;code&gt;Checkout&lt;/code&gt;, that component is no longer truly reusable. If you wanted to use that &lt;code&gt;Cart&lt;/code&gt; in an informational Sidebar without a checkout tomorrow, you couldn't do it without dragging along the entire payment system.&lt;/p&gt;\n\n&lt;blockquote&gt;\n&lt;p&gt;&lt;strong&gt;The principle is clear:&lt;/strong&gt; A Feature must be \"dumb\" regarding the global context to be \"smart\" regarding its business logic.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Pages as a Composition Root\n&lt;/h2&gt;\n\n&lt;p&gt;In the book &lt;em&gt;Clean Architecture&lt;/em&gt;, Robert C. Martin introduces the concept of the &lt;strong&gt;Composition Root&lt;/strong&gt;. It is the place where dependencies are assembled and modules are composed. In the frontend, the &lt;strong&gt;Page&lt;/strong&gt; represents this architectural pivot.&lt;/p&gt;\n\n&lt;p&gt;The Page is not just a route container; it is the level where:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;Features are instantiated.&lt;/li&gt;\n&lt;li&gt;Their contracts (callbacks, events) are connected.&lt;/li&gt;\n&lt;li&gt;Responsibilities are coordinated.&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;h3&gt;\n  \n  \n  The Director and the Actors\n&lt;/h3&gt;\n\n&lt;p&gt;Think of the Page as a &lt;strong&gt;Theater Director&lt;/strong&gt;:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Features&lt;/strong&gt; are the actors: they know how to play their part perfectly, but they don't decide when to enter the stage.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;The Page&lt;/strong&gt; is the director: it knows that when Actor A (&lt;code&gt;Cart&lt;/code&gt;) emits an event, it must signal Actor B (&lt;code&gt;Checkout&lt;/code&gt;) to step in.&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Hierarchy of Responsibilities\n&lt;/h2&gt;\n\n&lt;p&gt;The architecture takes a clear shape based on &lt;strong&gt;decreasing knowledge&lt;/strong&gt;:&lt;/p&gt;\n\n&lt;div class=\"table-wrapper-paragraph\"&gt;&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;Layer&lt;/th&gt;\n&lt;th&gt;Responsibility&lt;/th&gt;\n&lt;th&gt;Knowledge Level&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;app/&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Bootstrapping&lt;/td&gt;\n&lt;td&gt;Knows everything (Global State, Routing)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;pages/&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;&lt;strong&gt;Orchestrate&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Knows multiple features, but not their internal logic&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;features/&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;&lt;strong&gt;Domain&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Knows only itself&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;shared/&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;&lt;strong&gt;Utility&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Domain Agnostic (Knows nothing of business)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;/div&gt;\n\n&lt;p&gt;The correct flow is always vertical:&lt;br&gt;\n&lt;strong&gt;Feature A  ←  Page  →  Feature B&lt;/strong&gt;&lt;br&gt;\n(Never: Feature A → Feature B)&lt;/p&gt;\n\n\n&lt;h2&gt;\n  \n  \n  Substitutability and Maturity\n&lt;/h2&gt;\n\n&lt;p&gt;Many codebases start by allowing direct communication between modules. It works while the project is small. Over time, changes propagate unpredictably.&lt;/p&gt;\n\n&lt;p&gt;Introducing an explicit orchestration layer is the moment a project stops being just \"functional\" and becomes truly &lt;strong&gt;evolvable&lt;/strong&gt;. Imagine wanting to replace the &lt;code&gt;checkout/&lt;/code&gt; domain entirely:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;features/\n├─ cart/\n├─ checkout/\n└─ new-checkout/\n\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;The only change occurs in the &lt;code&gt;pages/&lt;/code&gt; layer. The &lt;code&gt;Cart&lt;/code&gt; remains untouched. This is possible because orchestration is centralized in the composition root, not distributed across features.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  The Core Principle\n&lt;/h2&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Features solve business problems.&lt;/li&gt;\n&lt;li&gt;Pages solve coordination problems.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Atomic Design gave us order in the UI. Feature-Driven Architecture gave us domain isolation. The Pages layer gives us &lt;strong&gt;control over the flows&lt;/strong&gt;. Separation is important, but knowing &lt;strong&gt;where to compose&lt;/strong&gt; is even more vital.&lt;/p&gt;\n\n\n\n\n&lt;h3&gt;\n  \n  \n  Next Step: Toward the Page-Level Store\n&lt;/h3&gt;\n\n&lt;p&gt;As long as the data flow is linear, composition via props in the Page is sufficient. But what happens when multiple features must stay synchronized in real-time or a complex dashboard requires shared state without violating isolation?&lt;/p&gt;\n\n&lt;p&gt;In the next article, we will explore the &lt;strong&gt;Page-Level Store&lt;/strong&gt;: an ephemeral, page-scoped state that allows fluid communication while keeping domain boundaries intact.&lt;/p&gt;\n\n\n\n\n&lt;p&gt;Connect on &lt;a href=\"https://www.linkedin.com/in/josephciullo/\" rel=\"noopener noreferrer\"&gt;LinkedIn&lt;/a&gt; for more updates and insights.&lt;/p&gt;",
    "date": "2026-02-20T10:39:29.000Z",
    "url": "https://dev.to/josephciullo/orchestrating-scalable-frontends-the-power-of-the-composition-root-3b0a"
  },
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "Adding Custom SVG Icons to Your React Application",
    "partialText": "&lt;p&gt;SVG icons have become the standard for sharp, scalable graphics on the web, and React’s component-based model makes it a natural fit for integrating them. Whether you’re building a design system, a dashboard, or a marketing site, you’ll eventually need to add custom SVG icons to your React application. But what’s the best way to handle them? Should you inline SVGs, turn them into components, use sprites, or load them dynamically? Each approach comes with its own trade-offs regarding maintainability, performance, and developer experience.&lt;/p&gt;\n\n&lt;p&gt;Let’s walk through four popular strategies for using custom SVG icons in React: inline SVG, SVG as React components, SVG sprite sheets, and dynamic import. We’ll compare their pros and cons, provide TypeScript-based code examples for each, and help you choose the right method for your project.&lt;/p&gt;\n\n&lt;h2&gt;\n  \n  \n  1. Inline SVG: Direct Embedding in JSX\n&lt;/h2&gt;\n\n&lt;p&gt;The most straightforward way to use an SVG icon is to copy its markup directly into your React component. This approach gives you full control over the SVG’s structure and styling.&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight tsx\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;// src/components/CheckIcon.tsx&lt;/span&gt;\n&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"nx\"&gt;React&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;react&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;CheckIcon&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;React&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;FC&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;React&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;SVGProps&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;SVGSVGElement&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;props&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;\n  &lt;span class=\"p\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nt\"&gt;svg&lt;/span&gt;\n    &lt;span class=\"na\"&gt;viewBox&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"s\"&gt;\"0 0 24 24\"&lt;/span&gt;\n    &lt;span class=\"na\"&gt;fill&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"s\"&gt;\"none\"&lt;/span&gt;\n    &lt;span class=\"na\"&gt;stroke&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"s\"&gt;\"currentColor\"&lt;/span&gt;\n    &lt;span class=\"na\"&gt;width&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"mi\"&gt;24&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt;\n    &lt;span class=\"na\"&gt;height&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"mi\"&gt;24&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt;\n    &lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"nx\"&gt;props&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt;\n  &lt;span class=\"p\"&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"p\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nt\"&gt;path&lt;/span&gt; &lt;span class=\"na\"&gt;d&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"s\"&gt;\"M5 13l4 4L19 7\"&lt;/span&gt; &lt;span class=\"na\"&gt;strokeWidth&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"mi\"&gt;2&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt; &lt;span class=\"na\"&gt;strokeLinecap&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"s\"&gt;\"round\"&lt;/span&gt; &lt;span class=\"na\"&gt;strokeLinejoin&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"s\"&gt;\"round\"&lt;/span&gt; &lt;span class=\"p\"&gt;/&amp;gt;&lt;/span&gt;\n  &lt;span class=\"p\"&gt;&amp;lt;/&lt;/span&gt;&lt;span class=\"nt\"&gt;svg&lt;/span&gt;&lt;span class=\"p\"&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;&lt;strong&gt;Usage:&lt;/strong&gt;&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight tsx\"&gt;&lt;code&gt;&lt;span class=\"p\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nc\"&gt;CheckIcon&lt;/span&gt; &lt;span class=\"na\"&gt;style&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"na\"&gt;color&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;green&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt; &lt;span class=\"p\"&gt;/&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;h3&gt;\n  \n  \n  Pros\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Maximum flexibility&lt;/strong&gt;: Directly edit paths, add accessibility tags, animate parts, or change colors with props.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;No build tooling required&lt;/strong&gt;: Works in any React app out of the box.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  Cons\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Duplication risk&lt;/strong&gt;: Copy-pasting SVGs can lead to repeated code if you use the same icon in multiple places.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Not scalable for large icon sets&lt;/strong&gt;: Managing dozens of inline components quickly becomes tedious.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  Best for\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Small projects with a handful of unique icons.&lt;/li&gt;\n&lt;li&gt;One-off icons that need heavy customization.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h2&gt;\n  \n  \n  2. SVG as React Component: Importing SVGs with a Loader\n&lt;/h2&gt;\n\n&lt;p&gt;Modern React toolchains (Create React App, Vite, Next.js, etc.) can transform SVG files into reusable React components using build tools. This lets you keep your SVGs as files but work with them as components.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Example (with &lt;a href=\"https://react-svgr.com/\" rel=\"noopener noreferrer\"&gt;SVGR&lt;/a&gt;):&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Suppose you have &lt;code&gt;assets/icons/arrow-right.svg&lt;/code&gt;:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;&amp;lt;!-- arrow-right.svg --&amp;gt;\n&amp;lt;svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\"&amp;gt;\n  &amp;lt;path d=\"M5 12h14M13 6l6 6-6 6\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/&amp;gt;\n&amp;lt;/svg&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;&lt;strong&gt;Import as a component:&lt;/strong&gt;&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight tsx\"&gt;&lt;code&gt;&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;ReactComponent&lt;/span&gt; &lt;span class=\"k\"&gt;as&lt;/span&gt; &lt;span class=\"nx\"&gt;ArrowRightIcon&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;../assets/icons/arrow-right.svg&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"p\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nc\"&gt;ArrowRightIcon&lt;/span&gt; &lt;span class=\"na\"&gt;width&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"mi\"&gt;32&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt; &lt;span class=\"na\"&gt;height&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"mi\"&gt;32&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt; &lt;span class=\"na\"&gt;style&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"na\"&gt;color&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;blue&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt; &lt;span class=\"p\"&gt;/&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;blockquote&gt;\n&lt;p&gt;✨ &lt;strong&gt;Tip:&lt;/strong&gt; If you’re using &lt;a href=\"https://vitejs.dev/\" rel=\"noopener noreferrer\"&gt;Vite&lt;/a&gt;, &lt;a href=\"https://nextjs.org/\" rel=\"noopener noreferrer\"&gt;Next.js&lt;/a&gt;, or &lt;a href=\"https://create-react-app.dev/\" rel=\"noopener noreferrer\"&gt;CRA&lt;/a&gt;, check their docs for SVG import support or install &lt;a href=\"https://react-svgr.com/docs/webpack/\" rel=\"noopener noreferrer\"&gt;SVGR&lt;/a&gt;.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;h3&gt;\n  \n  \n  Pros\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Component ergonomics&lt;/strong&gt;: Use icons as regular React components, pass props, and compose easily.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Centralized icon files&lt;/strong&gt;: Organize SVGs in a directory, enabling design/development handoff.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Supports tree-shaking&lt;/strong&gt;: Unused icons are excluded from production builds.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  Cons\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Requires build configuration&lt;/strong&gt;: Not all setups support this out of the box.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Large icon sets may bloat bundles&lt;/strong&gt;: If you import all icons at once, you could increase your JS bundle size.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  Best for\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Medium-sized apps with a moderate number of icons.&lt;/li&gt;\n&lt;li&gt;Teams who want to keep SVG files separate from code.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h2&gt;\n  \n  \n  3. SVG Sprites: The Classic Web Approach\n&lt;/h2&gt;\n\n&lt;p&gt;SVG sprites bundle multiple icons into a single SVG file, each identified by a unique &lt;code&gt;&amp;lt;symbol&amp;gt;&lt;/code&gt;. You reference icons using &lt;code&gt;&amp;lt;use xlinkHref=\"#icon-id\" /&amp;gt;&lt;/code&gt; inside your React components. This technique can save bandwidth and improve performance by making use of browser caching and reducing HTTP requests.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Step 1: Create a sprite (e.g., with &lt;a href=\"https://github.com/JetBrains/svg-sprite-loader\" rel=\"noopener noreferrer\"&gt;svg-sprite-loader&lt;/a&gt; or &lt;a href=\"https://github.com/svg-sprite/svg-sprite\" rel=\"noopener noreferrer\"&gt;svg-sprite&lt;/a&gt;).&lt;/strong&gt;&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight xml\"&gt;&lt;code&gt;&lt;span class=\"c\"&gt;&amp;lt;!-- sprite.svg --&amp;gt;&lt;/span&gt;\n&lt;span class=\"nt\"&gt;&amp;lt;svg&lt;/span&gt; &lt;span class=\"na\"&gt;xmlns=&lt;/span&gt;&lt;span class=\"s\"&gt;\"http://www.w3.org/2000/svg\"&lt;/span&gt; &lt;span class=\"na\"&gt;style=&lt;/span&gt;&lt;span class=\"s\"&gt;\"display: none;\"&lt;/span&gt;&lt;span class=\"nt\"&gt;&amp;gt;&lt;/span&gt;\n  &lt;span class=\"nt\"&gt;&amp;lt;symbol&lt;/span&gt; &lt;span class=\"na\"&gt;id=&lt;/span&gt;&lt;span class=\"s\"&gt;\"icon-search\"&lt;/span&gt; &lt;span class=\"na\"&gt;viewBox=&lt;/span&gt;&lt;span class=\"s\"&gt;\"0 0 24 24\"&lt;/span&gt;&lt;span class=\"nt\"&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"nt\"&gt;&amp;lt;circle&lt;/span&gt; &lt;span class=\"na\"&gt;cx=&lt;/span&gt;&lt;span class=\"s\"&gt;\"11\"&lt;/span&gt; &lt;span class=\"na\"&gt;cy=&lt;/span&gt;&lt;span class=\"s\"&gt;\"11\"&lt;/span&gt; &lt;span class=\"na\"&gt;r=&lt;/span&gt;&lt;span class=\"s\"&gt;\"8\"&lt;/span&gt; &lt;span class=\"na\"&gt;stroke=&lt;/span&gt;&lt;span class=\"s\"&gt;\"currentColor\"&lt;/span&gt; &lt;span class=\"na\"&gt;stroke-width=&lt;/span&gt;&lt;span class=\"s\"&gt;\"2\"&lt;/span&gt; &lt;span class=\"na\"&gt;fill=&lt;/span&gt;&lt;span class=\"s\"&gt;\"none\"&lt;/span&gt;&lt;span class=\"nt\"&gt;/&amp;gt;&lt;/span&gt;\n    &lt;span class=\"nt\"&gt;&amp;lt;line&lt;/span&gt; &lt;span class=\"na\"&gt;x1=&lt;/span&gt;&lt;span class=\"s\"&gt;\"21\"&lt;/span&gt; &lt;span class=\"na\"&gt;y1=&lt;/span&gt;&lt;span class=\"s\"&gt;\"21\"&lt;/span&gt; &lt;span class=\"na\"&gt;x2=&lt;/span&gt;&lt;span class=\"s\"&gt;\"16.65\"&lt;/span&gt; &lt;span class=\"na\"&gt;y2=&lt;/span&gt;&lt;span class=\"s\"&gt;\"16.65\"&lt;/span&gt; &lt;span class=\"na\"&gt;stroke=&lt;/span&gt;&lt;span class=\"s\"&gt;\"currentColor\"&lt;/span&gt; &lt;span class=\"na\"&gt;stroke-width=&lt;/span&gt;&lt;span class=\"s\"&gt;\"2\"&lt;/span&gt;&lt;span class=\"nt\"&gt;/&amp;gt;&lt;/span&gt;\n  &lt;span class=\"nt\"&gt;&amp;lt;/symbol&amp;gt;&lt;/span&gt;\n  &lt;span class=\"c\"&gt;&amp;lt;!-- more icons --&amp;gt;&lt;/span&gt;\n&lt;span class=\"nt\"&gt;&amp;lt;/svg&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;&lt;strong&gt;Step 2: Reference in React&lt;/strong&gt;&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight tsx\"&gt;&lt;code&gt;&lt;span class=\"kd\"&gt;type&lt;/span&gt; &lt;span class=\"nx\"&gt;IconProps&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"na\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;width&lt;/span&gt;&lt;span class=\"p\"&gt;?:&lt;/span&gt; &lt;span class=\"kr\"&gt;number&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;height&lt;/span&gt;&lt;span class=\"p\"&gt;?:&lt;/span&gt; &lt;span class=\"kr\"&gt;number&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;color&lt;/span&gt;&lt;span class=\"p\"&gt;?:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"p\"&gt;};&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;SpriteIcon&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;React&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;FC&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;IconProps&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;({&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;width&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"mi\"&gt;24&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;height&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"mi\"&gt;24&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;color&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;currentColor&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;\n&lt;span class=\"p\"&gt;})&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;\n  &lt;span class=\"p\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nt\"&gt;svg&lt;/span&gt; &lt;span class=\"na\"&gt;width&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;width&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt; &lt;span class=\"na\"&gt;height&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"nx\"&gt;height&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt; &lt;span class=\"na\"&gt;fill&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"s\"&gt;\"none\"&lt;/span&gt; &lt;span class=\"na\"&gt;style&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;color&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt;&lt;span class=\"p\"&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=\"p\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nt\"&gt;use&lt;/span&gt; &lt;span class=\"na\"&gt;xlinkHref&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"s2\"&gt;`#icon-&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt; &lt;span class=\"p\"&gt;/&amp;gt;&lt;/span&gt;\n  &lt;span class=\"p\"&gt;&amp;lt;/&lt;/span&gt;&lt;span class=\"nt\"&gt;svg&lt;/span&gt;&lt;span class=\"p\"&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=\"p\"&gt;);&lt;/span&gt;\n\n&lt;span class=\"c1\"&gt;// Usage&lt;/span&gt;\n&lt;span class=\"p\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nc\"&gt;SpriteIcon&lt;/span&gt; &lt;span class=\"na\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"s\"&gt;\"search\"&lt;/span&gt; &lt;span class=\"na\"&gt;color&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"s\"&gt;\"gray\"&lt;/span&gt; &lt;span class=\"p\"&gt;/&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; You must ensure the sprite SVG is loaded into the DOM on page load, typically by including it at the root of your HTML or via a React portal.&lt;/p&gt;\n\n&lt;h3&gt;\n  \n  \n  Pros\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Performance&lt;/strong&gt;: One HTTP request for all icons, uses browser cache efficiently.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Consistent styling&lt;/strong&gt;: All icons share the same color, size, etc., by default.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  Cons\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Setup complexity&lt;/strong&gt;: Generating and injecting sprites requires extra tooling.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Limited dynamic coloring&lt;/strong&gt;: Changing icon color or style can be less flexible than with component-based SVGs.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Not SSR-friendly&lt;/strong&gt;: With server-side rendering, managing sprite injection can become tricky.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  Best for\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Large-scale applications with hundreds of icons.&lt;/li&gt;\n&lt;li&gt;Projects where performance and cache efficiency are high priorities.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h2&gt;\n  \n  \n  4. Dynamic Import: Lazy Loading Icons on Demand\n&lt;/h2&gt;\n\n&lt;p&gt;For large icon sets or when you want to optimize performance, dynamically import SVG icon components only when they’re needed. This prevents bundling all icons into your initial JavaScript payload.&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight tsx\"&gt;&lt;code&gt;&lt;span class=\"k\"&gt;import&lt;/span&gt; &lt;span class=\"nx\"&gt;React&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;Suspense&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;lazy&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;from&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;react&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"kd\"&gt;type&lt;/span&gt; &lt;span class=\"nx\"&gt;IconName&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;home&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;settings&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"o\"&gt;|&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;user&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n&lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;iconMap&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nb\"&gt;Record&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;IconName&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;Promise&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"na\"&gt;default&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;React&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;ComponentType&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;React&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;SVGProps&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;SVGSVGElement&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"na\"&gt;home&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"k\"&gt;import&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;../assets/icons/home.svg&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt; &lt;span class=\"c1\"&gt;// SVGR or similar setup&lt;/span&gt;\n  &lt;span class=\"na\"&gt;settings&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"k\"&gt;import&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;../assets/icons/settings.svg&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt;\n  &lt;span class=\"na\"&gt;user&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"k\"&gt;import&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;../assets/icons/user.svg&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt;\n&lt;span class=\"p\"&gt;};&lt;/span&gt;\n\n&lt;span class=\"kd\"&gt;type&lt;/span&gt; &lt;span class=\"nx\"&gt;DynamicIconProps&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"na\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;IconName&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"na\"&gt;key&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;]:&lt;/span&gt; &lt;span class=\"kr\"&gt;any&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"p\"&gt;};&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;DynamicIcon&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;React&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;FC&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;DynamicIconProps&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"nx\"&gt;props&lt;/span&gt; &lt;span class=\"p\"&gt;})&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;IconComponent&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;lazy&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;iconMap&lt;/span&gt;&lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"nx\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;]);&lt;/span&gt;\n  &lt;span class=\"k\"&gt;return &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"p\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nc\"&gt;Suspense&lt;/span&gt; &lt;span class=\"na\"&gt;fallback&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"p\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nt\"&gt;span&lt;/span&gt; &lt;span class=\"na\"&gt;style&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"na\"&gt;width&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"mi\"&gt;24&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"na\"&gt;height&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"mi\"&gt;24&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"na\"&gt;display&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;\"&lt;/span&gt;&lt;span class=\"s2\"&gt;inline-block&lt;/span&gt;&lt;span class=\"dl\"&gt;\"&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt; &lt;span class=\"p\"&gt;/&amp;gt;&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt;&lt;span class=\"p\"&gt;&amp;gt;&lt;/span&gt;\n      &lt;span class=\"p\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nc\"&gt;IconComponent&lt;/span&gt; &lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"p\"&gt;...&lt;/span&gt;&lt;span class=\"nx\"&gt;props&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt; &lt;span class=\"p\"&gt;/&amp;gt;&lt;/span&gt;\n    &lt;span class=\"p\"&gt;&amp;lt;/&lt;/span&gt;&lt;span class=\"nc\"&gt;Suspense&lt;/span&gt;&lt;span class=\"p\"&gt;&amp;gt;&lt;/span&gt;\n  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;};&lt;/span&gt;\n\n&lt;span class=\"c1\"&gt;// Usage&lt;/span&gt;\n&lt;span class=\"p\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nc\"&gt;DynamicIcon&lt;/span&gt; &lt;span class=\"na\"&gt;name&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"s\"&gt;\"user\"&lt;/span&gt; &lt;span class=\"na\"&gt;width&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"si\"&gt;{&lt;/span&gt;&lt;span class=\"mi\"&gt;28&lt;/span&gt;&lt;span class=\"si\"&gt;}&lt;/span&gt; &lt;span class=\"na\"&gt;color&lt;/span&gt;&lt;span class=\"p\"&gt;=&lt;/span&gt;&lt;span class=\"s\"&gt;\"purple\"&lt;/span&gt; &lt;span class=\"p\"&gt;/&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;h3&gt;\n  \n  \n  Pros\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Optimized bundles&lt;/strong&gt;: Only load what you need, when you need it.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Scalable&lt;/strong&gt;: Great for massive icon libraries or user-customizable icon sets.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  Cons\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Slightly more complex code&lt;/strong&gt;: Requires React Suspense and dynamic import patterns.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;May cause loading flicker&lt;/strong&gt;: Use a placeholder to avoid UI jumps while the icon loads.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  Best for\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Applications with very large or rarely used icon sets.&lt;/li&gt;\n&lt;li&gt;User interfaces where icons are loaded on demand (e.g., plugins, themes).&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h2&gt;\n  \n  \n  Comparing with React Icon Libraries\n&lt;/h2&gt;\n\n&lt;p&gt;You might wonder: why not just use a popular &lt;a href=\"https://react-icons.github.io/react-icons/\" rel=\"noopener noreferrer\"&gt;react icon library&lt;/a&gt; like &lt;code&gt;react-icons&lt;/code&gt;, &lt;code&gt;@heroicons/react&lt;/code&gt;, or &lt;code&gt;@mui/icons-material&lt;/code&gt;? These libraries are fantastic for projects that need common icons, fast prototyping, or consistent design language. They offer:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Pre-built, accessible SVG icon components&lt;/li&gt;\n&lt;li&gt;Tree-shakable packages&lt;/li&gt;\n&lt;li&gt;Easy customization via props&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;However, when you require &lt;strong&gt;custom SVG icons&lt;/strong&gt;—for branding, unique UI, or proprietary designs—you’ll need to manage your own icons using one of the strategies above.&lt;/p&gt;\n\n&lt;p&gt;If you’re looking to create or manage your own SVGs more efficiently, tools like &lt;a href=\"https://react-svgr.com/\" rel=\"noopener noreferrer\"&gt;SVGR&lt;/a&gt;, &lt;a href=\"https://icomoon.io/\" rel=\"noopener noreferrer\"&gt;IcoMoon&lt;/a&gt;, &lt;a href=\"https://iconify.design/\" rel=\"noopener noreferrer\"&gt;Iconify&lt;/a&gt;, or AI-powered platforms like IcoGenie can help generate, convert, and organize SVG assets for use in React.&lt;/p&gt;\n\n&lt;h2&gt;\n  \n  \n  Key Takeaways\n&lt;/h2&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Inline SVG&lt;/strong&gt; is simple and flexible, ideal for small projects or unique one-off icons.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;SVG as React component&lt;/strong&gt; offers a balance of maintainability and developer experience, fitting most modern React workflows.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;SVG sprites&lt;/strong&gt; are best when you want maximal caching and have a large, mostly static icon set, though they require more tooling.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Dynamic import&lt;/strong&gt; helps optimize bundle size for very large or rarely used icon sets, at the cost of some complexity.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;The right approach often depends on your team’s workflow, the size and dynamism of your icon set, and your build tooling. By understanding these techniques, you can keep your React SVG icons sharp, efficient, and a joy to use across your application.&lt;/p&gt;",
    "date": "2026-02-20T08:57:08.000Z",
    "url": "https://dev.to/albert_nahas_cdc8469a6ae8/adding-custom-svg-icons-to-your-react-application-5cml"
  },
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "My portfolio fetches NASA's Daily Space Photo - and never fails!",
    "partialText": "&lt;p&gt;I integrated NASA's Astronomy Picture of the Day &lt;em&gt;(&lt;a href=\"https://api.nasa.gov/\" rel=\"noopener noreferrer\"&gt;read about it&lt;/a&gt;)&lt;/em&gt; into my portfolio.&lt;/p&gt;\n\n&lt;blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;em&gt;SPOILER ALERT: Contains rate limiting, fallback scraping, modular architecture, and production-grade error handling that never leaves users hanging.&lt;/em&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/blockquote&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  The Vision: Bringing Space to My Portfolio\n&lt;/h2&gt;\n\n&lt;p&gt;My portfolio (&lt;a href=\"https://luisfaria.dev\" rel=\"noopener noreferrer\"&gt;luisfaria.dev&lt;/a&gt;) runs a full-stack MERN application with authentication, a chatbot, and a GraphQL API. I wanted to add something unique — something that would genuinely delight users while showcasing real-world API integration skills.&lt;/p&gt;\n\n&lt;p&gt;Between terms of my Master's Degree, I had a few weeks off. Perfect vacation project, right? BTW, I'm open-sourcing the whole thing — check it out! &lt;a href=\"https://github.com/lfariabr\" rel=\"noopener noreferrer\"&gt;mastersSWEAI repo&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;The idea:&lt;/strong&gt; A floating action button that reveals NASA's daily Astronomy Picture of the Day (APOD). Simple concept, complex execution.&lt;/p&gt;\n\n&lt;h3&gt;\n  \n  \n  The User Experience\n&lt;/h3&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F6m40xt1v6lazjqqq3phl.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F6m40xt1v6lazjqqq3phl.png\" alt=\"NASA APOD Floating Action Button\" width=\"800\" height=\"454\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Anonymous users:&lt;/strong&gt; Get today's APOD instantly — no login required&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Authenticated users:&lt;/strong&gt; Browse NASA's entire archive dating back to 1995&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Rate limiting:&lt;/strong&gt; 5 requests/hour per user to protect the NASA API quota&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Resilience:&lt;/strong&gt; If NASA's API fails, automatic HTML scraping fallback kicks in&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Here's exactly what happens when someone clicks that rocket button:&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Ff1rfjhbia1le0zoowa2z.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Ff1rfjhbia1le0zoowa2z.png\" alt=\"NASA APOD Mermaid Diagram\" width=\"800\" height=\"543\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;blockquote&gt;\n&lt;p&gt;👉 &lt;em&gt;&lt;a href=\"https://github.com/lfariabr/luisfaria.dev/tree/master/_docs/devTo/t1_2026/img/apod_flow.jpeg\" rel=\"noopener noreferrer\"&gt;See the image in HD&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  The Challenge: External APIs Are Unreliable\n&lt;/h2&gt;\n\n&lt;p&gt;Integrating third-party APIs sounds straightforward — until reality hits:&lt;/p&gt;\n\n&lt;div class=\"table-wrapper-paragraph\"&gt;&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;NASA API Reality&lt;/th&gt;\n&lt;th&gt;Production Requirements&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;\n&lt;strong&gt;Rate limits&lt;/strong&gt; (1000 req/day)&lt;/td&gt;\n&lt;td&gt;Must protect quota, gracefully throttle users&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;504 Gateway Timeouts&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Can't show users blank screens&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Validation issues&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;NASA sometimes returns &lt;code&gt;media_type: \"other\"&lt;/code&gt; with no &lt;code&gt;url&lt;/code&gt; field&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Network failures&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;ETIMEDOUT, connection refused, DNS issues&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Schema drift&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;NASA API evolves independently of your code&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;/div&gt;\n\n&lt;p&gt;&lt;strong&gt;The goal:&lt;/strong&gt; Build an integration that:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;Handles every failure mode gracefully&lt;/li&gt;\n&lt;li&gt;Never crashes the server&lt;/li&gt;\n&lt;li&gt;Falls back automatically when NASA is down&lt;/li&gt;\n&lt;li&gt;Logs everything for debugging&lt;/li&gt;\n&lt;li&gt;Provides structured errors to clients&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;Spoiler: NASA's API went down during development. More than once.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  The Architecture: Layered Resilience\n&lt;/h2&gt;\n\n&lt;p&gt;Here's the system I designed:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;Browser (Next.js/React)\n    ↓\nGraphQL API (Apollo Server)\n    ↓\nAPOD Service Layer\n    ├──→ NASA API (primary, with retries + timeout)\n    └──→ HTML Scraping Fallback (when API fails)\n         ↓\n    Redis Rate Limiter (atomic Lua scripts)\n         ↓\n    MongoDB (cache successful responses)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;h3&gt;\n  \n  \n  Key Architectural Decisions (3 of them!)\n&lt;/h3&gt;\n\n&lt;p&gt;&lt;strong&gt;1. GraphQL Shield for Authorization&lt;/strong&gt;&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;code&gt;getTodaysApod&lt;/code&gt; is public (no login)&lt;/li&gt;\n&lt;li&gt;\n&lt;code&gt;getApodByDate&lt;/code&gt; requires authentication (prevents abuse)&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;&lt;strong&gt;2. Modular Service Design&lt;/strong&gt;&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;src/services/apod/\n├── index.ts              # Barrel export\n├── apod.service.ts       # Orchestrator (API + fallback)\n├── apod.api.ts           # NASA API client\n├── apod.fallback.ts      # HTML scraping fallback\n├── apod.errors.ts        # Typed error codes\n├── apod.types.ts         # Zod schemas, TypeScript types\n└── apod.constants.ts     # URLs, timeouts, retry config\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;&lt;strong&gt;3. Shared Error Handling Infrastructure&lt;/strong&gt;&lt;br&gt;\nInstead of copy-pasting try/catch blocks across every resolver (we've all been there), I built a reusable error handler:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;// src/utils/errors/graphqlErrors.ts&lt;/span&gt;\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;createErrorHandler&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;TCode&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;TError&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;mapErrorCode&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;code&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;TCode&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nx\"&gt;ErrorCode&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;isServiceError&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;error&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;unknown&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nx\"&gt;error&lt;/span&gt; &lt;span class=\"k\"&gt;is&lt;/span&gt; &lt;span class=\"nx\"&gt;TError&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;defaultMessage&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;\n&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;withErrorHandling&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;T&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n    &lt;span class=\"nx\"&gt;fn&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nb\"&gt;Promise&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;T&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; \n    &lt;span class=\"nx\"&gt;operationName&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;\n  &lt;span class=\"p\"&gt;):&lt;/span&gt; &lt;span class=\"nb\"&gt;Promise&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;T&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;Now any service can use it:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;// APOD resolver (34 lines total)&lt;/span&gt;\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;ApodQueries&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"na\"&gt;getTodaysApod&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"k\"&gt;async &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;_&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;__&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt;\n    &lt;span class=\"nf\"&gt;withApodErrorHandling&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n      &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nf\"&gt;fetchApod&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"na\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"na\"&gt;userId&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;user&lt;/span&gt;&lt;span class=\"p\"&gt;?.&lt;/span&gt;&lt;span class=\"nx\"&gt;id&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"p\"&gt;}),&lt;/span&gt;\n      &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;getTodaysApod&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;\n    &lt;span class=\"p\"&gt;),&lt;/span&gt;\n\n  &lt;span class=\"na\"&gt;getApodByDate&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"k\"&gt;async &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;_&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"o\"&gt;!&lt;/span&gt;&lt;span class=\"nx\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;user&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"k\"&gt;throw&lt;/span&gt; &lt;span class=\"nx\"&gt;Errors&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;unauthenticated&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;Authentication required&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"nf\"&gt;withApodErrorHandling&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n      &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nf\"&gt;fetchApod&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"na\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"na\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"na\"&gt;userId&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;user&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;id&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"p\"&gt;}),&lt;/span&gt;\n      &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;getApodByDate&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;\n    &lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"p\"&gt;},&lt;/span&gt;\n&lt;span class=\"p\"&gt;};&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n\n\n\n&lt;h2&gt;\n  \n  \n  The Journey: 8 Issues, 40+ Commits, 1 Production Feature\n&lt;/h2&gt;\n\n&lt;p&gt;This didn't work on the first try. Or the fifth. Here's the honest implementation timeline:&lt;/p&gt;\n\n&lt;blockquote&gt;\n&lt;p&gt;&lt;strong&gt;Tracked in:&lt;/strong&gt; &lt;a href=\"https://github.com/lfariabr/luisfaria.dev/blob/master/_docs/featureBreakdown/v2.4.Apod.MD\" rel=\"noopener noreferrer\"&gt;Epic v2.4 - APOD Feature&lt;/a&gt;&lt;br&gt;\n&lt;a href=\"https://github.com/lfariabr/luisfaria.dev/commits/master\" rel=\"noopener noreferrer\"&gt;All 40+ commits to (apod) feature&lt;/a&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;h3&gt;\n  \n  \n  Phase 1: Foundation (Issues #61-65)\n&lt;/h3&gt;\n\n&lt;p&gt;&lt;strong&gt;Frontend: NASA-Branded Floating Action Button&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Built &lt;code&gt;ApodFab.tsx&lt;/code&gt; following the same pattern as the existing &lt;code&gt;GogginsFab&lt;/code&gt; component:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Circular button with NASA gradient border (&lt;code&gt;linear-gradient(135deg, #0B3D91, #FC3D21, #1E90FF)&lt;/code&gt;)&lt;/li&gt;\n&lt;li&gt;Rocket icon with blue pulse aura effect&lt;/li&gt;\n&lt;li&gt;Radix UI tooltip: \"Astronomy Picture of the Day\"&lt;/li&gt;\n&lt;li&gt;Accessible (ARIA labels, keyboard navigation)&lt;/li&gt;\n&lt;li&gt;Light/dark mode support&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;&lt;strong&gt;Frontend: APOD Dialog Component&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Created &lt;code&gt;ApodDialog.tsx&lt;/code&gt; with:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Date display with calendar icon&lt;/li&gt;\n&lt;li&gt;Image/video player (handles both media types)&lt;/li&gt;\n&lt;li&gt;Copyright attribution&lt;/li&gt;\n&lt;li&gt;External link to NASA APOD website&lt;/li&gt;\n&lt;li&gt;\"Powered by NASA Open APIs\" footer&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;&lt;strong&gt;Backend: Configuration &amp;amp; Validation&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Set up NASA API credentials:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;// backend/src/config/config.ts&lt;/span&gt;\n&lt;span class=\"kr\"&gt;interface&lt;/span&gt; &lt;span class=\"nx\"&gt;Config&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"nl\"&gt;nasaApiKey&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n&lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;requiredEnvVars&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;[&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;NASA_API_KEY&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;...];&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;Server refuses to start without &lt;code&gt;NASA_API_KEY&lt;/code&gt; — fail fast, no silent surprises.&lt;/p&gt;\n\n\n\n\n&lt;h3&gt;\n  \n  \n  Phase 2: NASA API Client (Issue #66)\n&lt;/h3&gt;\n\n&lt;p&gt;&lt;strong&gt;Zod Schema for Runtime Validation&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;NASA's API returns JSON, but not all fields are guaranteed:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;// src/validation/schemas/apod.schema.ts&lt;/span&gt;\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;apodResponseSchema&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;z&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;object&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt;\n  &lt;span class=\"na\"&gt;copyright&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;z&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;optional&lt;/span&gt;&lt;span class=\"p\"&gt;(),&lt;/span&gt;\n  &lt;span class=\"na\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;z&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;regex&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"sr\"&gt;/^&lt;/span&gt;&lt;span class=\"se\"&gt;\\d{4}&lt;/span&gt;&lt;span class=\"sr\"&gt;-&lt;/span&gt;&lt;span class=\"se\"&gt;\\d{2}&lt;/span&gt;&lt;span class=\"sr\"&gt;-&lt;/span&gt;&lt;span class=\"se\"&gt;\\d{2}&lt;/span&gt;&lt;span class=\"sr\"&gt;$/&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt;\n  &lt;span class=\"na\"&gt;explanation&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;z&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;min&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"mi\"&gt;1&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt;\n  &lt;span class=\"na\"&gt;media_type&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;z&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;enum&lt;/span&gt;&lt;span class=\"p\"&gt;([&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;image&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;video&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;other&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;]),&lt;/span&gt;  &lt;span class=\"c1\"&gt;// 'other' was missing initially!&lt;/span&gt;\n  &lt;span class=\"na\"&gt;title&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;z&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;min&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"mi\"&gt;1&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt;\n  &lt;span class=\"na\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;z&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;optional&lt;/span&gt;&lt;span class=\"p\"&gt;(),&lt;/span&gt;  &lt;span class=\"c1\"&gt;// Not provided for media_type: \"other\"&lt;/span&gt;\n  &lt;span class=\"na\"&gt;hdurl&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;z&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;optional&lt;/span&gt;&lt;span class=\"p\"&gt;(),&lt;/span&gt;\n  &lt;span class=\"na\"&gt;apod_url&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;z&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;optional&lt;/span&gt;&lt;span class=\"p\"&gt;(),&lt;/span&gt;  &lt;span class=\"c1\"&gt;// Computed field&lt;/span&gt;\n&lt;span class=\"p\"&gt;});&lt;/span&gt;\n\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"kd\"&gt;type&lt;/span&gt; &lt;span class=\"nx\"&gt;ApodResponse&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;z&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;infer&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"k\"&gt;typeof&lt;/span&gt; &lt;span class=\"nx\"&gt;apodResponseSchema&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;&lt;strong&gt;NASA API Service with Retries&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Built &lt;code&gt;apod.api.ts&lt;/code&gt; with:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Exponential backoff retries (3 attempts)&lt;/li&gt;\n&lt;li&gt;8-second timeout per request&lt;/li&gt;\n&lt;li&gt;AbortController for proper cleanup&lt;/li&gt;\n&lt;li&gt;Structured logging (latency, status code, userId)\n&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"k\"&gt;async&lt;/span&gt; &lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;fetchApodFromApi&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;?:&lt;/span&gt; &lt;span class=\"nx\"&gt;ApodRequestContext&lt;/span&gt;\n&lt;span class=\"p\"&gt;):&lt;/span&gt; &lt;span class=\"nb\"&gt;Promise&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;ApodResponse&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;startTime&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nb\"&gt;Date&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;now&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;controller&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;AbortController&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;timeoutId&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;setTimeout&lt;/span&gt;&lt;span class=\"p\"&gt;(()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nx\"&gt;controller&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;abort&lt;/span&gt;&lt;span class=\"p\"&gt;(),&lt;/span&gt; &lt;span class=\"nx\"&gt;TIMEOUT_MS&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;try&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;response&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;await&lt;/span&gt; &lt;span class=\"nf\"&gt;fetch&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"na\"&gt;signal&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;controller&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;signal&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n      &lt;span class=\"na\"&gt;headers&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;User-Agent&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;luisfaria.dev/1.0&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt; &lt;span class=\"p\"&gt;},&lt;/span&gt;\n    &lt;span class=\"p\"&gt;});&lt;/span&gt;\n\n    &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"o\"&gt;!&lt;/span&gt;&lt;span class=\"nx\"&gt;response&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;ok&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"k\"&gt;throw&lt;/span&gt; &lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;ApodServiceError&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n        &lt;span class=\"s2\"&gt;`NASA API error: &lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;response&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;status&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;response&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;status&lt;/span&gt; &lt;span class=\"o\"&gt;===&lt;/span&gt; &lt;span class=\"mi\"&gt;429&lt;/span&gt; &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;RATE_LIMITED&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt; &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;NASA_API_ERROR&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n        &lt;span class=\"nx\"&gt;response&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;status&lt;/span&gt;\n      &lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}&lt;/span&gt;\n\n    &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;data&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;await&lt;/span&gt; &lt;span class=\"nx\"&gt;response&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;json&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n    &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;validated&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;apodResponseSchema&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;parse&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;data&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n\n    &lt;span class=\"nx\"&gt;logger&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;info&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;NASA API request successful&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"na\"&gt;latencyMs&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nb\"&gt;Date&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;now&lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;-&lt;/span&gt; &lt;span class=\"nx\"&gt;startTime&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n      &lt;span class=\"na\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;validated&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n      &lt;span class=\"na\"&gt;userId&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;?.&lt;/span&gt;&lt;span class=\"nx\"&gt;userId&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"p\"&gt;});&lt;/span&gt;\n\n    &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"nx\"&gt;validated&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;catch &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;error&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"c1\"&gt;// Error mapping logic...&lt;/span&gt;\n  &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;finally&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"nf\"&gt;clearTimeout&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;timeoutId&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n\n\n\n&lt;h3&gt;\n  \n  \n  Phase 3: The Hard Part — Failures &amp;amp; Fallbacks (&lt;strong&gt;&lt;em&gt;aka scars earned&lt;/em&gt;&lt;/strong&gt;)\n&lt;/h3&gt;\n\n&lt;p&gt;This is where production engineering got real. Here's every bug I hit:&lt;/p&gt;\n\n&lt;div class=\"table-wrapper-paragraph\"&gt;&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;#&lt;/th&gt;\n&lt;th&gt;Problem&lt;/th&gt;\n&lt;th&gt;Root Cause&lt;/th&gt;\n&lt;th&gt;Solution&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;1&lt;/td&gt;\n&lt;td&gt;&lt;strong&gt;Validation failures on &lt;code&gt;media_type: \"other\"&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Zod schema only accepted `'image' \\&lt;/td&gt;\n&lt;td&gt;'video'`&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;2&lt;/td&gt;\n&lt;td&gt;&lt;strong&gt;504 Gateway Timeout from NASA&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;NASA API occasionally unresponsive&lt;/td&gt;\n&lt;td&gt;Implemented HTML scraping fallback&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;3&lt;/td&gt;\n&lt;td&gt;&lt;strong&gt;&lt;code&gt;url&lt;/code&gt; field missing for interactive content&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;NASA doesn't provide &lt;code&gt;url&lt;/code&gt; for SDO videos/embeds&lt;/td&gt;\n&lt;td&gt;Added &lt;code&gt;apod_url&lt;/code&gt; (computed from date) as fallback&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;4&lt;/td&gt;\n&lt;td&gt;&lt;strong&gt;Resolver error handling duplication&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Try/catch boilerplate in every resolver&lt;/td&gt;\n&lt;td&gt;Extracted shared &lt;code&gt;createErrorHandler()&lt;/code&gt; utility&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;5&lt;/td&gt;\n&lt;td&gt;&lt;strong&gt;Inconsistent error codes between services&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Each service used different error mapping&lt;/td&gt;\n&lt;td&gt;Created &lt;code&gt;ErrorCodes&lt;/code&gt; constant as single source of truth&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;6&lt;/td&gt;\n&lt;td&gt;&lt;strong&gt;Rate limit bypass by unauthenticated users&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Anonymous users shared the same Redis key&lt;/td&gt;\n&lt;td&gt;Switched to session-based rate limiting for anonymous users&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;7&lt;/td&gt;\n&lt;td&gt;&lt;strong&gt;Tests breaking after modular refactor&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Tests imported from old monolithic &lt;code&gt;apod.ts&lt;/code&gt;\n&lt;/td&gt;\n&lt;td&gt;Rewrote mocks to match new module structure&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;8&lt;/td&gt;\n&lt;td&gt;&lt;strong&gt;NGINX 502 after deploying APOD feature&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Container DNS caching after recreation&lt;/td&gt;\n&lt;td&gt;Added &lt;code&gt;nginx -s reload&lt;/code&gt; to CI/CD pipeline&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;/div&gt;\n\n&lt;p&gt;&lt;strong&gt;Bug #2 was the game-changer.&lt;/strong&gt; When NASA's API returned 504, users saw blank screens. Not acceptable. The fix: automatic HTML scraping fallback — if the API is down, scrape the website directly.&lt;/p&gt;\n\n\n\n\n&lt;h3&gt;\n  \n  \n  Phase 4: HTML Scraping Fallback (Issue #78)\n&lt;/h3&gt;\n\n&lt;p&gt;When the NASA API fails, the service automatically scrapes the official APOD website. Users never know the difference:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;// src/services/apod/apod.fallback.ts&lt;/span&gt;\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"k\"&gt;async&lt;/span&gt; &lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;fetchApodHtmlFallback&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n  &lt;span class=\"nx\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;?:&lt;/span&gt; &lt;span class=\"kr\"&gt;string&lt;/span&gt;\n&lt;span class=\"p\"&gt;):&lt;/span&gt; &lt;span class=\"nb\"&gt;Promise&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;ApodResponse&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;url&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;date&lt;/span&gt; \n    &lt;span class=\"p\"&gt;?&lt;/span&gt; &lt;span class=\"s2\"&gt;`https://apod.nasa.gov/apod/ap&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nf\"&gt;formatDateForApodUrl&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;)}&lt;/span&gt;&lt;span class=\"s2\"&gt;.html`&lt;/span&gt;\n    &lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;https://apod.nasa.gov/apod/astropix.html&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;html&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;await&lt;/span&gt; &lt;span class=\"nf\"&gt;fetch&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;).&lt;/span&gt;&lt;span class=\"nf\"&gt;then&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;res&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nx\"&gt;res&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;text&lt;/span&gt;&lt;span class=\"p\"&gt;());&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;$&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;cheerio&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;load&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;html&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n\n  &lt;span class=\"c1\"&gt;// Parse structured data&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;title&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;$&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;center:first b:first&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;).&lt;/span&gt;&lt;span class=\"nf\"&gt;text&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;trim&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;explanation&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;$&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;center:first p:last&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;).&lt;/span&gt;&lt;span class=\"nf\"&gt;text&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;trim&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;imageUrl&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;$&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;center:first img&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;).&lt;/span&gt;&lt;span class=\"nf\"&gt;attr&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;src&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"na\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;date&lt;/span&gt; &lt;span class=\"o\"&gt;||&lt;/span&gt; &lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;Date&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;toISOString&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;split&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;T&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;)[&lt;/span&gt;&lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;],&lt;/span&gt;\n    &lt;span class=\"nx\"&gt;title&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"nx\"&gt;explanation&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"na\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;imageUrl&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"na\"&gt;media_type&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;image&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"na\"&gt;apod_url&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;url&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n    &lt;span class=\"c1\"&gt;// ... rest of fields&lt;/span&gt;\n  &lt;span class=\"p\"&gt;};&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;&lt;strong&gt;Orchestration in &lt;code&gt;apod.service.ts&lt;/code&gt;:&lt;/strong&gt;&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"k\"&gt;async&lt;/span&gt; &lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;fetchApod&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;options&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"p\"&gt;{}):&lt;/span&gt; &lt;span class=\"nb\"&gt;Promise&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;lt;&lt;/span&gt;&lt;span class=\"nx\"&gt;ApodResponse&lt;/span&gt;&lt;span class=\"o\"&gt;&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"k\"&gt;try&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"k\"&gt;await&lt;/span&gt; &lt;span class=\"nf\"&gt;fetchApodFromApi&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nf\"&gt;buildApiUrl&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;options&lt;/span&gt;&lt;span class=\"p\"&gt;),&lt;/span&gt; &lt;span class=\"nx\"&gt;options&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"k\"&gt;catch &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;error&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n    &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nf\"&gt;shouldFallback&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;error&lt;/span&gt;&lt;span class=\"p\"&gt;))&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n      &lt;span class=\"nx\"&gt;logger&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;warn&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;NASA API failed, falling back to HTML scraping&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"nx\"&gt;error&lt;/span&gt; &lt;span class=\"p\"&gt;});&lt;/span&gt;\n      &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"k\"&gt;await&lt;/span&gt; &lt;span class=\"nf\"&gt;fetchApodHtmlFallback&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;options&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n    &lt;span class=\"p\"&gt;}&lt;/span&gt;\n    &lt;span class=\"k\"&gt;throw&lt;/span&gt; &lt;span class=\"nx\"&gt;error&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n  &lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;Users never see errors — they just get the APOD, regardless of which method worked. That's the whole point.&lt;/p&gt;\n\n\n\n\n&lt;h3&gt;\n  \n  \n  Phase 5: Shared Error Handling Infrastructure (Issue #79)\n&lt;/h3&gt;\n\n&lt;p&gt;&lt;strong&gt;Before refactor:&lt;/strong&gt; Each resolver had 30+ lines of try/catch boilerplate. Copy-paste engineering at its worst.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;After refactor:&lt;/strong&gt; &lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Created &lt;code&gt;src/utils/errors/graphqlErrors.ts&lt;/code&gt; with reusable utilities&lt;/li&gt;\n&lt;li&gt;Error factories for common cases: &lt;code&gt;Errors.unauthenticated()&lt;/code&gt;, &lt;code&gt;Errors.forbidden()&lt;/code&gt;, &lt;code&gt;Errors.notFound()&lt;/code&gt;\n&lt;/li&gt;\n&lt;li&gt;Generic &lt;code&gt;createErrorHandler()&lt;/code&gt; wrapper generator&lt;/li&gt;\n&lt;li&gt;Service-specific error mappers (e.g., &lt;code&gt;withApodErrorHandling&lt;/code&gt;)&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;&lt;strong&gt;Impact:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Resolvers went from 103 lines to 34 lines&lt;/li&gt;\n&lt;li&gt;Single place to add new error codes&lt;/li&gt;\n&lt;li&gt;Error mapping lives with service logic (where it belongs)&lt;/li&gt;\n&lt;li&gt;Other features can reuse the same pattern — and they already do&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Key Engineering Lessons\n&lt;/h2&gt;\n\n&lt;p&gt;Five production-grade patterns I learned (the hard way) from building APOD:&lt;/p&gt;\n\n&lt;h3&gt;\n  \n  \n  1. Always Have a Fallback\n&lt;/h3&gt;\n\n&lt;p&gt;External APIs fail. Network timeouts happen. DNS breaks. If your feature depends on a third-party service, you need a backup plan — full stop:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Primary:&lt;/strong&gt; NASA JSON API (fast, structured)&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Fallback:&lt;/strong&gt; HTML scraping (slower, but always works)&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;User experience:&lt;/strong&gt; Seamless — they never know which method was used&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  2. Validate External Data at Runtime\n&lt;/h3&gt;\n\n&lt;p&gt;TypeScript types don't protect you against API changes. NASA's schema evolved mid-development — they added &lt;code&gt;media_type: \"other\"&lt;/code&gt; for interactive content, which broke my Zod schema mid-sprint.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt; Runtime validation with Zod catches schema drift before it crashes the server.&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;validated&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nx\"&gt;apodResponseSchema&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;parse&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;data&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;  &lt;span class=\"c1\"&gt;// Throws if schema mismatch&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;h3&gt;\n  \n  \n  3. DRY Principle for Error Handling\n&lt;/h3&gt;\n\n&lt;p&gt;Don't duplicate try/catch blocks across resolvers. We've all done it. It's technical debt from day one. Extract shared error handling into reusable utilities:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;// Before: 30 lines of boilerplate per resolver&lt;/span&gt;\n&lt;span class=\"c1\"&gt;// After: 3 lines + shared error handler&lt;/span&gt;\n&lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"nf\"&gt;withApodErrorHandling&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;\n  &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nf\"&gt;fetchApod&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"na\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;args&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;context&lt;/span&gt; &lt;span class=\"p\"&gt;}),&lt;/span&gt;\n  &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;getApodByDate&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;\n&lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;h3&gt;\n  \n  \n  4. Modular Services Are Testable Services\n&lt;/h3&gt;\n\n&lt;p&gt;Splitting the monolithic &lt;code&gt;apod.ts&lt;/code&gt; into focused modules made testing trivial — and debugging even more so:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight plaintext\"&gt;&lt;code&gt;src/services/apod/\n├── apod.service.ts       # Orchestration (API + fallback)\n├── apod.api.ts           # NASA API client\n├── apod.fallback.ts      # HTML scraping\n├── apod.errors.ts        # Typed errors\n├── apod.types.ts         # Zod schemas\n└── apod.constants.ts     # Config\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;Each module has a single responsibility. Tests mock at the module boundary, not the entire service.&lt;/p&gt;\n\n&lt;h3&gt;\n  \n  \n  5. Log Everything for Observability\n&lt;/h3&gt;\n\n&lt;p&gt;Every NASA API request logs:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Latency (&lt;code&gt;latencyMs&lt;/code&gt;)&lt;/li&gt;\n&lt;li&gt;User context (&lt;code&gt;userId&lt;/code&gt;)&lt;/li&gt;\n&lt;li&gt;Success/failure status&lt;/li&gt;\n&lt;li&gt;Error codes and details&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;When bugs happen in production (and they will), structured logs are your debugging lifeline.&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"nx\"&gt;logger&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;info&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;NASA API request successful&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"na\"&gt;latencyMs&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"mi\"&gt;142&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"na\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;2026-02-18&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n  &lt;span class=\"na\"&gt;userId&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;user_xyz&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;\n&lt;span class=\"p\"&gt;});&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Results\n&lt;/h2&gt;\n\n&lt;div class=\"table-wrapper-paragraph\"&gt;&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;Metric&lt;/th&gt;\n&lt;th&gt;Implementation&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Uptime&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;99.9% (fallback handles NASA API downtime)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Response time&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;&amp;lt;500ms (NASA API), ~1.2s (HTML fallback)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Error rate&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;0.1% (network failures only, auto-recovered)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Rate limit protection&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;5 req/hr per user (Redis atomic counters)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Test coverage&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;94% (28 passing unit tests)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Lines of code&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;1,200 (including tests)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;GraphQL queries&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;2 (&lt;code&gt;getTodaysApod&lt;/code&gt;, &lt;code&gt;getApodByDate&lt;/code&gt;)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Fallback success rate&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;100% (HTML scraping never failed in production)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;/div&gt;\n\n&lt;h3&gt;\n  \n  \n  Real-World Reliability\n&lt;/h3&gt;\n\n&lt;p&gt;During a 72-hour period where NASA's API had intermittent 504 errors:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Primary API success rate:&lt;/strong&gt; 78%&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Fallback activation:&lt;/strong&gt; 22%&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;User-facing errors:&lt;/strong&gt; 0%&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Users never knew NASA's API was struggling. The fallback handled it seamlessly — that's the whole point of building resilient systems.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Tech Stack\n&lt;/h2&gt;\n\n&lt;div class=\"table-wrapper-paragraph\"&gt;&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;Layer&lt;/th&gt;\n&lt;th&gt;Technology&lt;/th&gt;\n&lt;th&gt;Purpose&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Frontend&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Next.js 16 + React 19&lt;/td&gt;\n&lt;td&gt;UI with floating action button + dialog&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;UI Library&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Radix UI + TailwindCSS 4&lt;/td&gt;\n&lt;td&gt;Accessible components, NASA branding&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Backend&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Node.js + Express + Apollo Server 5&lt;/td&gt;\n&lt;td&gt;GraphQL API&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Schema&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;GraphQL + GraphQL Shield&lt;/td&gt;\n&lt;td&gt;Type-safe API with field-level authorization&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Validation&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Zod&lt;/td&gt;\n&lt;td&gt;Runtime schema validation&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;API Client&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Fetch API + AbortController&lt;/td&gt;\n&lt;td&gt;HTTP with timeouts and retries&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Scraping&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Cheerio&lt;/td&gt;\n&lt;td&gt;HTML parsing for fallback&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Rate Limiting&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Redis + Lua scripts&lt;/td&gt;\n&lt;td&gt;Atomic counters per user&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Database&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;MongoDB&lt;/td&gt;\n&lt;td&gt;Cache successful APOD responses&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Logging&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Winston&lt;/td&gt;\n&lt;td&gt;Structured logs for observability&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Testing&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;Jest + ts-jest&lt;/td&gt;\n&lt;td&gt;Unit tests with mocked services&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;/div&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Future Roadmap\n&lt;/h2&gt;\n\n&lt;p&gt;The current implementation is production-ready, but there's always room to grow. Here are 5 ideas — feel free to add yours in the comments!&lt;/p&gt;\n\n&lt;h3&gt;\n  \n  \n  Idea #1: Database Caching Layer\n&lt;/h3&gt;\n\n&lt;p&gt;Right now, every request hits NASA's API (or HTML fallback). Next iteration:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Cache successful responses in MongoDB&lt;/li&gt;\n&lt;li&gt;Return cached APOD if date already fetched&lt;/li&gt;\n&lt;li&gt;Reduce API quota usage by 80%&lt;/li&gt;\n&lt;li&gt;Instant response for popular dates&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  Idea #2: Admin Dashboard\n&lt;/h3&gt;\n\n&lt;p&gt;GraphQL mutations to manually refresh/delete cached APODs:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight graphql\"&gt;&lt;code&gt;&lt;span class=\"k\"&gt;mutation&lt;/span&gt;&lt;span class=\"w\"&gt; &lt;/span&gt;&lt;span class=\"n\"&gt;RefreshApod&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nv\"&gt;$date&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;&lt;span class=\"w\"&gt; &lt;/span&gt;&lt;span class=\"nb\"&gt;String&lt;/span&gt;&lt;span class=\"p\"&gt;!)&lt;/span&gt;&lt;span class=\"w\"&gt; &lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"w\"&gt;\n  &lt;/span&gt;&lt;span class=\"n\"&gt;refreshApod&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"n\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt;&lt;span class=\"w\"&gt; &lt;/span&gt;&lt;span class=\"nv\"&gt;$date&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt;&lt;span class=\"w\"&gt; &lt;/span&gt;&lt;span class=\"p\"&gt;{&lt;/span&gt;&lt;span class=\"w\"&gt; &lt;/span&gt;&lt;span class=\"n\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt;&lt;span class=\"w\"&gt; &lt;/span&gt;&lt;span class=\"n\"&gt;title&lt;/span&gt;&lt;span class=\"w\"&gt; &lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"w\"&gt;\n&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"w\"&gt;\n&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;h3&gt;\n  \n  \n  Idea #3: WebSocket Push Updates\n&lt;/h3&gt;\n\n&lt;p&gt;Use GraphQL subscriptions to push new APODs to connected clients when they become available at midnight UTC.&lt;/p&gt;\n\n&lt;h3&gt;\n  \n  \n  Idea #4: Zero-Cold-Start: Daily Cron + Redis 24h Cache\n&lt;/h3&gt;\n\n&lt;p&gt;Right now, the first user of the day triggers a live NASA API call. That's ~200-500ms of cold latency — acceptable, but not great.&lt;/p&gt;\n\n&lt;p&gt;The plan: a daily cron job fires at &lt;strong&gt;00:01 UTC&lt;/strong&gt;, fetches today's APOD proactively, and stores it in &lt;strong&gt;Redis with a 24h TTL&lt;/strong&gt;. Every subsequent request that day gets a cache hit — sub-10ms response, zero external calls.&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;// Pseudocode: src/jobs/apodDaily.ts&lt;/span&gt;\n&lt;span class=\"k\"&gt;export&lt;/span&gt; &lt;span class=\"k\"&gt;async&lt;/span&gt; &lt;span class=\"kd\"&gt;function&lt;/span&gt; &lt;span class=\"nf\"&gt;warmApodCache&lt;/span&gt;&lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;today&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;Date&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;toISOString&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;split&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;T&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;)[&lt;/span&gt;&lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;];&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;cacheKey&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"s2\"&gt;`apod:&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;today&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n  &lt;span class=\"c1\"&gt;// Already warm? Skip.&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;cached&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;await&lt;/span&gt; &lt;span class=\"nx\"&gt;redis&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;cacheKey&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;cached&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"nx\"&gt;JSON&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;parse&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;cached&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n\n  &lt;span class=\"c1\"&gt;// Fetch fresh from NASA&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;apod&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;await&lt;/span&gt; &lt;span class=\"nf\"&gt;fetchApod&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"na\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;today&lt;/span&gt; &lt;span class=\"p\"&gt;});&lt;/span&gt;\n\n  &lt;span class=\"c1\"&gt;// Cache for exactly 24h (expires at midnight UTC)&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;secondsUntilMidnight&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"nf\"&gt;getSecondsUntilMidnightUTC&lt;/span&gt;&lt;span class=\"p\"&gt;();&lt;/span&gt;\n  &lt;span class=\"k\"&gt;await&lt;/span&gt; &lt;span class=\"nx\"&gt;redis&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;setex&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;cacheKey&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;secondsUntilMidnight&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;JSON&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;stringify&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;apod&lt;/span&gt;&lt;span class=\"p\"&gt;));&lt;/span&gt;\n\n  &lt;span class=\"nx\"&gt;logger&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;info&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;APOD cache warmed&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"na\"&gt;date&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;today&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"na\"&gt;ttl&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;secondsUntilMidnight&lt;/span&gt; &lt;span class=\"p\"&gt;});&lt;/span&gt;\n  &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"nx\"&gt;apod&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n&lt;span class=\"p\"&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;The cron schedule via &lt;code&gt;node-cron&lt;/code&gt;:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"c1\"&gt;// Fires at 00:01 UTC every day&lt;/span&gt;\n&lt;span class=\"nx\"&gt;cron&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;schedule&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;1 0 * * *&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;warmApodCache&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"na\"&gt;timezone&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;UTC&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt; &lt;span class=\"p\"&gt;});&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;The resolver then checks Redis first before ever hitting NASA:&lt;br&gt;\n&lt;/p&gt;\n\n&lt;div class=\"highlight js-code-highlight\"&gt;\n&lt;pre class=\"highlight typescript\"&gt;&lt;code&gt;&lt;span class=\"nx\"&gt;getTodaysApod&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"k\"&gt;async &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;_&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;__&lt;/span&gt;&lt;span class=\"p\"&gt;,&lt;/span&gt; &lt;span class=\"nx\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;today&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;new&lt;/span&gt; &lt;span class=\"nc\"&gt;Date&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;toISOString&lt;/span&gt;&lt;span class=\"p\"&gt;().&lt;/span&gt;&lt;span class=\"nf\"&gt;split&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;T&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"p\"&gt;)[&lt;/span&gt;&lt;span class=\"mi\"&gt;0&lt;/span&gt;&lt;span class=\"p\"&gt;];&lt;/span&gt;\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;cacheKey&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"s2\"&gt;`apod:&lt;/span&gt;&lt;span class=\"p\"&gt;${&lt;/span&gt;&lt;span class=\"nx\"&gt;today&lt;/span&gt;&lt;span class=\"p\"&gt;}&lt;/span&gt;&lt;span class=\"s2\"&gt;`&lt;/span&gt;&lt;span class=\"p\"&gt;;&lt;/span&gt;\n\n  &lt;span class=\"kd\"&gt;const&lt;/span&gt; &lt;span class=\"nx\"&gt;cached&lt;/span&gt; &lt;span class=\"o\"&gt;=&lt;/span&gt; &lt;span class=\"k\"&gt;await&lt;/span&gt; &lt;span class=\"nx\"&gt;redis&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;get&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;cacheKey&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;\n  &lt;span class=\"k\"&gt;if &lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;cached&lt;/span&gt;&lt;span class=\"p\"&gt;)&lt;/span&gt; &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"nx\"&gt;JSON&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nf\"&gt;parse&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;&lt;span class=\"nx\"&gt;cached&lt;/span&gt;&lt;span class=\"p\"&gt;);&lt;/span&gt;        &lt;span class=\"c1\"&gt;// ⚡ &amp;lt;10ms&lt;/span&gt;\n\n  &lt;span class=\"k\"&gt;return&lt;/span&gt; &lt;span class=\"nf\"&gt;withApodErrorHandling&lt;/span&gt;&lt;span class=\"p\"&gt;(&lt;/span&gt;                 &lt;span class=\"c1\"&gt;// 🐌 200-500ms&lt;/span&gt;\n    &lt;span class=\"p\"&gt;()&lt;/span&gt; &lt;span class=\"o\"&gt;=&amp;gt;&lt;/span&gt; &lt;span class=\"nf\"&gt;fetchApod&lt;/span&gt;&lt;span class=\"p\"&gt;({&lt;/span&gt; &lt;span class=\"na\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"p\"&gt;{&lt;/span&gt; &lt;span class=\"na\"&gt;userId&lt;/span&gt;&lt;span class=\"p\"&gt;:&lt;/span&gt; &lt;span class=\"nx\"&gt;context&lt;/span&gt;&lt;span class=\"p\"&gt;.&lt;/span&gt;&lt;span class=\"nx\"&gt;user&lt;/span&gt;&lt;span class=\"p\"&gt;?.&lt;/span&gt;&lt;span class=\"nx\"&gt;id&lt;/span&gt; &lt;span class=\"p\"&gt;}&lt;/span&gt; &lt;span class=\"p\"&gt;}),&lt;/span&gt;\n    &lt;span class=\"dl\"&gt;'&lt;/span&gt;&lt;span class=\"s1\"&gt;getTodaysApod&lt;/span&gt;&lt;span class=\"dl\"&gt;'&lt;/span&gt;\n  &lt;span class=\"p\"&gt;);&lt;/span&gt;\n&lt;span class=\"p\"&gt;},&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;p&gt;&lt;strong&gt;Expected impact:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;div class=\"table-wrapper-paragraph\"&gt;&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;Scenario&lt;/th&gt;\n&lt;th&gt;Before&lt;/th&gt;\n&lt;th&gt;After&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;First request of the day&lt;/td&gt;\n&lt;td&gt;~300ms (live NASA call)&lt;/td&gt;\n&lt;td&gt;~5ms (Redis hit)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;Subsequent requests&lt;/td&gt;\n&lt;td&gt;~300ms (live NASA call)&lt;/td&gt;\n&lt;td&gt;~5ms (Redis hit)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;NASA API unavailable&lt;/td&gt;\n&lt;td&gt;~1.2s (HTML fallback)&lt;/td&gt;\n&lt;td&gt;~5ms (Redis hit)&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;NASA quota usage&lt;/td&gt;\n&lt;td&gt;1 req per user visit&lt;/td&gt;\n&lt;td&gt;1 req per day total&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;/div&gt;\n\n&lt;p&gt;The key insight: Redis TTL auto-expires the cache exactly when it stops being valid. No manual invalidation. No stale data. Just &lt;em&gt;fast&lt;/em&gt; for 99% of requests.&lt;/p&gt;\n\n&lt;h3&gt;\n  \n  \n  Idea #5: Analytics Dashboard\n&lt;/h3&gt;\n\n&lt;p&gt;Track:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Most popular APOD dates&lt;/li&gt;\n&lt;li&gt;Fallback usage percentage&lt;/li&gt;\n&lt;li&gt;Average response time (API vs. fallback)&lt;/li&gt;\n&lt;li&gt;Rate limit triggers per user&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Key Takeaways\n&lt;/h2&gt;\n\n&lt;p&gt;Building production-grade API integrations is 20% \"get it working\" and 80% \"handle when it doesn't work.\"&lt;/p&gt;\n\n&lt;p&gt;Five principles that made APOD production-ready:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;\n&lt;strong&gt;Graceful degradation&lt;/strong&gt; — Fallbacks ensure users never see errors&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Runtime validation&lt;/strong&gt; — Zod catches schema drift before it crashes&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Modular architecture&lt;/strong&gt; — Focused modules are easier to test and maintain&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Shared error handling&lt;/strong&gt; — DRY principle for GraphQL resolvers&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Observability&lt;/strong&gt; — Structured logs make debugging trivial&lt;/li&gt;\n&lt;/ol&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Try It Yourself\n&lt;/h2&gt;\n\n&lt;p&gt;The full APOD implementation is open source:&lt;/p&gt;\n\n&lt;div class=\"table-wrapper-paragraph\"&gt;&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;Resource&lt;/th&gt;\n&lt;th&gt;Link&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Live Demo&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;\n&lt;a href=\"https://luisfaria.dev\" rel=\"noopener noreferrer\"&gt;luisfaria.dev&lt;/a&gt; — Click the NASA rocket button&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;GitHub Repo&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;&lt;a href=\"https://github.com/lfariabr/luisfaria.dev\" rel=\"noopener noreferrer\"&gt;github.com/lfariabr/luisfaria.dev&lt;/a&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;APOD Service&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;&lt;a href=\"https://github.com/lfariabr/luisfaria.dev/tree/master/backend/src/services/apod\" rel=\"noopener noreferrer\"&gt;backend/src/services/apod/&lt;/a&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;GraphQL Schema&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;&lt;a href=\"https://github.com/lfariabr/luisfaria.dev/blob/master/backend/src/schemas/types/apodTypes.ts\" rel=\"noopener noreferrer\"&gt;backend/src/schemas/types/apodTypes.ts&lt;/a&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Frontend Component&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;&lt;a href=\"https://github.com/lfariabr/luisfaria.dev/tree/master/frontend/src/components/apod\" rel=\"noopener noreferrer\"&gt;frontend/src/components/apod/&lt;/a&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;strong&gt;Feature Spec&lt;/strong&gt;&lt;/td&gt;\n&lt;td&gt;&lt;a href=\"https://github.com/lfariabr/luisfaria.dev/blob/master/_docs/featureBreakdown/v2.4.Apod.MD\" rel=\"noopener noreferrer\"&gt;_docs/featureBreakdown/v2.4.Apod.MD&lt;/a&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;/div&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Let's Connect!\n&lt;/h2&gt;\n\n&lt;p&gt;Building this NASA integration taught me more about production engineering than any tutorial could. Every failure mode I hit — 504 timeouts, schema drift, rate limits, DNS caching — is something I'll face again in enterprise systems. And now I know how to handle it.&lt;/p&gt;\n\n&lt;p&gt;If you're working with:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;GraphQL APIs and error handling patterns&lt;/li&gt;\n&lt;li&gt;Third-party API integrations with fallback strategies&lt;/li&gt;\n&lt;li&gt;Next.js + Node.js full-stack applications&lt;/li&gt;\n&lt;li&gt;Production-grade TypeScript architectures&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;I'd love to connect and trade war stories:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;LinkedIn:&lt;/strong&gt; &lt;a href=\"https://www.linkedin.com/in/lfariabr/\" rel=\"noopener noreferrer\"&gt;linkedin.com/in/lfariabr&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;GitHub:&lt;/strong&gt; &lt;a href=\"https://github.com/lfariabr\" rel=\"noopener noreferrer\"&gt;github.com/lfariabr&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Portfolio:&lt;/strong&gt; &lt;a href=\"https://luisfaria.dev\" rel=\"noopener noreferrer\"&gt;luisfaria.dev&lt;/a&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;p&gt;&lt;strong&gt;Tech Stack Summary:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;div class=\"table-wrapper-paragraph\"&gt;&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;Current Implementation&lt;/th&gt;\n&lt;th&gt;Future Extensions&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;NASA API + HTML fallback, GraphQL Shield, Redis rate limiting, Zod validation, modular services, Winston logging, 94% test coverage&lt;/td&gt;\n&lt;td&gt;Redis 24h cache + daily cron warm-up, GraphQL subscriptions, admin mutations, analytics dashboard&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;/div&gt;\n\n\n\n\n&lt;p&gt;&lt;em&gt;Built with ☕, 40+ commits, and a healthy fear of blank screens by &lt;a href=\"https://luisfaria.dev\" rel=\"noopener noreferrer\"&gt;Luis Faria&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;\n\n&lt;blockquote&gt;\n&lt;p&gt;&lt;em&gt;Whether it's concrete or code, structure is everything.&lt;/em&gt;&lt;/p&gt;\n&lt;/blockquote&gt;",
    "date": "2026-02-20T07:44:47.000Z",
    "url": "https://dev.to/lfariaus/i-embedded-nasas-api-into-my-portfolio-with-fallback-scraping-rate-limiting-and-zero-3gbh"
  },
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "I built a minimal company profile template because I was tired of colorful noise",
    "partialText": "&lt;p&gt;🔗 &lt;strong&gt;Live demo:&lt;/strong&gt; &lt;a href=\"https://mono-profile-alpha.vercel.app/\" rel=\"noopener noreferrer\"&gt;https://mono-profile-alpha.vercel.app/&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;I have a problem with most website templates.&lt;/p&gt;\n\n&lt;p&gt;They're loud. Gradients everywhere, hero sections with three different&lt;br&gt;\ntypefaces, accent colors fighting each other. I get it they want to&lt;br&gt;\nlook impressive in a marketplace thumbnail.&lt;/p&gt;\n\n&lt;p&gt;But when I actually need to &lt;em&gt;use&lt;/em&gt; one? It's exhausting.&lt;/p&gt;\n\n&lt;p&gt;I like monochrome. Black, white, grays, maybe one muted accent.&lt;br&gt;\nClean type. Room to breathe. So after saying \"I'll just build my own\"&lt;br&gt;\nfor the fifth time, I actually did.&lt;/p&gt;\n\n&lt;p&gt;This is MONO, a minimal company profile template I built for myself&lt;br&gt;\nand ended up packaging for anyone else who thinks the same way.&lt;/p&gt;\n\n&lt;h2&gt;\n  \n  \n  The stack\n&lt;/h2&gt;\n\n&lt;p&gt;I went with what I'm comfortable with, and what I'd actually want&lt;br&gt;\nto inherit from someone else:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Vite&lt;/strong&gt; — fast dev server, no config hell&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;React + TypeScript&lt;/strong&gt; — predictable, easy to extend&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Tailwind CSS&lt;/strong&gt; — utility-first, no surprise CSS specificity&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;shadcn/ui&lt;/strong&gt; — accessible components without opinionated styling&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Shadcn was actually the right call here. Since the components are&lt;br&gt;\nunstyled by default and live in your codebase, the monochrome&lt;br&gt;\naesthetic doesn't fight the component library. You're not overriding&lt;br&gt;\na blue primary button everywhere.&lt;/p&gt;\n\n&lt;h2&gt;\n  \n  \n  What's in the template\n&lt;/h2&gt;\n\n&lt;p&gt;It's a typical company profile page, but intentionally stripped down:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Hero (headline, subtext, CTA)&lt;/li&gt;\n&lt;li&gt;Services / what you offer&lt;/li&gt;\n&lt;li&gt;Selected work / portfolio&lt;/li&gt;\n&lt;li&gt;About section&lt;/li&gt;\n&lt;li&gt;FAQ&lt;/li&gt;\n&lt;li&gt;Contact&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;That's it. No unnecessary animations, no scroll-jacking, no&lt;br&gt;\n\"surprise me\" interactions.&lt;/p&gt;\n\n&lt;p&gt;The section order makes sense for most businesses: tell me who you&lt;br&gt;\nare → what you do → proof you've done it → answer my obvious&lt;br&gt;\nquestions → let me reach you.&lt;/p&gt;\n\n&lt;h2&gt;\n  \n  \n  The design decision I'm most glad I made\n&lt;/h2&gt;\n\n&lt;p&gt;I almost added a color theme switcher. \"Users can pick an accent&lt;br&gt;\ncolor!\" Sounds useful, right?&lt;/p&gt;\n\n&lt;p&gt;I removed it.&lt;/p&gt;\n\n&lt;p&gt;Not because it's hard to build it's not. But it introduces&lt;br&gt;\ndecisions. \"Should I use purple or teal?\" is exactly the kind of&lt;br&gt;\nquestion I want the template to eliminate, not create.&lt;/p&gt;\n\n&lt;p&gt;Monochrome is a decision. Stick to it.&lt;/p&gt;\n\n&lt;p&gt;If you want a specific accent later, you change one Tailwind CSS&lt;br&gt;\nvariable and you're done. That's intentional.&lt;/p&gt;\n\n&lt;h2&gt;\n  \n  \n  Who this is for\n&lt;/h2&gt;\n\n&lt;p&gt;Honestly? Anyone who needs a company profile that looks professional&lt;br&gt;\nwithout spending a week on design decisions.&lt;/p&gt;\n\n&lt;p&gt;That includes:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Agencies putting together a quick client-facing profile&lt;/li&gt;\n&lt;li&gt;Freelancers who want a site that looks serious&lt;/li&gt;\n&lt;li&gt;Developers who'd rather write code than pick color palettes&lt;/li&gt;\n&lt;li&gt;Someone building a startup landing page before they figure out branding&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;It's not a dashboard, not a SaaS template, not a landing page with&lt;br&gt;\n17 sections. Just a company profile. Done well.&lt;/p&gt;\n\n&lt;h2&gt;\n  \n  \n  If you want to grab it\n&lt;/h2&gt;\n\n&lt;p&gt;It's on Gumroad: &lt;strong&gt;[&lt;a href=\"https://ardiandian.gumroad.com/l/mono-company-profile\" rel=\"noopener noreferrer\"&gt;https://ardiandian.gumroad.com/l/mono-company-profile&lt;/a&gt;]&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Comes with the full source code, clean folder structure, and a README&lt;br&gt;\nthat explains how to customize the key parts without touching&lt;br&gt;\neverything.&lt;/p&gt;\n\n&lt;p&gt;If you check it out or if you've built something similar I'd love&lt;br&gt;\nto hear what you think. What's the one thing you always end up&lt;br&gt;\nrebuilding when you use someone else's template?&lt;/p&gt;",
    "date": "2026-02-20T07:33:36.000Z",
    "url": "https://dev.to/aardnsyhs/i-built-a-minimal-company-profile-template-because-i-was-tired-of-colorful-noise-40b1"
  },
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "I Replaced My Guitar Tuner With 200 Lines of JavaScript",
    "partialText": "&lt;blockquote&gt;\n&lt;p&gt;🎸 &lt;strong&gt;Live demo:&lt;/strong&gt; &lt;a href=\"https://indjoov.github.io/pitchcraft/\" rel=\"noopener noreferrer\"&gt;https://indjoov.github.io/pitchcraft/&lt;/a&gt;&lt;br&gt;&lt;br&gt;\n⭐ &lt;strong&gt;GitHub:&lt;/strong&gt; &lt;a href=\"https://github.com/indjoov/pitchcraft\" rel=\"noopener noreferrer\"&gt;https://github.com/indjoov/pitchcraft&lt;/a&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n\n\n\n\n&lt;p&gt;Most guitar tuners on the web are black boxes.&lt;/p&gt;\n\n&lt;p&gt;You don’t know how they work.&lt;br&gt;&lt;br&gt;\nYou can’t modify them.&lt;br&gt;&lt;br&gt;\nAnd most of them aren’t open source.&lt;/p&gt;\n\n&lt;p&gt;So I built my own.&lt;/p&gt;\n\n&lt;p&gt;It’s called &lt;strong&gt;PitchCraft&lt;/strong&gt; — an open-source chromatic tuner that runs entirely in your browser.&lt;/p&gt;\n\n&lt;p&gt;No backend.&lt;br&gt;&lt;br&gt;\nNo external tuning libraries.&lt;br&gt;&lt;br&gt;\nJust JavaScript and the Web Audio API.&lt;/p&gt;\n\n\n\n\n&lt;h1&gt;\n  \n  \n  Why I Built This\n&lt;/h1&gt;\n\n&lt;p&gt;I’m a musician and developer.&lt;/p&gt;\n\n&lt;p&gt;One day I needed a tuner and opened an online one.&lt;/p&gt;\n\n&lt;p&gt;It worked.&lt;/p&gt;\n\n&lt;p&gt;But I kept thinking:&lt;/p&gt;\n\n&lt;blockquote&gt;\n&lt;p&gt;Why can’t I see how this works?&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;So I decided to build one myself.&lt;/p&gt;\n\n&lt;p&gt;Completely from scratch.&lt;/p&gt;\n\n&lt;p&gt;Inside the browser.&lt;/p&gt;\n\n\n\n\n&lt;h1&gt;\n  \n  \n  The Crazy Part: Modern Browsers Can Do This\n&lt;/h1&gt;\n\n&lt;p&gt;The entire signal chain looks like this:&lt;/p&gt;\n\n&lt;p&gt;Microphone → Frequency Detection → Note Calculation → Visual Feedback&lt;/p&gt;\n\n&lt;p&gt;Using:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;getUserMedia&lt;/li&gt;\n&lt;li&gt;AnalyserNode&lt;/li&gt;\n&lt;li&gt;autocorrelation&lt;/li&gt;\n&lt;li&gt;equal temperament math&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;No backend required.&lt;/p&gt;\n\n&lt;p&gt;Everything runs locally.&lt;/p&gt;\n\n\n\n\n&lt;h1&gt;\n  \n  \n  The Core: Pitch Detection in JavaScript\n&lt;/h1&gt;\n\n&lt;p&gt;PitchCraft uses an &lt;strong&gt;autocorrelation algorithm&lt;/strong&gt;.&lt;/p&gt;\n\n&lt;p&gt;The idea is simple:&lt;/p&gt;\n\n&lt;p&gt;The signal is compared with delayed copies of itself.&lt;/p&gt;\n\n&lt;p&gt;When the waveform aligns, you’ve found the fundamental frequency.&lt;/p&gt;\n\n&lt;p&gt;From there:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;frequency → note&lt;/li&gt;\n&lt;li&gt;note → cents deviation&lt;/li&gt;\n&lt;li&gt;deviation → visual feedback&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;All in real time.&lt;/p&gt;\n\n\n\n\n&lt;h1&gt;\n  \n  \n  Features\n&lt;/h1&gt;\n\n&lt;p&gt;PitchCraft currently supports:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Guitar&lt;/li&gt;\n&lt;li&gt;Bass&lt;/li&gt;\n&lt;li&gt;Ukulele&lt;/li&gt;\n&lt;li&gt;Violin&lt;/li&gt;\n&lt;li&gt;Cello&lt;/li&gt;\n&lt;li&gt;Banjo&lt;/li&gt;\n&lt;li&gt;Mandolin&lt;/li&gt;\n&lt;li&gt;Chromatic mode&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;With adjustable reference tuning:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;432 Hz&lt;/li&gt;\n&lt;li&gt;435 Hz&lt;/li&gt;\n&lt;li&gt;438 Hz&lt;/li&gt;\n&lt;li&gt;440 Hz&lt;/li&gt;\n&lt;li&gt;442 Hz&lt;/li&gt;\n&lt;li&gt;444 Hz&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;It also includes:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;real-time cents meter&lt;/li&gt;\n&lt;li&gt;frequency display&lt;/li&gt;\n&lt;li&gt;reference tone playback&lt;/li&gt;\n&lt;li&gt;live volume indicator&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;h1&gt;\n  \n  \n  Accessibility Matters\n&lt;/h1&gt;\n\n&lt;p&gt;Most music tools ignore accessibility.&lt;/p&gt;\n\n&lt;p&gt;PitchCraft includes:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;high contrast mode&lt;/li&gt;\n&lt;li&gt;large text mode&lt;/li&gt;\n&lt;li&gt;reduced motion mode&lt;/li&gt;\n&lt;li&gt;keyboard navigation&lt;/li&gt;\n&lt;li&gt;screen reader support&lt;/li&gt;\n&lt;li&gt;semantic HTML&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Creative tools should be usable by everyone.&lt;/p&gt;\n\n\n\n\n&lt;h1&gt;\n  \n  \n  Tech Stack\n&lt;/h1&gt;\n\n&lt;p&gt;Built with:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;React&lt;/li&gt;\n&lt;li&gt;Vite&lt;/li&gt;\n&lt;li&gt;Web Audio API&lt;/li&gt;\n&lt;li&gt;pure JavaScript pitch detection&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;No external tuning libraries.&lt;/p&gt;\n\n&lt;p&gt;Everything is open source.&lt;/p&gt;\n\n\n\n\n&lt;h1&gt;\n  \n  \n  Why Open Source\n&lt;/h1&gt;\n\n&lt;p&gt;I believe creative tools should be:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;transparent&lt;/li&gt;\n&lt;li&gt;hackable&lt;/li&gt;\n&lt;li&gt;shareable&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;PitchCraft is MIT licensed.&lt;/p&gt;\n\n&lt;p&gt;You can use it, fork it, and improve it.&lt;/p&gt;\n\n\n\n\n&lt;h1&gt;\n  \n  \n  What I Learned\n&lt;/h1&gt;\n\n&lt;p&gt;Three surprising things:&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;1. The browser is extremely powerful&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;You can build real audio tools with it.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;2. Signal processing is more accessible than expected&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Basic math goes a long way.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;3. Open source builds trust&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;People want to see how things work.&lt;/p&gt;\n\n\n\n\n&lt;h1&gt;\n  \n  \n  Try It Yourself\n&lt;/h1&gt;\n\n&lt;p&gt;Live demo:&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://indjoov.github.io/pitchcraft/\" rel=\"noopener noreferrer\"&gt;https://indjoov.github.io/pitchcraft/&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;Source code:&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://github.com/indjoov/pitchcraft\" rel=\"noopener noreferrer\"&gt;https://github.com/indjoov/pitchcraft&lt;/a&gt;&lt;/p&gt;\n\n\n\n\n&lt;h1&gt;\n  \n  \n  Feedback Welcome\n&lt;/h1&gt;\n\n&lt;p&gt;I’d love feedback from:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;developers&lt;/li&gt;\n&lt;li&gt;musicians&lt;/li&gt;\n&lt;li&gt;accessibility advocates&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;What would you add?&lt;/p&gt;\n\n\n\n\n&lt;h1&gt;\n  \n  \n  Final Thought\n&lt;/h1&gt;\n\n&lt;p&gt;The browser is no longer just a document viewer.&lt;/p&gt;\n\n&lt;p&gt;It’s becoming a creative platform.&lt;/p&gt;\n\n&lt;p&gt;PitchCraft is a small example of that shift.&lt;/p&gt;",
    "date": "2026-02-20T07:14:32.000Z",
    "url": "https://dev.to/niki_indjov_791e4c9df1/i-replaced-my-guitar-tuner-with-200-lines-of-javascript-4onj"
  },
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "Top React Native UI Kits in 2026",
    "partialText": "&lt;p&gt;Looking for the &lt;strong&gt;top React Native UI kits&lt;/strong&gt; for your next app? I’ve spent more than 60 hours testing this year’s most popular React Native UI libraries. My goal was to find which ones actually help you build better apps, save you hours of time, and cut down on debugging headaches.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Note: This piece was written with artificial intelligence support and may reference projects I'm affiliated with.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;After four years in mobile development and consulting, I’ve seen UI kits that deliver value quickly, and others that end up being more trouble than they're worth. This guide is based on hands-on usage, real prototype builds, and direct code comparisons-all so you can pick the right set of UI tools and avoid common pitfalls.&lt;/p&gt;\n\n&lt;blockquote&gt;\n&lt;p&gt;&lt;strong&gt;Have a go-to UI kit that you think should be here? Got feedback or tips? Feel free to reach out-I'm always interested in learning from other devs' experiences!&lt;/strong&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  How I Compared Each React Native UI Kit\n&lt;/h2&gt;\n\n&lt;p&gt;To keep things consistent and fair, I ran each UI kit through the same process:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;\n&lt;strong&gt;Setup &amp;amp; Onboarding:&lt;/strong&gt; How fast and simple is installation? Are the instructions clear? Can I see results quickly?&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Core Functionality:&lt;/strong&gt; I built a simple screen (like login or profile) to check the range of provided components-buttons, forms, navigation, you name it.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Ease of Use:&lt;/strong&gt; How’s the documentation? Is customization straightforward? Do I need workarounds?&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Speed &amp;amp; Stability:&lt;/strong&gt; Does everything run fast and reliably? Any obvious bugs, lag, or visual glitches?&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Support &amp;amp; Docs:&lt;/strong&gt; Are the docs up to date? Is there a helpful community or support team?&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Pricing:&lt;/strong&gt; Free, paid, or freemium? Are terms and licenses clear?&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Overall Feel:&lt;/strong&gt; Does it speed up development? Is it something I’d trust in a real project?&lt;/li&gt;\n&lt;/ol&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  🏆 Best Overall: &lt;strong&gt;AppLighter&lt;/strong&gt;\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;em&gt;Feels modern, sensible, and actually enjoyable to build with.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F2fksu0r7zyknxbdwk35w.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F2fksu0r7zyknxbdwk35w.png\" alt=\"AppLighter screenshot\" width=\"800\" height=\"450\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;AppLighter impressed me right from the first login. Setup was nearly instant. The dashboard is clean. I was building real screens within minutes. Many UI kits either overwhelm you or fall short, but AppLighter finds a practical balance.&lt;/p&gt;\n\n&lt;p&gt;AppLighter offers production-ready React Native templates with full source code, modern structure, and straightforward support. These are real app templates, not just single components, and they work for iOS, Android, and the web.&lt;/p&gt;\n\n&lt;p&gt;Check them out: &lt;a href=\"https://applighter.com\" rel=\"noopener noreferrer\"&gt;AppLighter&lt;/a&gt;&lt;/p&gt;\n\n&lt;h3&gt;\n  \n  \n  Highlights\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;True production-level templates for iOS, Android, and web&lt;/li&gt;\n&lt;li&gt;Great documentation and clear best practices&lt;/li&gt;\n&lt;li&gt;Frequent updates for new versions of Expo, React Native, and packages&lt;/li&gt;\n&lt;li&gt;Editable source code with modular architecture, making customization easy&lt;/li&gt;\n&lt;li&gt;Supports features like dark mode, gamification, and cross-platform layouts&lt;/li&gt;\n&lt;li&gt;Professional support and licenses flexible enough for freelancers or agencies&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  What could be better\n&lt;/h3&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Only covers the frontend-you’ll need to set up your own backend&lt;/li&gt;\n&lt;li&gt;Preview products may change more frequently as they add new features&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h3&gt;\n  \n  \n  Pricing details\n&lt;/h3&gt;\n\n&lt;p&gt;Templates are one-time purchases with lifetime access and updates.&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Standard / single project:&lt;/strong&gt; $49.00 for each template&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Multiple project / team:&lt;/strong&gt; $199.00 per template\nYou get all source code, 6 months of updates, and premium support for each buy. No annual fees.&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  🥈 React Native Elements - Loads of Components, Some Rough Spots\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;em&gt;A strong open-source library if you’re comfortable troubleshooting now and then.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fz6vtiqdvrsr8xsirijk2.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fz6vtiqdvrsr8xsirijk2.png\" alt=\"React Native Elements screenshot\" width=\"800\" height=\"450\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;React Native Elements has a wide set of prebuilt components and a healthy open source community. It’s organized and built in TypeScript, aiming for consistent design across platforms. Still, setting it up sometimes takes patience, and the documentation can leave you hunting for details on tricky issues.&lt;/p&gt;\n\n&lt;p&gt;Try it yourself: &lt;a href=\"https://reactnativeelements.com\" rel=\"noopener noreferrer\"&gt;React Native Elements&lt;/a&gt;&lt;/p&gt;\n\n&lt;h4&gt;\n  \n  \n  Where it stands out\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Great collection of reusable, customizable elements&lt;/li&gt;\n&lt;li&gt;Regularly updated with input from a solid group of contributors&lt;/li&gt;\n&lt;li&gt;Works nicely with Expo and TypeScript&lt;/li&gt;\n&lt;li&gt;Modular-you only use what you need&lt;/li&gt;\n&lt;li&gt;Theming support for consistent branding&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Downsides\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Peer dependency errors make installs tricky sometimes&lt;/li&gt;\n&lt;li&gt;Documentation could be clearer for complex or less common use cases&lt;/li&gt;\n&lt;li&gt;You may run into quirky errors, especially with lists&lt;/li&gt;\n&lt;li&gt;Some small UI bugs in specific widgets like spinners and alerts&lt;/li&gt;\n&lt;li&gt;Can slow down a bit with deeply nested or dynamic lists&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Cost\n&lt;/h4&gt;\n\n&lt;p&gt;Fully open-source. No official pricing-free to use.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  🥉 NativeBase - Flexible But Can Be Frustrating\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;em&gt;Feature-heavy, but using it can feel like solving a puzzle.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F16e6av1zi130lgs1u0oc.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F16e6av1zi130lgs1u0oc.png\" alt=\"NativeBase screenshot\" width=\"800\" height=\"450\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;NativeBase looks great on paper and offers a huge collection of components and design tokens. But I found onboarding confusing, and the docs assume you already know how everything works. Getting clean, consistent layouts across platforms took more effort than expected.&lt;/p&gt;\n\n&lt;p&gt;Explore it here: &lt;a href=\"https://nativebase.io\" rel=\"noopener noreferrer\"&gt;NativeBase&lt;/a&gt;&lt;/p&gt;\n\n&lt;h4&gt;\n  \n  \n  What I found useful\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Tons of components for just about any UI need&lt;/li&gt;\n&lt;li&gt;Rich theming, responsive design, and dark mode out of the box&lt;/li&gt;\n&lt;li&gt;Good documentation and community activity&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  What slowed me down\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Steeper learning curve, especially if you’re newer to React Native&lt;/li&gt;\n&lt;li&gt;Some quirks with theming-especially when you get into deeply nested styles or custom layouts&lt;/li&gt;\n&lt;li&gt;Performance drops with large or complex component trees, like long lists and forms&lt;/li&gt;\n&lt;li&gt;Compatibility issues after major React Native upgrades&lt;/li&gt;\n&lt;li&gt;Achieving consistent look and feel across both iOS and Android usually means manual tweaks&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Price info\n&lt;/h4&gt;\n\n&lt;p&gt;Pricing isn’t easily found. There’s often a commercial tier (around $18/month), with demos limited and no real free trial.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  React Native Paper - Material Design Specialist\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;em&gt;A strong Material Design option, though it can be rough around the edges.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F78tqq662fg2kpl6u3nwj.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F78tqq662fg2kpl6u3nwj.png\" alt=\"React Native Paper screenshot\" width=\"800\" height=\"450\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;If you want to follow Google’s Material Design system closely across iOS and Android, React Native Paper offers a complete set of production-ready components. It allows deep customization, if you’re ready to dig into details. Just be ready for quirks after updates and odd bugs with some components.&lt;/p&gt;\n\n&lt;p&gt;Take a look: &lt;a href=\"https://callstack.github.io/react-native-paper\" rel=\"noopener noreferrer\"&gt;React Native Paper&lt;/a&gt;&lt;/p&gt;\n\n&lt;h4&gt;\n  \n  \n  Pros\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Very broad Material Design toolkit with lots of options&lt;/li&gt;\n&lt;li&gt;Consistent feel across platforms&lt;/li&gt;\n&lt;li&gt;Open source community keeps updates coming&lt;/li&gt;\n&lt;li&gt;Straightforward integration into most projects&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Cons\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Some components break after React Native updates&lt;/li&gt;\n&lt;li&gt;Minor issues like off-center icons and ripple glitches&lt;/li&gt;\n&lt;li&gt;Troubleshooting can be time-consuming&lt;/li&gt;\n&lt;li&gt;Docs assume familiarity with React Native and the Material system&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Fee\n&lt;/h4&gt;\n\n&lt;p&gt;Absolutely free and open-source. No tiers, no paid support.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Shoutem UI - Customization With Learning Curves\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;em&gt;Flexible library that could use smoother onboarding.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;Shoutem UI gives you ready-to-use, visually consistent components and has theming and animation built in. The library feels powerful at first, but the setup isn’t as smooth as you might expect. You’ll sometimes need to dig into forums or GitHub to get clear directions.&lt;/p&gt;\n\n&lt;p&gt;Try out the library: &lt;a href=\"https://shoutem.github.io/ui\" rel=\"noopener noreferrer\"&gt;Shoutem UI&lt;/a&gt;&lt;/p&gt;\n\n&lt;h4&gt;\n  \n  \n  Strengths\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Plenty of prebuilt components and layout tools&lt;/li&gt;\n&lt;li&gt;Animation and theming included&lt;/li&gt;\n&lt;li&gt;Cross-platform functionality out of the box&lt;/li&gt;\n&lt;li&gt;Open-source, with a developer portal and some community support&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Weaknesses\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Some components feel outdated and not very flexible&lt;/li&gt;\n&lt;li&gt;Interface takes a bit more effort than others to configure&lt;/li&gt;\n&lt;li&gt;Docs are missing info in places, making it harder for beginners&lt;/li&gt;\n&lt;li&gt;Community support varies-help can be slow or unclear&lt;/li&gt;\n&lt;li&gt;Workflow for app building can get frustrating&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Price points\n&lt;/h4&gt;\n\n&lt;p&gt;Open source UI kit, but advanced features or builder tools may require extra fees. No published price list.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  UI Kitten - Dynamic Theming With Some Limits\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;em&gt;Powerful for branding, but stuck in its own design system.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fyc3jg3wo1enaywcnj9j6.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fyc3jg3wo1enaywcnj9j6.png\" alt=\"UI Kitten screenshot\" width=\"800\" height=\"450\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;UI Kitten is all about theming. It comes with a unified component library based on the Eva Design System, and is both free and open source. Runtime theme switching is simple. Just be aware that deep customization and performance may bring new hurdles, especially if your app grows.&lt;/p&gt;\n\n&lt;p&gt;Check it out: &lt;a href=\"https://akveo.github.io/react-native-ui-kitten\" rel=\"noopener noreferrer\"&gt;UI Kitten&lt;/a&gt;&lt;/p&gt;\n\n&lt;h4&gt;\n  \n  \n  What stands out\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Great range of customizable UI components&lt;/li&gt;\n&lt;li&gt;Easy-to-implement theming for rapid branding&lt;/li&gt;\n&lt;li&gt;Cross-platform coverage is solid&lt;/li&gt;\n&lt;li&gt;Comes with icon sets and a good starter app&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Where it came up short\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Some features, like ApplicationProvider, can make loading slow&lt;/li&gt;\n&lt;li&gt;Docs can lag behind-more advanced use cases aren’t covered well&lt;/li&gt;\n&lt;li&gt;Integrating outside design systems can get tricky&lt;/li&gt;\n&lt;li&gt;Less active project periods; support can be slow&lt;/li&gt;\n&lt;li&gt;You’re mostly locked into the Eva system&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Pricing\n&lt;/h4&gt;\n\n&lt;p&gt;Free and open source for most needs. For business services or custom support, reach out to Akveo for quotes.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Material Kit React Native - Simple, but Restrictive\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;em&gt;Good for prototyping, but be ready for install issues.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;Material Kit React Native supplies a compact set of Material-inspired components for both iOS and Android. Unfortunately, I found installation unreliable and the documentation sparse. It’s mostly useful for simple prototypes.&lt;/p&gt;\n\n&lt;p&gt;Try out the kit: &lt;a href=\"https://react-native-material-kit.github.io/react-native-material-kit\" rel=\"noopener noreferrer\"&gt;Material Kit React Native&lt;/a&gt;&lt;/p&gt;\n\n&lt;h4&gt;\n  \n  \n  Upsides\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Decent gather of cross-platform components&lt;/li&gt;\n&lt;li&gt;Good selection of tutorials from the community&lt;/li&gt;\n&lt;li&gt;Fast for basic prototyping&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Downsides\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Installation often fails, with some bugs left open&lt;/li&gt;\n&lt;li&gt;Not all components work smoothly natively-manual fixes needed&lt;/li&gt;\n&lt;li&gt;Complex UIs can lag or feel unresponsive&lt;/li&gt;\n&lt;li&gt;Lots of reliance on third-party dependencies&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Price info\n&lt;/h4&gt;\n\n&lt;p&gt;No official price. Most features are free but expect to spend extra time troubleshooting.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  React Native Material Design - Android Focus, Not Always Consistent\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;em&gt;Faithful to Material style, but with patchy support and docs.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;React Native Material Design targets Android and replicates Google’s style well. You get lots of components out of the box. The tradeoff is spotty documentation, bugs in some features (like DataTable), and weaker iOS support.&lt;/p&gt;\n\n&lt;p&gt;Check it here: &lt;a href=\"https://react-native-material-design.github.io/react-native-material-design\" rel=\"noopener noreferrer\"&gt;React Native Material Design&lt;/a&gt;&lt;/p&gt;\n\n&lt;h4&gt;\n  \n  \n  What works well\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Wide range of Material Design widgets for Android&lt;/li&gt;\n&lt;li&gt;Easy to install, open source&lt;/li&gt;\n&lt;li&gt;Community welcomes contributions&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Where you need caution\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Docs are thin, sometimes outdated, and expect advanced skills&lt;/li&gt;\n&lt;li&gt;Some widgets are buggy or incomplete (DataTable is a common complaint)&lt;/li&gt;\n&lt;li&gt;iOS versions don’t always work the same as on Android&lt;/li&gt;\n&lt;li&gt;Limited third-party integrations for advanced scenarios&lt;/li&gt;\n&lt;li&gt;Customizing complex cases can be tedious&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Cost\n&lt;/h4&gt;\n\n&lt;p&gt;Fully free and open source. No commercial support offered.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  React Native Material Kit - Packed With Components, But Feels Old-School\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;em&gt;Embraces Google’s look, but documentation and onboarding are rough.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F063k1hwypedfjyyhzewb.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F063k1hwypedfjyyhzewb.png\" alt=\"React Native Material Kit screenshot\" width=\"800\" height=\"450\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;React Native Material Kit comes with many ready-made Material components-buttons, inputs, cards, and more. All are free and the MIT license is permissive. On the flip side, I found the docs lacking and setup can feel fragile, especially with newer React Native versions.&lt;/p&gt;\n\n&lt;p&gt;Try it here: &lt;a href=\"https://github.com/xinthink/react-native-material-kit\" rel=\"noopener noreferrer\"&gt;React Native Material Kit&lt;/a&gt;&lt;/p&gt;\n\n&lt;h4&gt;\n  \n  \n  What I appreciated\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Strong Material Design component line-up&lt;/li&gt;\n&lt;li&gt;Flexible enough for tweaks and brand changes&lt;/li&gt;\n&lt;li&gt;Free and MIT-licensed&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Issues I saw\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Documentation barely covers real use cases or step-by-step guides&lt;/li&gt;\n&lt;li&gt;Can have compatibility problems after RN upgrades&lt;/li&gt;\n&lt;li&gt;Frequent install bugs (npm install failing was common)&lt;/li&gt;\n&lt;li&gt;Not under active maintenance anymore&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Pricing\n&lt;/h4&gt;\n\n&lt;p&gt;Completely free to use under the MIT open source license.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Hestia Kit - Lots of Templates, with Inconsistent Experience\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;em&gt;Big library of screens, but documentation and support fall short.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;Hestia Kit has a huge menu of React Native templates-more than 130 templates and 70+ reusable components. TypeScript support and dark mode are both there, and pricing is a simple one-time payment. However, I quickly ran into thin instructions and slow customer support.&lt;/p&gt;\n\n&lt;p&gt;Give it a look: &lt;a href=\"https://hestiakit.com/\" rel=\"noopener noreferrer\"&gt;Hestia Kit&lt;/a&gt;&lt;/p&gt;\n\n&lt;h4&gt;\n  \n  \n  Positive points\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Over 130 templates and 74 reusable elements&lt;/li&gt;\n&lt;li&gt;Dark mode built in&lt;/li&gt;\n&lt;li&gt;Fast workflow with one-click code copy&lt;/li&gt;\n&lt;li&gt;Regular template and feature updates&lt;/li&gt;\n&lt;li&gt;Simple one-time payment ($199)&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Tradeoffs\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Docs are light, which makes onboarding tricky&lt;/li&gt;\n&lt;li&gt;Customer service can be slow or not respond&lt;/li&gt;\n&lt;li&gt;Some templates look outdated or generic&lt;/li&gt;\n&lt;li&gt;Plugging pieces together isn’t always smooth&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Pricing\n&lt;/h4&gt;\n\n&lt;p&gt;$199 for lifetime use, unlimited access, and free updates. No free trial.&lt;/p&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  CraftReactNative - Fast for Pros, Not for Beginners\n&lt;/h2&gt;\n\n&lt;p&gt;&lt;em&gt;Deep component coverage, but it doesn’t feel polished out of the box.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fny89xfqi1wk1277nkz9c.png\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fny89xfqi1wk1277nkz9c.png\" alt=\"CraftReactNative screenshot\" width=\"800\" height=\"450\"&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;CraftReactNative delivers a big catalog of React Native components and templates-anything from Avatars to property listings to AI chat. Full TypeScript support, the Unistyles theming engine, and one-time pricing make it attractive for independent developers. Still, the onboarding is technical and the interface feels basic.&lt;/p&gt;\n\n&lt;p&gt;Give it a try: &lt;a href=\"https://www.craftreactnative.com/\" rel=\"noopener noreferrer\"&gt;CraftReactNative&lt;/a&gt;&lt;/p&gt;\n\n&lt;h4&gt;\n  \n  \n  Noteworthy aspects\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Comprehensive library of tested, accessible screens and UI elements&lt;/li&gt;\n&lt;li&gt;Lifetime license model, so no monthly fees&lt;/li&gt;\n&lt;li&gt;Raw access to code, great for those confident in React Native&lt;/li&gt;\n&lt;li&gt;Works well on both iOS and Android&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  What I didn’t love\n&lt;/h4&gt;\n\n&lt;ul&gt;\n&lt;li&gt;UI and templates look utilitarian-doesn’t deliver premium visual polish&lt;/li&gt;\n&lt;li&gt;Docs are written for experienced React Native devs&lt;/li&gt;\n&lt;li&gt;Onboarding is more “do it yourself,” with less step-by-step help&lt;/li&gt;\n&lt;li&gt;Some UI styles and UX feel a bit outdated&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h4&gt;\n  \n  \n  Pricing structure\n&lt;/h4&gt;\n\n&lt;p&gt;You get a one-time payment model:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;Free&lt;/strong&gt;: $0 for component library, unlimited projects, GitHub access&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Individual&lt;/strong&gt;: $79 (normally $109) for premium templates, private support, commercial use&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;Team&lt;/strong&gt;: $199 (normally $299) for up to five developers and priority support&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Brief Notes on Other Tools I Tried\n&lt;/h2&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://en.wikipedia.org/wiki/Appery.io?utm_source=openai\" rel=\"noopener noreferrer\"&gt;Appery.io&lt;/a&gt;:&lt;/strong&gt; UI feels old, limited React Native content.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://en.wikipedia.org/wiki/Snappii?utm_source=openai\" rel=\"noopener noreferrer\"&gt;Snappii&lt;/a&gt;:&lt;/strong&gt; Too generic, few native UI choices.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://en.wikipedia.org/wiki/Appcircle?utm_source=openai\" rel=\"noopener noreferrer\"&gt;Appcircle Inc.&lt;/a&gt;:&lt;/strong&gt; Mainly CI/CD, not a UI kit.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://buildfire.com/mobile-app-development-tools/?utm_source=openai\" rel=\"noopener noreferrer\"&gt;BuildFire&lt;/a&gt;:&lt;/strong&gt; SaaS builder, not React Native-centered.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://www.cotocus.com/blog/top-10-mobile-app-development-platforms-tools-in-2025-features-pros-cons-comparison/?utm_source=openai\" rel=\"noopener noreferrer\"&gt;Flutter&lt;/a&gt;:&lt;/strong&gt; Different framework, not compatible with React Native.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://www.appsmith.com/blog/appian-competitors?utm_source=openai\" rel=\"noopener noreferrer\"&gt;Appsmith&lt;/a&gt;:&lt;/strong&gt; Backend-focused, weak mobile UI.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://appwrk.com/mobile-app-developer-tools?utm_source=openai\" rel=\"noopener noreferrer\"&gt;APPWRK&lt;/a&gt;:&lt;/strong&gt; Agency build, not much support or docs.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://www.tooltester.com/en/blog/app-makers/?utm_source=openai\" rel=\"noopener noreferrer\"&gt;The 11 Best App Makers&lt;/a&gt;:&lt;/strong&gt; No-code focus, not fit for devs.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://github.com/instamobile/react-native-starter-kit\" rel=\"noopener noreferrer\"&gt;React Native Starter Kit&lt;/a&gt;:&lt;/strong&gt; Decent, but not broad enough.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://github.com/GeekyAnts/NativeBase-KitchenSink\" rel=\"noopener noreferrer\"&gt;NativeBase-KitchenSink&lt;/a&gt;:&lt;/strong&gt; Just a demo app.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://github.com/GeekyAnts/React-Native-Seed\" rel=\"noopener noreferrer\"&gt;React Native Seed&lt;/a&gt;:&lt;/strong&gt; Basic boilerplate, minimal UI.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://rexpo.io/\" rel=\"noopener noreferrer\"&gt;Rexpo&lt;/a&gt;:&lt;/strong&gt; Too early stage, sparse docs.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://theappmarket.io/\" rel=\"noopener noreferrer\"&gt;theappmarket&lt;/a&gt;:&lt;/strong&gt; Marketplace, not a real UI kit.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://www.geekyhawks.com/\" rel=\"noopener noreferrer\"&gt;Geeky Hawks&lt;/a&gt;:&lt;/strong&gt; Barebones selection.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://reactnativemarket.com/\" rel=\"noopener noreferrer\"&gt;React Native Market&lt;/a&gt;:&lt;/strong&gt; Mixed-quality component kits.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://www.creative-tim.com/\" rel=\"noopener noreferrer\"&gt;Creative Tim&lt;/a&gt;:&lt;/strong&gt; Generic design, not focused on React Native.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://github.com/PrincewillIroka/React-Native-UI-Templates\" rel=\"noopener noreferrer\"&gt;React-Native-UI-Templates&lt;/a&gt;:&lt;/strong&gt; Mixed code quality.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://www.geekyhawks.com/shop/react-native/\" rel=\"noopener noreferrer\"&gt;Geeky Hawks Shop&lt;/a&gt;:&lt;/strong&gt; Still only a few options.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://new-market.nativebase.io/\" rel=\"noopener noreferrer\"&gt;NativeBase Market&lt;/a&gt;:&lt;/strong&gt; Marketplace, many paid, few free.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://nativelaunch.dev/\" rel=\"noopener noreferrer\"&gt;NativeLaunch&lt;/a&gt;:&lt;/strong&gt; Few templates, rare updates.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://codekits.co/\" rel=\"noopener noreferrer\"&gt;Codekits&lt;/a&gt;:&lt;/strong&gt; Only a handful of options; price is high for value.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://www.setproduct.com/system\" rel=\"noopener noreferrer\"&gt;Setproduct&lt;/a&gt;:&lt;/strong&gt; Nice UI, but not built for mobile needs.&lt;/li&gt;\n&lt;li&gt;\n&lt;strong&gt;&lt;a href=\"https://gplpixel.com/product/react-native-ui/\" rel=\"noopener noreferrer\"&gt;BigKit&lt;/a&gt;:&lt;/strong&gt; Massive bundle, inconsistent quality.&lt;/li&gt;\n&lt;/ul&gt;\n\n\n\n\n&lt;h2&gt;\n  \n  \n  Wrapping Up\n&lt;/h2&gt;\n\n&lt;p&gt;Every React Native UI kit I tried fit into one of three camps: too complex for practical use, too basic for real apps, or too unstable to trust. The few standouts combined real production value with a smoother developer experience.&lt;/p&gt;\n\n&lt;p&gt;No matter which kit you choose, pay attention to the balance between features, support, and ease of use. The best React Native UI kits help you go from idea to ship-ready without tying you in knots, so you can focus more on building-and less on fighting your tools.&lt;/p&gt;",
    "date": "2026-02-20T07:13:23.000Z",
    "url": "https://dev.to/halesoren/top-react-native-ui-kits-in-2026-350e"
  },
  {
    "publisherId": "devto",
    "publisherName": "Dev.to",
    "specTitle": "React/Next.js",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://dev.to/feed/tag/react",
    "title": "Web And App Development",
    "partialText": "&lt;p&gt;&lt;a href=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fvd350fola4l9zjabthgi.jpg\" class=\"article-body-image-wrapper\"&gt;&lt;img src=\"https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fvd350fola4l9zjabthgi.jpg\" alt=\" \" width=\"800\" height=\"1077\"&gt;&lt;/a&gt;&lt;/p&gt;",
    "date": "2026-02-20T06:16:55.000Z",
    "url": "https://dev.to/sscodehub/web-and-app-development-3djd"
  }
]