[
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Understanding Filters, Shortcodes and Data in 11ty",
    "partialText": "\r\n      <p>Filters, shortcodes and data are the ultimate source of power in 11ty, that’s why together, they are known as the Triforce among 11ty enthusiasts. Sometimes it’s a little confusing what the difference between shortcodes, data and filters really is, and frankly the boundaries can become a little blurred with 11ty.</p>\n<p>11ty has the power of multiple template engines. This is a somewhat unique feature among static site generators. I find it incredibly convenient, but also know it’s a source of some confusion.</p>\n<p>11ty decides which template engine to use based on the file extension. This can be configured in your <code>.eleventy.js</code> config file, but we’re going to assume the default configurations. The most common file types I see people using for templates in 11ty are markdown (<code>.md</code>) and nunjucks (<code>.njk</code>). Personally I use nunjucks for layout and markdown for simple content.</p>\n<p>The default template engine for Markdown is Liquid and for Nunjucks, it’s unsurprisingly Nunjucks. Both Nunjucks, Liquid and other template languages in 11ty have capabilities for filters, data and tags. The <code>addShortcode</code> method is simply 11ty a unified way of creating tags and extensions.</p>\n<p>11ty also has <code>addFilter</code> which provides a unified method for creating filters that will be available no matter which template engine is used.</p>\n<h2>Filters</h2>\n<p>Filters take a single input on the left, modify this inline and return a single value. They are good for modifying a single piece of data in some way.</p>\n<p>For example, in a markdown file I can use the <code>upcase</code> filter in liquid to modify the value “mike”:</p>\n<pre><code>\n{{ &quot;mike&quot; | upcase  }}\n\n</code></pre>\n<p>The result of this filter will be “MIKE”.</p>\n<p>In Markdown and Nunjucks you can chain multiple filters using the pipe (<code>|</code>) operator.</p>\n<p>If you take a look at the 11ty documentation, you’ll see there’s not really a good list of available filters anywhere. You might find 4 universal 11ty filters, and if you’re not familiar with 11ty or templating languages in general, you might assume these are the only filters available.</p>\n<p>For a complete list of filters take a look at the Liquid and Nunjucks or the documentation for your template engine of choice.</p>\n<p>Looking at these docs you might notice some filters accept a values on the right such as divided_by:</p>\n<pre><code>\n{{ 16 | divided_by: 4 }}\n\n</code></pre>\n<p>Or split:</p>\n<pre><code>\n{% assign beatles = &quot;John, Paul, George, Ringo&quot; | split: &quot;, &quot; %}\n{% for member in beatles %}\n  {{ member }}\n{% endfor %}\n\n</code></pre>\n<p>This is where things get a little bit blurry. You can use filters like this, but when creating your own, the ability to pass parameters other than the value to the left of the pipe is not supported by 11ty universal filters. This is primarily what distinguishes it from a shortcode in 11ty.</p>\n<p>Note: 11ty does allow you to extend the underlying template engine. But I’d strongly recommend sticking with the universal options as much as possible and making a clear distinction between filters, shortcodes and data for all your needs.</p>\n<h2>Shortcodes</h2>\n<p>Unlike filters, shortcodes don’t modify a value, but they can take any number of parameters, so they can do largely the same thing as a filter and more.</p>\n<p>Personally I think filters provide an easier to read API and stop you from over complicating things. They should be used where it makes sense.</p>\n<p>Shortcodes work best when you need to pass multiple parameters.</p>\n<p>Before making a shortcode, consider if the parameters are dynamic or if they can be set once using static config. An example might be a <code>JSON.stringify()</code> shortcode:</p>\n<pre><code>\n{% stringify object, indentation %}\n\n</code></pre>\n<p>It’s likely indentation can be configured once per site so this example could probably be made into a filter.</p>\n<p>The place where shortcodes really shine is when using paired shortcodes. Paired shortcodes have opening and closing tags that allow you to access and modify the content between the tags.</p>\n<p>Let’s write a complete simple example.</p>\n<p>Filename: <code>.eleventy.js</code>:</p>\n<pre class=\"language-js\"><code class=\"language-js\"> eleventyConfig<span class=\"token punctuation\">.</span><span class=\"token function\">addPairedShortcode</span><span class=\"token punctuation\">(</span>‘my_shortcode’<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">content</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br>  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Log in Node</span><br>  <span class=\"token keyword\">return</span> content<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Filename: <code>index.md</code>:</p>\n<pre><code>---\nvar_in_shortcode: &quot;I am resolved first&quot;\n---\n\n{% my_shortcode %}\n  Hello {{ var_in_shortcode }}\n{% my_shortcode %}\n{% raw %}\n</code></pre>\n<p>With this example, it’s important to know that the value of <code>var_in_content</code> will be resolved from the front matter before it is passed to <code>my_shortcode</code>.</p>\n<p>Shortcode look similar to other template language features such as iteration:</p>\n<pre><code>{% raw %}\n{% for product in collection.products %}\n  {{ product.title }}\n{% endfor %}\n\n</code></pre>\n<p>The key difference is that shortcodes cannot modify the global context and provide data to templates inside the paired tags.</p>\n<h2>Data</h2>\n<p>One of my favourite things about 11ty is how it manages data. Typically data is read from front matter and is available to use inside templates. 11ty provides the means to inject custom global data at stages during the process.</p>\n<p>One of the great things is that data can be literally anything. It’s really useful for a set of global variables like a site name, navigation menus or copyright statements.</p>\n<p>Data can also be async. This means you can fetch data from other sources, for example a product list from Stripe or Shopify, or a feed from Twitter or Instagram. And you can use this data in the generation of a static site rather than as client side operation.</p>\n<p>What makes data incredibly powerful is that, for some template languages at least, it can be more than a static value. In Nunjucks templates, but not Liquid, 11ty data can also be a function. This means we can create something similar to shortcodes by exporting a function from a data file:</p>\n<p>Filename: <code>_data/example.js</code>:</p>\n<pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><br>  site_name<span class=\"token operator\">:</span> <span class=\"token string\">\"Example\"</span><span class=\"token punctuation\">,</span><br>  <span class=\"token function-variable function\">add</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span>b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> a <span class=\"token operator\">+</span> b<br><span class=\"token punctuation\">}</span></code></pre>\n<p>In our templates we can now access the <code>example</code> data:</p>\n<p>Filename: <code>index.njk</code>:</p>\n<pre><code>\n{{ example.add(1, 2) }}\n\n</code></pre>\n<p>Add to this the fact that data can be async (ok, filters and shortcodes can also be async as of version v0.2.13 but I started with 11ty before all this) and I think that data is probably the triangle at the top of the Triforce for me.\nI hope this has helped clarify how and where to use data, filters and shortcodes. There may still be some confusion as a result of different implementations between template languages. Generally I’d say  before getting too far into an 11ty project, pick the template language that works best for you and stick with it. Understand how each of the above work with your choice. Make a few test shortcodes and filters as well as experiment with data before early in the project. Also choose nunjucks.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/11ty-filters-data-shortcodes/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "CSS Architecture for Modern JavaScript Applications",
    "partialText": "\r\n      <p>I went to a JavaScript meet-up in Sydney the other night and asked the question &quot;How many people know what CSS Architecture is?&quot;. The room was full of different people with varying backgrounds and experience. I thought at minimum around a quarter might know what I was talking about. I was hoping more would. To my surprise, only a handful of people raised their hand.</p>\n<p>I then asked, &quot;How many people feel the difficulties they have writing CSS at scale have been largely solved by CSS-in-JS?&quot;. They weren't stupid, they knew this question was a set-up, nonetheless, many of them obliged me and put their hand up.</p>\n<p>From the looks in the room, I think many more people felt this way than were willing to admit. At the very least, I think a lot of people believe CSS architecture is no longer relevant in the context of modern JavaScript applications.</p>\n<p>That perspective was very kindly put to me by Alex Louden on Twitter:</p>\n<blockquote>\n<p>&quot;Styled Components etc has removed the need for class names completely for me. Now since styles are included in my presentation components (to me at least) it doesn’t feel like a style architecture issue any more?&quot;</p>\n</blockquote>\n<p>This is not to criticise that perspective; it's completely valid! Alex is saying tooling helped make some of the challenges he had dealing with CSS (in particular specificity) easier. The challenge now is dealing with components in an application.</p>\n<p>I understand this perspective, but find it interesting when people see classnames and components as completely different concerns. Classnames and components are just different ways of composing user interfaces. There are still many challenges involved in making good re-useable and scalable front-end systems, no matter how you put them together.</p>\n<p>These challenges are not new. In fact, there are some well established solutions in CSS architecture that can be easily transferred to component-based style systems. So why are so few people talking about this? And why are many more people completely unaware of the topic?</p>\n<p>I believe there is a lot that has contributed to this and it's worth reflecting on how we got here...</p>\n<h2>How we got here</h2>\n<p>I believe the initial response to CSS-in-JS, from many leaders in the CSS community hasn't helped with understanding and knowledge sharing. I've often heard comments like &quot;People (i.e. younger JavaScript developers) just need to learn CSS better.&quot; People who have knowledge about CSS architecture need to do a better job of articulating this experience in a way that is accessible and relevant to new developers. If I'm honest about it, the CSS community has failed at this.</p>\n<p>But it's not that simple. There are some non-human factors and context we need to consider as well.</p>\n<p>Before the rise of JavaScript components. The strong and obvious naming conventions of BEM gave developers a system to follow that helped avoid specificity clashes in the &quot;terrifying global scope&quot; of CSS. This alone was reason enough for many people to use BEM. You could get good enough results, without necessarily understanding nuanced reasons behind the conventions.</p>\n<p>When JavaScript tooling provided a better solution than humans following naming conventions, it opened up UI development to a wider spectrum of developers who previously had less interest in, or reason to focus on, style architecture.</p>\n<p>Business jumped on the dogpile. They reasoned it would be cheaper to employ developers who could &quot;do everything&quot; and got what they considered to be adequate results by under-investing in UI specialists. Some developers who'd spent half a career perfecting skills in this area felt threatened. Perhaps some were defensive.</p>\n<p>At the same time, developers working in spaces of growth and opportunity could sometimes be dismissive of skills that were not flavour of the month. There was pride, and hype, and reluctance to admit that new tooling and approaches were not always producing better, more re-useable, front-end architecture.</p>\n<p>I've been consulting in this space for the last 5 years and I've seen many different systems for building UIs with component-based architecture. The reality is, whilst some aspects of building large scale JavaScript applications are easier, the promise of better, more re-usable UI components hasn't been delivered. Front-end architecture is more varied in approach and the results less re-useable than it was before the rise of JavaScript tooling.</p>\n<p>Some people might challenge this, but I've seen enough examples to consider it an objective truth. What I have seen is:</p>\n<ul>\n<li>almost every team has a different approach,</li>\n<li>90% of components get zero re-use,</li>\n<li>visual changes are often difficult, slow and expensive,</li>\n<li>it's harder <strong>than ever</strong> to read and understand styles.</li>\n</ul>\n<p>Somewhere in the turbulence, we lost the more nuanced reasons behind the naming conventions.</p>\n<p>The aim of this was to give context, not blame (it's a little bit of everybody's fault). So let's draw a line, and look at how to apply some lessons from CSS architecture to modern JavaScript applications.</p>\n<br>\n<hr>\n<h2>CSS Architecture for Components</h2>\n<p>First of all, we need to consider what makes sensible abstractions in UI development. OOCSS, SMACSS and BEM all have a common language when they talk about the different parts of a UI component. I can summarise these as:</p>\n<ul>\n<li>Layout,</li>\n<li>Design,</li>\n<li>UI states, and</li>\n<li>Application logic</li>\n</ul>\n<p>If re-use or long-term maintainability is important, keeping these concerns separate is beneficial. Yet, this is not typically how teams approach the design of a component library.</p>\n<p>Components can do many things, they might fetch data, they might render HTML, they might call functions to execute business logic and manage application state. Sometimes a single component does all these things. There is usually little distinction around what the responsibility of a component should be. People draw boxes around the visual boundaries of a design and then mix this with application logic. That's how most components are built. We can do better than that.</p>\n<p>BEM gave semantic meaning to classnames and one of the biggest unseen values in this was we could immediately transfer our intentions to other developers across teams and even projects. If you know BEM you can look at a classname, e.g. <code>button--state-success</code> and immediately recognise this as a modifier for a button class.</p>\n<p>This kind of semantic meaning is sorely needed for components.</p>\n<p>With that in mind, let's look at different parts of a UI component, identified in CSS architecture methodologies and redefine them in terms of component architecture.</p>\n<h2>Layout components</h2>\n<p>Find a way to distinguish layout components in your application. It might be a comment in the file, a naming convention or the organisation of components in folders... it doesn't matter. What matters is we need a way to convey our intentions quickly to other developers.</p>\n<p>When we have common understanding of what a layout component is we can enforce expectations in code-reviews or linting.</p>\n<p>Layout components:</p>\n<ul>\n<li>own responsibility for layout and nothing more</li>\n<li>should never apply any presentational styles</li>\n<li>should not contain any application logic</li>\n<li>own responsibility for the layout of child items.</li>\n</ul>\n<p>That last point might be a little confusing at first. Why children and not themselves?</p>\n<p>In modern CSS there are two parts that contribute to layout:</p>\n<ul>\n<li>A parent item, which sets the display mode</li>\n<li>A child item, which participates in the parent items display mode.</li>\n</ul>\n<p>In other words, we have a <code>grid-container</code> and <code>grid-items</code>, or a <code>flex-container</code> and <code>flex-items</code>. There is always a parent/child relationship.</p>\n<p>To get the intended layout, we need the parent item and the child item to work together. Updating one of them independently from the other, will result in a broken layout. We have a word for this, it's called a dependency.</p>\n<p>Despite this dependency, we continue to make these separate components with no direct link. We simply hope that people put them together in the right way and don't change them. We call that an unmanaged dependency.</p>\n<p>The solution is to co-locate the layout concerns with the parent item. There are a number of ways this can happen...</p>\n<h3>Use A * Selector</h3>\n<p>Use the cascade to your advantage and apply a <code>*</code> selector to target all immediate children of a layout component.</p>\n<p>For example:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.layout </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">.layout > * </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 50%<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>This works, even with CSS-in-JS and you might be interested to know the <code>*</code> selector doesn’t increase specificity, so it’s easy to override with classic CSS, should you need.</p>\n<p>This might seem simple, but it works in most cases.</p>\n<h3>Render mark-up that wraps child items</h3>\n<p>Another option is to make the layout component responsible for rendering mark-up that wraps child items.</p>\n<p>This allows us to more directly control both sides of the parent/child relationship and is useful for ensuring semantic and accessible mark-up.</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> Layout <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>items<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><br>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span> <span class=\"token attr-name\">classname</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>parentStyles<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"><br>    </span><span class=\"token punctuation\">{</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span>  <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><br>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">classname</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>childItem<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span><br>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"><br>  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span><br><span class=\"token punctuation\">)</span></code></pre>\n<p>In the example above I'm ensuring the children of a <code>ul</code> will always be an <code>li</code>. At the same time I'm applying styles for the layout to both the parent and child items. These are managed somewhere in the layout component.</p>\n<h3>Export styles to be used by child-items</h3>\n<p>The biggest downside of rendering mark-up that wraps child items is you need to pass a list of items that get rendered into specific slots. That's ok for a simple list, but not ideal for more complicated layouts. As a final escape hatch for complicated components, you can export styles from the parent to be used by a child item.</p>\n<p>This allows us to co-locate layout concerns for a particular component.</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> sectionHeader <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./Page\"</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Heading</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">classname</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>sectionHeader<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">A Heading</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span></code></pre>\n<p>In the example above <code>Heading</code> still needs to be a child of <code>Page</code> but the dependency between these components is no longer hidden.</p>\n<p>By passing just the layout styles between components (not presentation) we're being explicit about what the dependency is. The <code>Heading</code> component is still responsible for any presentational styles applied to the <code>h1</code>.</p>\n<h2>Presentational components</h2>\n<p>Once again we need a way to convey intentions and set expectations about what aspects of UI development presentational components are responsible for. It should be immediately apparent that a component is a presentational component.</p>\n<p>Presentational components:</p>\n<ul>\n<li>deal with visual design,</li>\n<li>contain no application logic,</li>\n<li>set no <code>display</code> or positioning properties,</li>\n<li>are (mostly) just decorated HTML elements,</li>\n<li>should be size agnostic.</li>\n</ul>\n<p>Once again, the last point is the least intuitive. Size agnostic means presentational components should fill the space available. Trust in the layout components to set the constraints.</p>\n<p>In practical terms this means most UI components have no <code>display</code>, <code>width</code>, <code>height</code> or <code>margin</code> properties.</p>\n<p>This is sometimes hard to achieve. Working on presentational components is going to reveal problems or oversights in the layout (or even missing layout components). It feels easier to quickly add a margin to 'fix' the presentational component, but by keeping the responsibility for layout with the parent item, presentational components can be re-used in any part of the application.</p>\n<p>By adding CSS to presentational components to 'fix' layout issues, we are adding hidden dependencies between components. For long term maintainability, it's far better to fix these problems at the layout level.</p>\n<p>I know this is not always simple, so I'm going to give you an escape hatch. However, consider this the <code>!important</code> of CSS-in-JS. Use it when you absolutely must, and use it right. For certain types of components (usually <code>inline-block</code> elements where content is dependent on dynamic data and there is no obvious parent layout component) it sometimes makes sense to add a utility class, or a prop to set a single CSS property. If possible, these should still remain separate from the presentational component and be imported from a utility file. I suggest naming this <code>liabilities.js</code> or <code>debt.js</code>.</p>\n<p>Always try to avoid hard coding <code>width</code> and <code>height</code> in presentational components.</p>\n<h2>UI states</h2>\n<p>Both layout and presentational components have different types of UI state. UI state is different from application state, but the two are often conflated in modern web applications.</p>\n<p>From a UI development perspective, the state of a component refers to different display or layout variations that might occur when a user interacts with it.</p>\n<p>As a UI developer knowing the number variations and what styles are applied in each case is not only critical, it's the job description. So why has this has become so hard to know in modern JavaScript applications?</p>\n<p>When props are passed to a function that resolves styles, the number of variations can be hard or impossible to verify. This is an example from a real-word application I worked on:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> theme <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"theme.js\"</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">styles</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> selectedItems<span class=\"token punctuation\">,</span> activeItems<span class=\"token punctuation\">,</span> id <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><br>    backgroundColor<span class=\"token operator\">:</span> selectedItems<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><br>      <span class=\"token operator\">?</span> activeItems<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><br>        <span class=\"token operator\">?</span> theme<span class=\"token punctuation\">.</span>color<br>        <span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span>colorAlt<br>      <span class=\"token operator\">:</span> activeItems<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><br>      <span class=\"token operator\">?</span> theme<span class=\"token punctuation\">.</span>color<br>      <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span><br>    <span class=\"token string\">\":hover\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><br>      border<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">solid 1px </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>theme<span class=\"token punctuation\">.</span>colorAlt<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><br>    <span class=\"token punctuation\">}</span><br>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n<p>These styles are so difficult to reason about because you have to consider how the application state (props) effects each individual CSS property.</p>\n<p>Not only does this make it hard to read, it makes it difficult to test. If the props passed to a style function don’t represent a finite set of UI states, how do we know the current set of resolved values is something intended in the design?</p>\n<p>Once again CSS architecture taught us some things about how to manage UI state. SMACSS in particular talked about state and identified three different types of UI state:</p>\n<ul>\n<li>Modifier states</li>\n<li>Behavioural states</li>\n<li>Pseudo states</li>\n</ul>\n<p>I'm paraphrasing, because SMACSS was not thinking about components, so let's revise some of these ideas for modern front-end architecture.</p>\n<h3>Modifier states</h3>\n<p>Modifier states are top-level variations in design. They are not necessarily dependent on application state and may be applied as a stylistic choice.</p>\n<p>Examples include size variations, primary and secondary buttons, or the position of an image within a layout component.</p>\n<p>Modifier states can be extended with behavioural states.</p>\n<h3>Behavioural states</h3>\n<p>Behavioural states are dependent on application logic. They communicate something about the state of a component to the user. Examples might include success, failure and loading indicators, or the current item in a navigation menu.</p>\n<h3>Pseudo states</h3>\n<p>Pseudo states are more temporary. They usually map directly to persistent states in the browser, rather than application logic. Typical examples include <code>hover</code>, <code>focus</code> and <code>active</code> but this might also include <code>disabled</code> or <code>selected</code>.</p>\n<h3>UI states are finite</h3>\n<p>The solution to verifying UI states is to resolve styles down to a set of finite states that can be easily understood.</p>\n<p>To ensure this, I start by mapping out UI states into a table:</p>\n<table>\n<thead>\n<tr>\n<th>Modifier state</th>\n<th>Behavioural state</th>\n<th>Pseudo state</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Large</td>\n<td><strong>Loading</strong></td>\n<td>Hover</td>\n</tr>\n<tr>\n<td><strong>Medium</strong></td>\n<td>Success</td>\n<td><strong>Focus</strong></td>\n</tr>\n<tr>\n<td>Small</td>\n<td>Error</td>\n<td>Disabled</td>\n</tr>\n</tbody>\n</table>\n<p>Next consider how these states combine. Typically you only have one modifier and one behavioural state active at any one time.</p>\n<p>You can visualise this as a tree:</p>\n<p><img src=\"/img/state-tree.png\" alt=\"A tree representation of the state table above\"></p>\n<p>If you find it's possible to have two behavioural states active at the same time, split them into different categories.</p>\n<table>\n<thead>\n<tr>\n<th>Modifier state</th>\n<th>Network state</th>\n<th>Todo state</th>\n<th>Pseudo state</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Large</td>\n<td><strong>Loading</strong></td>\n<td>To Do</td>\n<td>Hover</td>\n</tr>\n<tr>\n<td><strong>Medium</strong></td>\n<td>Success</td>\n<td><strong>Doing</strong></td>\n<td><strong>Focus</strong></td>\n</tr>\n<tr>\n<td>Small</td>\n<td>Error</td>\n<td>Done</td>\n<td>Disabled</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Warning</strong>: If you find you do need this, consider carefully, as it’s often a sign that you have two components pretending to be one.</p>\n<p>Because state can be additive, (i.e. behavioural states can change depending on the modifier state), to work out the total number of variations, we multiply the possibilities. With 3 types of state and 3 possibilities for each, there are (<code>3 x 3 x 3</code>), 27 possible variations.</p>\n<p>Obviously not every combination matters. The disabled state might look the same for every type of modifier and maybe the pseudo states are the same for all modifiers. We can eliminate duplicate states:</p>\n<p><img src=\"/img/state-tree-culled.png\" alt=\"A culled tree representation of the state table above\"></p>\n<p>CSS forced us to flatten the state tree and have a single selector for each possible combination of state. Although sometimes tedious, this made us acutely aware of how many variations there were.</p>\n<p>JavaScript doesn't force us to flatten the state tree in any way. The concept of different types of UI state often lost and at worst the value of individual CSS properties depends on the resolution of business logic and data within the “style sheet”.</p>\n<p>It doesn’t matter whether you’re composing styles with classnames, template strings or objects in JavaScript. It remains important to have a single representation for each of the possible UI states.</p>\n<p>My current favoured approach is to resolve application logic outside the style function, then and pass keys for modifier and behavioural state. Where a behavioural state changes depending on the modifier, I use CSS custom properties to set variations that are later applied in the behaviour.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> modifiers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><br>  light<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><br>    color<span class=\"token operator\">:</span> <span class=\"token string\">\"#777\"</span><span class=\"token punctuation\">,</span><br>    <span class=\"token string\">\"--pressed-color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#333\"</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">const</span> behaviours <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><br>  pressed<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><br>    color<span class=\"token operator\">:</span> <span class=\"token string\">\"var(--pressed-color, #777)\"</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">style</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> modifier<span class=\"token punctuation\">,</span> behaviour <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><br>  fontSize<span class=\"token operator\">:</span> <span class=\"token string\">\"1em\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Default Styles</span><br>  <span class=\"token operator\">...</span>modifiers<span class=\"token punctuation\">[</span>modifier<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Apply Modifiers</span><br>  <span class=\"token operator\">...</span>behaviours<span class=\"token punctuation\">[</span>behaviour<span class=\"token punctuation\">]</span> <span class=\"token comment\">// Apply Behaviours</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>This allows me to have additive states with a fairly flat and readable representation of each of the styles applied to each variation of a UI component.</p>\n<h2>Container components</h2>\n<p>The final type of component we need to distinguish is a container component. Many people might already have an understanding of what this means, but from a UI perspective, I'm not referring to any particular design pattern.</p>\n<p>From a UI perspective a container component is simply where the application logic is resolved down to a set of modifiers and behavioural keys that are passed to presentational and layout components.</p>\n<p>A container component:</p>\n<ul>\n<li>contains no presentation or layout styles</li>\n<li>should not render mark-up (except children)</li>\n<li>can wrap layout and presentational components</li>\n<li>may fetch data, setup events, refs etc...</li>\n<li>is where non-reusable code lives.</li>\n</ul>\n<h2>But it's only UI!</h2>\n<p>As the responsibilities of front-end developers have become more broad, some might consider the conventions outlined here to be not worth following. I've seen teams spend weeks planning the right combination of framework, build tools, workflows and patterns only to give zero consideration to the way they architect UI components. It's often considered the last step in the process and not worthy of the same level of consideration.</p>\n<p>It's important! I've seen well-planned project fail or go well over budget because the UI architecture was poorly planned and became un-maintainable as the project grew.</p>\n<p>This disappoints me because the problems are hard and my colleagues and friends who helped establish best practices in CSS are serious engineers, with broad skills, who applied knowledge across disciplines.</p>\n<p>Many of the ideas in CSS architecture predate CSS itself and have strong foundations in computer science and software architecture. I know developers who can understand complex architectural problems but fail to see the similarities, or worse yet, choose not to apply this knowledge to declarative front-end code.</p>\n<p>I know you can do it. To help, I've got some questions to ask yourself when planning UI components.</p>\n<h2>Questions to ask when planning UI components</h2>\n<ul>\n<li>How many UI states does this component have?</li>\n<li>Can I easily validate the current UI state?</li>\n<li>How ergonomic are my styles? (i.e. how quickly can someone else read them)</li>\n<li>Am I creating sensible UI abstractions? Or am I drawing boxes around the visual design?</li>\n<li>Am I separating layout form visual design where possible?</li>\n<li>Am I separating application logic from UI components?</li>\n<li>Am I communicating my intentions to other developers and giving semantic meaning to components.</li>\n</ul>\n<p>Keep practising this and you will build better lasting UIs.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/css-architecture-for-modern-web-applications/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Git from Beginner to Advanced",
    "partialText": "\r\n      <h2>Terminology</h2>\n<p>If you're familiar with basic Git terminology you might want to <a href=\"#heading-configuring-git\">skip ahead</a>.</p>\n<p>It took me a long time to get comfortable with Git. Perhaps because some of the terminology is a little strange but also, I think there is an assumption that everyone around you just gets it. They probably don't. The best developers I know still struggle with Git sometimes.</p>\n<p>I thought I'd take the time to cover:</p>\n<ul>\n<li><a href=\"#heading-key-terminology\">key terminology</a>,</li>\n<li><a href=\"#heading-install-and-set-up-git\">installation and set-up</a>,</li>\n<li><a href=\"#heading-getting-started\">get started</a> and</li>\n<li><a href=\"#heading-tips-and-tricks\">tips and tricks</a> that make working with Git easier.</li>\n</ul>\n<h3>What is Git?</h3>\n<p>Git is a version control system. It's one of many, but it's the most widely used by web developers. Version control helps manage changes to code. It's great for individual projects but becomes practically essential when working in teams.</p>\n<p>There are a few terms you will need to learn before you use Git:</p>\n<ul>\n<li><a href=\"#heading-repositories\">Repositories</a></li>\n<li><a href=\"#heading-branches\">Branches</a></li>\n<li><a href=\"#heading-commits\">Commits</a></li>\n</ul>\n<h3>Repositories</h3>\n<p>A repository represents the entire project. All of the project code along with any changes are stored in a <strong>repository</strong>. Your local copy of the repository doesn't necessarily contain every change. It may in-fact be missing large portions of code that are stored in other repositories. For example two developers working independently can each have changes in their local repository that the other is not aware of.</p>\n<p>To share changes we can <strong>push</strong> code to a remote repository and <strong>pull</strong> to get updates. By regularly synchronising with a centralised repository multiple developers can share work and manage changes.</p>\n<p>Git does not require a centralised remote repository, although this is the most common way of working with Git. Services like <strong>GitHub</strong> provide hosting for repositories as well as tools to help us review code and manage changes via <strong>pull requests</strong>.</p>\n<p>The initial step of copying an existing repository to your local file system is called <strong>cloning</strong>.</p>\n<h3>Branches</h3>\n<p>Git allows individuals to have their own copy of the code, or even multiple copies at the same time, each stored on a different <strong>branch</strong>. A branch typically contains a new feature or a significant change.</p>\n<p>You can <strong>checkout</strong> a branch at any time to work on it. This will update all the files in your local repository to reflect the selected branch.</p>\n<p>Git is clever and it only stores changes we make from the time we create a new branch. It remembers the base, (the point where the branch was <em>forked</em>) and saves the minimal amount of information required to represent that change. The ability to store only the differences from the previous version is central to Git.</p>\n<p>Branches are intended to eventually be merged back into the trunk. The trunk is just the main branch and it's typically called 'master'. You normally branch off master, but if you have a good reason, you can create a branch off any other branch.</p>\n<h3>Commits</h3>\n<p>A branch is made up of one or more sets of changes to files. We call these <strong>commits</strong>. If a branch represents a feature, a commit represents an implementation step. Each commit has an associated message and ideally this message should describe the step taken and perhaps more importantly why. Selecting files to be added to a commit is called <strong>staging</strong>.</p>\n<p>A good series of commit messages should read like steps in a recipe or a set of instructions. For example the commit messages for adding timestamps to posts on my <a href=\"/writing/\">Writing</a> page, might look something like this:</p>\n<ol>\n<li>Write tests for <code>formatDate</code> function</li>\n<li>Create <code>formatDate</code> function</li>\n<li>Add timestamps to articles using html <code>time</code> element</li>\n<li>Add CSS to style timestamps</li>\n</ol>\n<p><em>Truthful Disclaimer: On my personal blog, they usually do <strong>not</strong> look like this.</em></p>\n<p>That covers the main terminology, and if you can understand <code>repositories</code>, <code>branches</code>, <code>commits</code> as well as follow some of the other terms I've introduced here, then you are on your way to mastering Git.</p>\n<h2>Install and set-up Git</h2>\n<p>If you're new to Git one of the first things you need to decide is whether you'd prefer to use a graphical application or type commands in the terminal. There's no right answer here. I know plenty of skilled developers who prefer graphical applications as well as plenty of weekend hackers who get by just fine learning a few commands. Whatever you decide to use is fine.</p>\n<p>Personally, I use a combination of the command line and graphical tools within VSCode.</p>\n<h3>Command line</h3>\n<p>To install Git in the terminal first check, because you may already have it. Type <code>git --version</code>. Instructions here will assume you're running version 2 or later. If you don't have Git installed:</p>\n<p><strong>Mac:</strong></p>\n<pre><code>brew install git\n</code></pre>\n<p><strong>Ubuntu:</strong></p>\n<pre><code>sudo apt-get install git\n</code></pre>\n<p><strong>Windows:</strong></p>\n<p><em>In my experience the Windows version of Git is significantly slower. If you want to use a Git terminal in Windows, I strongly recommend setting up WSL and Ubuntu. To get started, download and install Ubuntu from the Windows Store. Once you have a Ubuntu terminal running in Windows you can follow instructions for Linux\\Ubuntu.</em></p>\n<p>If you absolutely must, you can download <a href=\"https://git-scm.com/download/win\">Git for Windows</a>.</p>\n<h3>Graphical applications</h3>\n<h4>VSCode</h4>\n<p>If you use <a href=\"https://code.visualstudio.com/\">VSCode</a> there are a number of built in tools in the source control pane. These allow you to diff files, stage changes, manage merge conflicts and even push, pull and execute more advanced commands without leaving the editor. I find the source control pane practically essential for dealing with merge conflicts. If you are after a simple GUI, this might be all you need.</p>\n<p>The source control pane makes use of a git terminal in the background Follow instructions above for installing a command line version of Git before running VSCode.</p>\n<p><em><strong>Note</strong>: At the time of writing VSCode source control pane will not work with WSL Git.</em></p>\n<img alt=\"Source control pane in VSCode\" src=\"/img/source-control.png\" style=\"max-width:100%;\">\n<h4>Plugins</h4>\n<p>On top of the built-in tools, the only plugin I recommend is <a href=\"https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens\">GitLens</a>. It adds a lot of features, but the one I enjoy most is, it un-obtrusively adds information to the text editor that shows when each line of code was changed and what the commit message was. This contextual information is brilliant when working on larger projects.</p>\n<h4>Other Git applications</h4>\n<p>There are a bunch of free and commercial Git clients. Free includes <a href=\"https://desktop.github.com/\">GitHub Desktop</a> as well as <a href=\"https://www.sourcetreeapp.com/\">Sourcetree</a>. On the commercial side I have friends that use <a href=\"https://www.git-tower.com\">Git Tower</a> and <a href=\"https://www.gitkraken.com/\">GitKraken</a> they both look good, but haven't used either of them.</p>\n<h2>Configuring Git</h2>\n<h3>Identity</h3>\n<p>After you install Git it's a good idea to add your user name and email address. This is important because every Git commit uses this information. To configure these in the terminal type:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config --global user.name <span class=\"token string\">\"Mike Riethmuller\"</span><br><span class=\"token function\">git</span> config --global user.email mike@madebymike.com.au</code></pre>\n<p>You can use your own name and email rather than mine. And you can change these settings for specific projects by removing the <code>--global</code> flag.</p>\n<p><strong>Note</strong>: If you don't want to share your email publicly, GitHub provides options to set up a private email address. Go to <a href=\"https://github.com/settings/emails\">https://github.com/settings/emails</a> and Select &quot;Keep my email address private&quot;. Then follow the instructions.</p>\n<h3>Credentials</h3>\n<p>If you are making a lot of changes and regularly pushing these to a remote repository, you will be prompted to enter a username and password. To avoid entering this every time you can use a git credential manager.</p>\n<p>To store credentials indefinitely on your hard drive:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config credential.helper store</code></pre>\n<p>To store credentials in memory for a short period of time:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config credential.helper cache</code></pre>\n<p>Hopefully I don't need to say it, but you should consider security before storing credentials.</p>\n<p>There are a number of other ways you can authenticate with a remote repository including SSH keys and third-party credential managers. I'm not going to cover them here.</p>\n<h3>Aliases</h3>\n<p>One of the first things I do on any new machine is set up a bunch of aliases for the commands I'll be using ever day: <code>status</code>, <code>checkout</code>, <code>branch</code> and <code>commit</code>. Aliases allow me to give a command an alternative name. <strong>I could not work without these</strong>.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config --global alias.s status<br><span class=\"token function\">git</span> config --global alias.co checkout<br><span class=\"token function\">git</span> config --global alias.br branch<br><span class=\"token function\">git</span> config --global alias.ci commit</code></pre>\n<p>You can set up your own aliases, but I recommend these. I use <code>git s</code> religiously. For some reason, I don't use an alias for <code>add</code> or <code>push</code>. I think <code>add</code> is short and simple to type and I find it satisfying to pound the letters P-U-S-H as I demonstrate my victory over the code.</p>\n<p>For even more aliases see the <a href=\"#heading-tips-and-tricks\">tips and tricks</a> at the end of this article.</p>\n<h2>Getting started</h2>\n<p>When working with an existing repository you need to clone it. Go to either GitHub, BitBucket, or some other hosted repository and copy the URL.</p>\n<img alt=\"GitHub clone URL form\" src=\"/img/github.jpg\" style=\"max-width:100%;\">\n<h3>Cloning</h3>\n<p>In the terminal, navigate to a directory, then type:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone https://github.com/MadeByMike/madebymike.madebymike.git</code></pre>\n<p>Use the URL for your project, not my blog, although feel free to clone it if you want.</p>\n<p>This will create a new directory for the project. If you want to clone into a existing directory you can add this after the URL. For example, adding <code>.</code> after the URL will clone it into the current directory.</p>\n<p>Once you have cloned your project it will be set-up to track the remote origin. This means when you <code>push git</code>, it knows where to send things.</p>\n<h3>Creating an empty Git repository</h3>\n<p>You don't need to do this when you clone, but sometimes you will start new project that doesn't have an existing repository. Using GitHub you can initialise a new repository via the UI and then clone it. Make sure you check the &quot;initialise this repository&quot; option.</p>\n<img alt=\"GitHub initialise this repository UI\" src=\"/img/github.jpg\" style=\"max-width:100%;\">\n<p>Once this is done you just clone the repository using the instructions above.</p>\n<p>However, if you have existing work, you probably want to initialise the repository locally. You do this by typing:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> init</code></pre>\n<p>If using a graphical application look for an initialise repository option.</p>\n<h3>Adding a remote repository</h3>\n<p>If you initialise a repository locally you probably want to add a remote origin sooner or later. The steps are a bit less intuitive.</p>\n<p>First create a new remote repository. For example, if using GitHub, follow the instructions above but <em>don't</em> select the option to &quot;initialise this repository&quot;. Once a remote repository has been created, you add the remote origin like this:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> remote <span class=\"token function\">add</span> origin https://github.com/MadeByMike/madebymike.madebymike.git</code></pre>\n<p>Now your local knows where to push and pull from you can sync with the remote repository as long as you have the correct permissions.</p>\n<h2>Important commands</h2>\n<p>By now you should have created a local repository using one of the methods above. The next step is to create a branch and add some commits.</p>\n<h3>Status</h3>\n<p>You will want to check <code>git status</code> often (very often) to see what files are staged, unstaged, and how many commits ahead of origin your local branch is. That's why we created a short <a href=\"#aliases\">alias</a>. Use:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> s</code></pre>\n<p>Or <code>git status</code> without the alias.</p>\n<h3>Branch</h3>\n<p>Before we start any work we should create a new branch. Working on master is not a good idea and almost any workplace will have processes that prevent this. Most work will be merged to master via a pull request. Working in branches is a good habit when working locally too.</p>\n<p>To create a branch we can use the <a href=\"#aliases\">alias</a> we set-up earlier.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> br name-of-branch</code></pre>\n<p>Or <code>git branch name-of-branch</code> if you don't have the alias.</p>\n<h3>Checkout a branch</h3>\n<p>After you create a branch don't forget to <code>checkout</code> before you start work.</p>\n<p>Using our alias:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> co name-of-branch</code></pre>\n<p>Or <code>git checkout name-of-branch</code>.</p>\n<h3>Staging files</h3>\n<p>Once you've edited some files you will want to add them to a commit. You can be clever and surgical to make sure you only stage the files and folders you want, but in truth, about 90% of the time I want to stage everything. I usually type:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span></code></pre>\n<p>If you want to stage specific files or folders you can add a path after <code>add</code>. For example <code>git add ./my-folder/</code> will stage files in <code>my-folder</code> only. You might do this so that your commits are smaller and more meaningful. In my opinion, it's easier, and a better habit to just commit more often. I like to only edit files I intend to go into the next commit and try to think just one stage ahead. It's hard, but it's a good habit.</p>\n<p>If you want to pluck individual files into different commits, the VSCode source control pane is how I usually do it. I find the visual editor better for these kind of tasks.</p>\n<h3>Unstaging files</h3>\n<p>Sometimes I will stage files I didn't intend. To unstage we use the command:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> reset ./path-to/file.js</code></pre>\n<p>I also find the VSCode source control pane handy for this.</p>\n<h3>Commit</h3>\n<p>Once staged, you add these files to a commit with the command:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> commit -m <span class=\"token string\">\"Add a useful commit message here\"</span></code></pre>\n<p>If you don't add a the <code>-m</code> parameter it's typical to end up in Vim. You can add a message here but this can be intimidating for new users. BTW to exit Vim press <code>Esc</code> to exit edit mode, then type <code>:q!</code> and start again.</p>\n<h3>Unstaging a commit</h3>\n<p>Sometimes I commit a set of changes before realising I've made a mistake or I commit files to the wrong branch. When this happens, the easiest way to fix it is to reset like this:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> reset HEAD~1</code></pre>\n<p>This tells Git to reset everything back to the previous commit. By default it will keep all your changes and just unstage them. Use <code>--hard</code> after the command if you want to reset and wipe everything back to the previous state. But be careful!</p>\n<p><strong>Note</strong>: If you have pushed and reset a commit after this, your history will be different from the remote. Try to avoid it, but if you need to fix a mistake like this you can force push <code>git push -f</code>.</p>\n<h3>Push</h3>\n<p>After each commit you want to push these to the remote repository. You do this with:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> push</code></pre>\n<h3>Merge</h3>\n<p>Once a branch is complete and ready to be merged you use the <code>merge</code> command. First checkout the branch to want to merge into (usually master). Then type:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> merge my-branch</code></pre>\n<p>Another way to merge changes is on the remote repository via <strong>pull requests</strong>. Pull requests can be reviewed by the team and merged to master on the remote. After this every one needs to pull to update their local copy of the master branch.</p>\n<h3>Pull</h3>\n<p>When the remote repository ends up ahead your local copy you need to pull.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> pull</code></pre>\n<p>This will fetch the latest code for the branch you are on as well as an index of any branches other developers have pushed to remote. Now you can now checkout their branches too.</p>\n<h3>Managing merge conflicts</h3>\n<p>Sometimes when you merge or pull you will end up with conflicts where 2 branches have modified the same files. If Git can't resolve this automatically it will ask you to resolve the conflict manually.</p>\n<p>The terminal will tell you which files have conflicts:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">></span> Auto-merging FILE-NAME.JS<br><span class=\"token operator\">></span> CONFLICT <span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span>: Merge conflict <span class=\"token keyword\">in</span> FILE-NAME.JS<br><span class=\"token operator\">></span> Automatic merge failed<span class=\"token punctuation\">;</span> fix conflicts and <span class=\"token keyword\">then</span> commit the result</code></pre>\n<p>You resolve these in your editor and stage the files when the conflicts have been removed. This is where a VSCode or a GUI are especially useful for highlighting the differences and allowing you to select the desired change.</p>\n<p>For larger merge conflicts use <code>git status</code> to see which files still need changes.</p>\n<p>When all your files have no conflicts you can stage them as usual using <code>git add</code> and <code>git commit</code> to complete the merge.</p>\n<p>There are not magic secrets for making merge conflicts easier. They can be terrible. Making smaller commits and syncing often helps avoid having them, which is the best strategy.</p>\n<h2>Tips and tricks</h2>\n<p>You should now have a grasp of the basic commands and a developing understanding of how git works. This is enough to be effective with git. The next section focuses on some more advanced commands and tricks that might help make working with Git a little easier.</p>\n<h3>Stash</h3>\n<p>Stash is good for when you want to quickly check out a different branch but are not ready to commit your current work. To quickly stash files, use the command:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> stash</code></pre>\n<p>You can now switch branches and work on something else and when you are ready to retrieve work from the stash run:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> stash pop</code></pre>\n<p>If you are like me, <code>git stash</code> is sometimes where things go to die. You can use <code>git stash list</code> to remember what you put there. And you can even add a message to any stash with <code>-m</code> just like a commit.</p>\n<p>You can then retrieve a specific stash with <code>git stash apply stash@{1}</code> where <code>stash@{1}</code> is the index from the list.</p>\n<h3>Checkout a file from another branch</h3>\n<p>Sometimes you want to checkout a specific file from another branch. Usually master, and usually to fix a mess. You can do that:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> co master ./path-to-file</code></pre>\n<p>This will replace the file on you current branch with what is on master.</p>\n<p>You can also replace the branch with a commit hash from <code>git log</code> to checkout a particular revision.</p>\n<h3>Create and checkout a branch in one step</h3>\n<p>Usually after creating a branch the first thing I do is to checkout and start working on it. I can do this in one step with the <code>-b</code> parameter.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> checkout -b name-of-branch</code></pre>\n<p>When I started I never remembered this so I aliased it to &quot;new&quot;: <code>git config --global alias.new checkout -b</code></p>\n<h3>List all aliases</h3>\n<p>Added a new alias but can't remember it yet?</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config --get-regexp <span class=\"token builtin class-name\">alias</span></code></pre>\n<h2>Advanced tips</h2>\n<p>This section has some even more advanced tips.</p>\n<h3>See which branches you've been working on recently</h3>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> for-each-ref --count<span class=\"token operator\">=</span><span class=\"token number\">10</span> --sort<span class=\"token operator\">=</span>-committerdate refs/heads/ --format<span class=\"token operator\">=</span><span class=\"token string\">\"%(refname:short)\"</span></code></pre>\n<p>I have to admit, I learnt this one from Harry Roberts but I use it all the time. I've also aliased this to <code>git recent</code> and you should too. Read the rest of <a href=\"https://csswizardry.com/2017/05/little-things-i-like-to-do-with-git/\">Harry's git tricks</a>.</p>\n<h3>Delete merged branches</h3>\n<p>On larger projects eventually you end up with a lot of local branches. If you automatically delete branches on remote after merging you can run:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> fetch --prune</code></pre>\n<p>This will delete local branches that have been deleted on remote.</p>\n<p>This next one is not so much a Git command as a <code>bash</code> command - sorry Window users (use WSL).</p>\n<p>If your remote branches are not tidy or you just have a local mess, the following command will find all branches merged into the current branch, and delete them:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> branch --merged <span class=\"token operator\">|</span><br><span class=\"token function\">grep</span> -v <span class=\"token string\">\"\\*\"</span> <span class=\"token operator\">|</span><br><span class=\"token function\">grep</span> -v <span class=\"token string\">\"master\"</span> <span class=\"token operator\">></span>/tmp/merged <span class=\"token operator\">&amp;&amp;</span><br><span class=\"token function\">nano</span> /tmp/merged <span class=\"token operator\">&amp;&amp;</span><br><span class=\"token function\">cat</span> /tmp/merged <span class=\"token operator\">|</span><br><span class=\"token function\">xargs</span> -n <span class=\"token number\">1</span> <span class=\"token function\">git</span> branch -d</code></pre>\n<p>It's a little long because it tries to be safe. It will always exclude master and allow you to edit the list of branches in <code>nano</code> first. Delete any you don't want removed.</p>\n<h2>Git actions are reversible</h2>\n<p>I've always wielded Git with a healthy dose of fear and trepidation. It can be quite intimidating, but I've come to realise, it's actually hard to break anything with Git. Almost every change is reversible, but figuring out how is often the hard part.</p>\n<p>Remember you can always <code>reset</code>. Good luck :).</p>\n<h3>Resources</h3>\n<ul>\n<li><a href=\"https://gist.github.com/MadeByMike/5993a985c7efcfe34858369a79e3d283\">My Git Aliases</a></li>\n</ul>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/how-to-git/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Getting the heck out of React",
    "partialText": "\r\n      <p>One of the biggest advantages of React is that we need to worry less about managing updates to the UI. The presentation is defined once within the <code>render()</code> method of a component and it will update automatically when data changes.</p>\n<p>The <code>render()</code> method returns elements via <code>JSX</code> that instruct React to update the DOM. This is the strength of React because it can manage updates to the DOM more efficiently than I would, and <code>JSX</code> provides a declarative means of describing a component structure, much like HTML.</p>\n<p>There is however, one key assumption in all of this and that is that updating data should result in updates to the DOM. This assumption is central to the React component lifecycle, and in-fact the render method is the only required method of a React component. That's a pretty core assumption, and as a result accessing the DOM node of a React rendered element, is not always straight-forward.</p>\n<p>Typically DOM manipulation outside the render method is discouraged, but there are some elements in HTML that are not quite as descriptive when it comes to updates. Examples of these include elements like <code>&lt;video&gt;</code> and <code>&lt;canvas&gt;</code>. Updating these usually requires calling a native method to clear the canvas, or to pause video playback. To interact with these native methods we need to get a reference to the element in the DOM and for this React has refs.</p>\n<h2>Accessing the DOM in React</h2>\n<p>Refs, as the name implies, provide us with a reference to an element in the DOM. We can access this only after React has rendered the element.</p>\n<p>Methods for creating and retrieving refs have changed between React versions with backward compatibility, so you might see other techniques used in the wild. Here I am using the <code>createRef()</code> method introduced in React 16.3.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CanvasComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myCanvas <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myCanvas<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2d\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>canvas ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myCanvas<span class=\"token punctuation\">}</span> width<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">100</span><span class=\"token punctuation\">}</span> height<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">100</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>In this example I create a ref named <code>myCanvas</code> in the <code>constructor()</code>, attact it to the component in the <code>render()</code> method, and then access it after the component has mounted, where I can finally draw to the HTML canvas.</p>\n<p>This technique works well enough if I only need draw once, but for more complex examples, we're going to run into problems. React is calling the render method constantly, but because it is clever, it's recycling the DOM elements rather than re-building it each time. This is great because we want the canvas to be persistent. However changes to the surrounding HTML, and particularly higher up the document tree, can result in re-building parts of the DOM. If you'd like to know more about why and when React re-builds the DOM, I'd suggest reading the <a href=\"https://reactjs.org/docs/reconciliation.html\">React documentation on reconciliation</a>.</p>\n<h2>Working with stateful media objects</h2>\n<p>Take a look at this example of a random &quot;Rainbow Walker&quot;:</p>\n<div class=\"live-demo\">\n  <iframe src=\"/demos/getting-out-of-react/rainbow-walker-1.html\" style=\"height:300px; width:100%; border: none;\"></iframe>\n  <a href=\"https://codepen.io/MadeByMike/pen/c795e7e7eb0a542a64739d7a1cb485a0/\" class=\"open-in-codepen\">Open in CodePen</a>\n</div>\n<p>It looks great, but &quot;information&quot; is stored directly on the canvas. Each <code>tick</code> of the animation draws a new part of the line and the previous position and color information is lost. The cumulative result of this drawing procedure is stored on the canvas for as long as the canvas exists, but if React creates a new element, this information is lost forever. This is one of the challenges of working with persistent and stateful media objects in React.</p>\n<p>Take a look at this updated example and click the wrap\\unwrap button to see what happens:</p>\n<div class=\"live-demo\">\n  <iframe src=\"/demos/getting-out-of-react/rainbow-walker-2.html\" style=\"height:400px; width:100%; border: none;\"></iframe>\n  <a href=\"https://codepen.io/MadeByMike/pen/e8ec1be6a6c4cd28212473074e6b4607/\" class=\"open-in-codepen\">Open in CodePen</a>\n</div>\n<p>All the button does is change the <code>render()</code> method to wrap the <code>&lt;canvas&gt;</code> in an extra <code>&lt;div&gt;</code>. This is something that can happen frequently with larger applications and it's not always easy to avoid. Wrapping an element is one of many things that can cause parts of the DOM to be re-drawn.</p>\n<p>It's worth noting that the current position of the walker is not reset when clicking the wrap\\unwrap button. That's because the component itself is not unmounted when its output changes. However, it's not always easy to avoid unmounting components either. Logically we try to split components into smaller chunks and once again the sorrounding layout can change. Take a look at this example of a canvas clock:</p>\n<div class=\"live-demo\">\n  <iframe src=\"/demos/getting-out-of-react/timer-1.html\" style=\"height:170px; width:100%; border: none;\"></iframe>\n  <a href=\"https://codepen.io/MadeByMike/pen/5c3293dade22de7d823741c8241950b3/\" class=\"open-in-codepen\">Open in CodePen</a>\n</div>\n<p>Here I've split the logic for the clock and the layout between two different components. When the layout surrounding the clock changes the component is re-mounted. In addition to a new <code>canvas</code>, data in state is lost and the counter is reset to 0. You will also see a noticeable flash as the canvas is re-initialised. For elements like <code>canvas</code> this is much more expensive than re-drawing a typical DOM node. This is especially true if we need to re-initialise a 3rd-party library as well.</p>\n<h2>Imperative &amp; declarative APIs</h2>\n<p>It's not just <code>canvas</code>, these issues exist for <code>video</code> and other media, as well as 3rd-party libraries for things like data visualisation, mapping and charts. The problem is that libraries like D3.js, three.js, mapbox and whatever the hottest chart library is right now, have imperative APIs. This typically means that there is a single object that represents an entity on the page and we invoke actions directly on it. For example with Mapbox after creating a new map, we call methods like <code>flyTo()</code> to trigger actions. E.g.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> map <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">mapboxgl<span class=\"token punctuation\">.</span>Map</span><span class=\"token punctuation\">(</span>mapboxOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>map<span class=\"token punctuation\">.</span><span class=\"token function\">flyTo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> center<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> zoom<span class=\"token operator\">:</span> <span class=\"token number\">9</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>This approach is very different from HTML or JSX that have a more declarative API. With a declarative API it's more descriptive. We update the description of the map with new properties and the library resolves these changes into a set of actions required to update the map.</p>\n<p>Animations or any action that occurs over time can be difficult to describe using a declarative API. This is because declarative components don't typically have a persistent state. Think about how animations work in CSS. New animations can be triggered by the addition of a classname but these properties will reset the existing animation, causing it to start from its initial state.</p>\n<p>Despite this, I see numerous attempts to &quot;solve&quot; the challenges of working with stateful media in React by creating libraries that convert imperative APIs into a set of declarative React components. They do this by wrapping another layer of abstraction around 3rd-party tools and native APIs.</p>\n<p>The <a href=\"https://github.com/uber/react-map-gl\">react-map-gl</a> library has more than 4000 stars. This recreation of the HTML5 canvas API <a href=\"https://github.com/konvajs/react-konva\">react-konva</a> has more than 2000. The <a href=\"https://github.com/codesuki/react-d3-components\">react-d3-components</a> library has over 1400 and there are many more like these.</p>\n<p>To me these are the jQuery plugins of this era. They all provide limited on-rails solutions that serve to comfort developers with a React mindset. Perhaps the only advantage is that the better-designed examples of these allow developers to continue splitting logic into smaller components.</p>\n<h2>Escaping React</h2>\n<p>Often a <code>&lt;canvas&gt;</code>, <code>&lt;video&gt;</code>, or chart container will be the lowest level item in the DOM that React is aware of. Therefore the React component that mounts these can become bloated with all the custom methods, events and other logic that controls the embedded object.</p>\n<p>I don't think the solution is to try and envelope everything into React. Although declarative APIs can be amazingly succinct and performant they are not the solution to everything. I also think that trying to map an existing imperative API to a set of React components going to result in something less than the original.</p>\n<p>My solution is to get the heck out of React when I need to and find a way to make these things work together. Let's take a look at an example of an HTML <code>&lt;video&gt;</code> element and a solution that avoids:</p>\n<ul>\n<li>clearing stateful data (such as the video source and play state) when React re-renders,</li>\n<li>methods and actions restricted to a single component</li>\n</ul>\n<p><strong>Note:</strong> In this example, I'm using es6 imports to demonstrate how elements, functions and components can be shared between files.</p>\n<p>In one file I create a component with a ref similar to the first example.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">const</span> videoElement <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"video\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">class</span> <span class=\"token class-name\">Video</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myVideoContainer <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myVideoContainer<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>videoElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myVideoContainer<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> videoElement<span class=\"token punctuation\">,</span> Video <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Instead of attaching it to a canvas or video element, the ref is attached to an empty <code>&lt;div&gt;</code> container. The video element is a detached DOM node that exists outside the component. I append this to the container once the React component is mounted.</p>\n<p>Because the video element exists outside a React component, even if React re-renders the container, or unmounts the component, the video will be re-mounted without losing its source, play state, or any other data.</p>\n<p>We're exporting the <code>videoElement</code> so we can access it in different components. I can now create a load button that applies a video source to the element:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> videoElement <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./video\"</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">class</span> <span class=\"token class-name\">LoadButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><br>      <span class=\"token operator\">&lt;</span>button<br>        onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>          <span class=\"token comment\">//  Thank you MDN for the video source!</span><br>          videoElement<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span><br>            <span class=\"token string\">\"https://interactive-examples.mdn.mozilla.net/media/examples/flower.mp4\"</span><span class=\"token punctuation\">;</span><br>        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><br>      <span class=\"token operator\">></span><br>        Load<br>      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><br>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> LoadButton <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n<p>As well as a play button:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> videoElement <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./video\"</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">class</span> <span class=\"token class-name\">PlayButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><br>      <span class=\"token operator\">&lt;</span>button<br>        onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>          videoElement<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><br>      <span class=\"token operator\">></span><br>        Play<br>      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><br>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> PlayButton <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n<p>I can even create custom functions that extend the native <code>&lt;video&gt;</code> element. Here I've added a method to inverts colours by toggling a classname:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> videoElement <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./video\"</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">function</span> <span class=\"token function\">invertVideo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  videoElement<span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">toggle</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"invert\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token keyword\">class</span> <span class=\"token class-name\">InvertButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><br>      <span class=\"token operator\">&lt;</span>button<br>        onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>          <span class=\"token function\">invertVideo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><br>      <span class=\"token operator\">></span><br>        Invert<br>      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><br>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> InvertButton <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n<p>In a real application, functions like <code>invertVideo()</code> might not be tied to a single UI element such as in this example. A function that clears data on a map, for example, might be triggered by multiple UI actions. In cases like this, it makes more sense to import functions rather than co-locating them with the UI components.</p>\n<p>Either way, the ability to split this code and organise it in different ways is a huge win compared with a massive React component and some of the techniques used to pass imperative actions —like that of a play button— between independent components.</p>\n<p>You can check out a full demo here:</p>\n<div class=\"live-demo\">\n  <iframe src=\"/demos/getting-out-of-react/video/\" style=\"height:345px; width:100%; border: none;\"></iframe>\n  <a class=\"open-code-sandbox\" href=\"https://codesandbox.io/s/n9zp6yry7p\">\n  Edit in CodeSandbox\n  </a>\n</div>\n<p><strong>Note</strong>: By importing the <code>videoElement</code> we're creating an implicit link between components.</p>\n<p>Ideally, React components are dumb and fully reusable. I wanted to show the simplest example first, but also practically speaking, I think this technique is sufficient for many applications. Most importantly it's not difficult to refactor if you need greater flexibility or multiple instances of components later.</p>\n<h2>Multiple instances</h2>\n<p>The examples above deal with a single instance of a media element. If we needed a 2nd video, we'd have to create a 2nd component along with a 2nd play button, load button etc...</p>\n<p>Despite its limitations, if you can get away with it, I think a single entity is a lot easier to work with, but there are problems when we have multiple instances.</p>\n<p>If you pass the <code>videoElement</code> as a prop a lot of the problems can be solved. However, if we are going to re-structure components to be more reusable, rather than just passing the DOM element, it might help to organise some of the functions and exports into methods and properties within a class.</p>\n<p>There are several different patterns you could use. What's best depends on your particular project. This is an example I created for the canvas clock:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Counter</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>element <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"canvas\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2d\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span><br><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span>font <span class=\"token operator\">=</span> <span class=\"token string\">\"40px Georgia, serif\"</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span>textAlign <span class=\"token operator\">=</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span>textBaseline <span class=\"token operator\">=</span> <span class=\"token string\">\"middle\"</span><span class=\"token punctuation\">;</span><br><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>counter <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span><br><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>step <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">step</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>step<span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">step</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>counter <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>counter <span class=\"token operator\">&lt;</span> <span class=\"token number\">99</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>counter <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">\"white\"</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>With this generic class, we create an instance of <code>Counter</code> for each clock, I then pass the instance as a parameter to the <code>&lt;Clock/&gt;</code> and <code>&lt;StopButton/&gt;</code> components.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Clock <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./clock\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> StopButton <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./stop-button\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Counter <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./counter'</span><br><br><span class=\"token keyword\">const</span> clockA <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">const</span> clockB <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br><span class=\"token operator\">&lt;</span>Clock counter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>clockA<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><br><span class=\"token operator\">&lt;</span>StopButton counter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>clockA<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><br><span class=\"token operator\">&lt;</span>Clock counter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>clockA<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><br><span class=\"token operator\">&lt;</span>StopButton counter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>clockA<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></code></pre>\n<p>In the <code>&lt;Clock/&gt;</code> and <code>&lt;StopButton/&gt;</code> components we can retrieve the DOM element and access methods via the <code>counter</code> prop:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Clock</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myClockContainer <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myClockContainer<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myClockContainer<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Once again you can see a full example here:</p>\n<div class=\"live-demo\">\n  <iframe src=\"/demos/getting-out-of-react/too-many-clocks/\" style=\"height:190px; width:100%; border: none;\"></iframe>\n  <a class=\"open-code-sandbox\" href=\"https://codesandbox.io/s/y06pjpo0lx\">\n  Edit in CodeSandbox\n  </a>\n</div>\n<h2>Sharing data</h2>\n<p>The final challenge we have is sharing data between React and the media elements. Many of these have internal state and retrieving this is often as easy as calling a method. For example to get the current play time of a video we can import the element and query the <code>currentTime</code> property:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> videoElement <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./video\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">const</span> time <span class=\"token operator\">=</span> videoElement<span class=\"token punctuation\">.</span>currentTime<span class=\"token punctuation\">;</span></code></pre>\n<p>This is adequate in many cases, but React is not going to re-render when the <code>currentTime</code> changes. We need to communicate relevant internal state changes to React. The video element has a <code>timeupdate</code> event. We can import the element and listen for <code>timeupdate</code>, then set state within React.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> videoElement <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./video\"</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">class</span> <span class=\"token class-name\">VideoTimer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> time<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>setTime <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setTime</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">setTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> time<span class=\"token operator\">:</span> videoElement<span class=\"token punctuation\">.</span>currentTime <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    videoElement<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"timeupdate\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>setTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    videoElement<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"timeupdate\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>setTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><br>  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>There are situations where we want to keep large amounts of data in-sync. We can call imperative actions on media elements and listen for events within React components, and this is adequate for things like a video play button, a timer, or a simple <code>flyTo()</code> action on a map, but examples can easily become more complex than this.</p>\n<p>Consider a search and filtering interface that updates the application UI, then triggers a map to <code>zoomTo</code> and fit the bounds of filtered items.</p>\n<p>Here there are numerous state changes, computations and derived actions that need to be triggered on the map. It's not clear which component should be responsible for listening to updates and triggering imperative actions on the map.</p>\n<p>In these situations, it helps to use some kind of store for state management. With this, we can share state between React and the media element. You can use <a href=\"https://redux.js.org/introduction\">Redux</a> if you are familiar with it, or if you want a recommendation I've been enjoying <a href=\"https://github.com/developit/unistore\">Unistore</a> recently. It doesn't matter what you use as long as you can subscribe to state changes and imperatively get the state from the store.</p>\n<p>There are two different approaches we can use. With canvas animations, games, and libraries like Three.js or D3.js you might want to implement a render loop. A render loop will run periodically (usually several times a second) and we can fetch state from the store and call an update method.</p>\n<p>A very simple example of a render loop looks something like this:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> store <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./store\"</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">function</span> <span class=\"token function\">loop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br>  <span class=\"token comment\">// Do updates</span><br>  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>loop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>loop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>This approach is constantly calling <code>loop()</code> using <code>requestAnimationFrame()</code>. It then gets state from the store and applies updates on every frame.</p>\n<p>The other approach is to subscribe to the store and call update only when the store changes.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> store <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./store\"</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">function</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token comment\">// Do updates</span><br><span class=\"token punctuation\">}</span><br><br>store<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>update<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>With both these examples, it is possible to call <code>store.setState()</code> or dispatch actions and have React components respond to data changes initiated by the media element.</p>\n<p>Here's an example of a map application that shares data between media elements, UI components within React:</p>\n<div class=\"live-demo\">\n  <iframe src=\"/demos/getting-out-of-react/map/\" style=\"height:500px; width:100%; border: none;\"></iframe>\n  <a class=\"open-code-sandbox\" href=\"https://codesandbox.io/s/2x6xwz6k2n\">\n  Edit in CodeSandbox\n  </a>\n</div>\n<p>I really like this approach because we can have two highly separate applications that work largely independently yet share the same data source. In theory, it's not necessary to mount the map into a React application. It could just as easily be mounted by a different framework or plain old JavaScript. This makes things much more portable and easy to test.</p>\n<p>If you find working with canvas, video and 3rd-party libraries like D3.js, three.js, or mapbox difficult within React, I hope this has helped you understand some of the reasons, as well as some possible solutions.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/getting-the-heck-out-of-react/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "What is this in JavaScript?",
    "partialText": "\r\n      <p>Like many things, the <code>this</code> keyword in JavaScript is something I learned to work with and around, long before I gained any proper understanding of how it works. Recently I was asked to describe it and found despite my experience I still strugled to find simple terms. So I thought I'd write down my best attempt.</p>\n<p>There is a special keyword in JavaScript called <code>this</code>. It is a reference to an object. This reference is sometimes called a <code>binding</code> because it ties the value of <code>this</code> to a specific object. What object, and the value of <code>this</code>, depends on how and where the function is called.</p>\n<p>The default value of <code>this</code> is the <code>window</code> object in browsers or <code>undefined</code> when in strict mode.</p>\n<p>We can explicitly set what <code>this</code> points by executing functions with methods like <code>call</code>, <code>bind</code> and <code>apply</code>.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">myFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token function\">myFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// window</span><br><span class=\"token keyword\">var</span> myBinding <span class=\"token operator\">=</span> <span class=\"token function\">myFunction</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// .bind() returns a new function</span><br><span class=\"token function\">myBinding</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'hello'</span><br><span class=\"token function\">myFunction</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'hello'</span><br><span class=\"token function\">myFunction</span><span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'hello'</span></code></pre>\n<p>What confuses me sometimes is JavaScript will implicity bind <code>this</code> if the function is called within a context owning object. This means when a function is a property of a context owning object, the value of <code>this</code> will be the object itself. In the example below the owning object, and therfore value of <code>this</code> is <code>myObject</code>:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">myFunc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>greeting<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token keyword\">var</span> myObject <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><br>  greeting<span class=\"token operator\">:</span> <span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span><br>  <span class=\"token keyword\">function</span><span class=\"token operator\">:</span> myFunc<br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br><br>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>myObject<span class=\"token punctuation\">.</span><span class=\"token function\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'hello'</span></code></pre>\n<p>Calling a function with the keyword <code>new</code> will result in a new empty object bound to <code>this</code>.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">myFunc</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">something</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>thing <span class=\"token operator\">=</span> something<span class=\"token punctuation\">;</span><br>  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>thing<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">myFunc</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"something\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>This has been a very short introduction that covers only basic information. If you want to know more I was inspired to attempt my own explaination after reading Willian Martins, <a href=\"https://www.smashingmagazine.com/2018/10/taming-this-javascript-bind-operator/\">Taming this In JavaScript With Bind Operator</a> . I could also not write about <code>this</code> without recommending Kyle Simpson's explaination in <a href=\"https://github.com/getify/You-Dont-Know-JS/blob/master/this%20%26%20object%20prototypes/ch2.md\">You Don't Know JavaScript</a>, especially the <a href=\"https://github.com/getify/You-Dont-Know-JS/blob/master/this%20%26%20object%20prototypes/ch2.md#review-tldr\">TLDR</a>.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/this-in-javascript/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "The Difference Between currentColor & Custom Properties",
    "partialText": "\r\n      <p>A friend was trying to set a theme on a container and have it apply a color to the border of a heading, and the body text. Something like this:</p>\n<div class=\"live-demo\">\n  <img alt=\"A black heading with a blue border and blue paragraphs below\" src=\"/img/custom-props.png\">\n</div>\n<p>She wanted to keep it simple with minimal CSS and ideally set the theme by applying just a single class in the HTML.</p>\n<p>Since we wanted to change the color of more than just paragraphs in the body text, it made sense to start by setting the <code>color</code> property on a container element. This would allow all elements inside the container to inherit the theme color and we could just set the headings back to black.</p>\n<p>Since we wanted to set the color in just one place, I suggested we set the value of <code>border-color</code> on the headings to inherit. This would cause the heading element to have the same value for <code>border-color</code> as its parent element. To my initial surprise the color of the border was black.</p>\n<p>My CSS was something like this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.theme</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #2378a3<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">.theme-heading</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> black<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">border-color</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Since there is no <code>border-color</code> set on the <code>.theme</code> class, the default value is used. The default for <code>border-color</code> is <code>currentColor</code>, and in the context of <code>.theme</code>, the value of <code>currentColor</code> in this example is <code>#2378a3</code>. This is the value I expected <code>.theme-heading</code> to inherit.</p>\n<p>You might be wondering, as I was, what exactly is happening? The answer is, it’s not a bug, and it’s still inheriting from the parent element. It turns out, when we inherit <code>currentColor</code> we are not retrieving the resolved value of that property from the parent. Instead we are inheriting the keyword itself, and the computed value will be resolved in the local context. And, therefore in this example the border color will be black.</p>\n<p>The solution is of course to set the value of the <code>border-color</code> as well as <code>color</code> in the <code>.theme</code> selector:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.theme</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #2378a3<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">border-color</span><span class=\"token punctuation\">:</span> #2378a3<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">.theme-heading</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> black<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">border-color</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Now we are no longer inheriting a dynamic property and the border color will be <code>#2378a3</code> as expected. And we are still setting the color values only on the <code>.theme</code> class.</p>\n<p>Maybe this is what you expected. Perhaps the reason I didn’t, is that I’ve been working with custom properties a lot recently, and although they are both dynamic, custom properties will not work like <code>currentColor</code> in the same situation.</p>\n<p>An equivalent example with custom properties would look something like this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.theme</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--theme-color</span><span class=\"token punctuation\">:</span> #2378a3<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--theme-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">border-color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--theme-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">.theme-heading</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--theme-color</span><span class=\"token punctuation\">:</span> black<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--theme-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">border-color</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>In this situation the <code>border-color</code> of <code>.theme-heading</code> is inheriting the <code>--theme-color</code> custom property from the parent element. Yet even though the value of <code>--theme-color</code> is set locally to black, its border-color will not use this local value in the same way <code>currentColor</code> did.</p>\n<p>Inheriting a value set by a custom property will always match the resolved value from the parent.</p>\n<p><strong>Note</strong>: The <code>color</code> property in this example will take the local value, because it is not inherited.</p>\n<p>The key difference here is: The <code>currentColor</code> keyword is not resolved at computed-value time, but is a reference to the used value of the local <code>color</code> property.</p>\n<p>Since learning about custom properties, I'd started to think of <code>currentColor</code> as a dynamic property in a very similar to custom properties. It turns out there are some fundamental differences that have real implications that we should be aware of. And again, this example highlights how different custom properties are from variables in preprocessors.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/currentcolor-and-custom-properties/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "A Strategy Guide To CSS Custom Properties",
    "partialText": "\r\n      <p><strong>This article was first published on: <a href=\"https://www.smashingmagazine.com/2018/05/css-custom-properties-strategy-guide/\">Smashing Magazine</a>.</strong></p>\n<p>CSS Custom Properties (sometimes known as ‘CSS variables’) are now supported in all modern browsers, and people are starting to use them in production. This is great, but they’re different from variables in preprocessors, and I’ve already seen many examples of people using them without considering what advantages they offer.</p>\n<p>Custom properties have a huge potential to change how we write and structure CSS and to a lesser extent, how we use JavaScript to interact with UI components. I’m not going to focus on the syntax and how they work (for that I recommend you read “<a href=\"https://www.smashingmagazine.com/2017/04/start-using-css-custom-properties/\">It’s Time To Start Using Custom Properties</a>”). Instead, I want to take a deeper look at strategies for getting the most out of CSS Custom Properties.</p>\n<h3>How Are They Similar To Variables In Preprocessors?</h3>\n<p>Custom Properties are a little bit like variables in preprocessors but have some important differences. The first and most obvious difference is the syntax.</p>\n<p>With <code>SCSS</code> we use a dollar symbol to denote a variable:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token property\"><span class=\"token variable\">$smashing-red</span></span><span class=\"token punctuation\">:</span> #d33a2c<span class=\"token punctuation\">;</span></code></pre>\n<p>In Less we use an <code>@</code> symbol:</p>\n<pre class=\"language-less\"><code class=\"language-less\"><span class=\"token variable\">@smashing-red<span class=\"token punctuation\">:</span></span> #d33a2c<span class=\"token punctuation\">;</span></code></pre>\n<p>Custom properties follow a similar conventions and use a <code>--</code> prefix:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--smashing-red</span><span class=\"token punctuation\">:</span> #d33a2c<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.smashing-text </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--smashing-red<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>One important difference between custom properties and variables in preprocessors is that custom properties have a different syntax for assigning a value and retrieving that value. When retrieving the value of a custom property we use the <code>var()</code> function.</p>\n<p>The next most obvious difference is in the name. They are called ‘custom properties’ because they really are CSS properties. In preprocessors, you can declare and use variables almost anywhere, including outside declaration blocks, in media rules, or even as part of a selector.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token property\"><span class=\"token variable\">$breakpoint</span></span><span class=\"token punctuation\">:</span> 800px<span class=\"token punctuation\">;</span><br><span class=\"token property\"><span class=\"token variable\">$smashing-red</span></span><span class=\"token punctuation\">:</span> #d33a2c<span class=\"token punctuation\">;</span><br><span class=\"token property\"><span class=\"token variable\">$smashing-things</span></span><span class=\"token punctuation\">:</span> <span class=\"token string\">\".smashing-text, .cats\"</span><span class=\"token punctuation\">;</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$breakpoint</span><span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\"><span class=\"token variable\">#{$smashing-things}</span> </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$smashing-red</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Most of the examples above would be invalid using custom properties.</p>\n<p>Custom properties have the same rules about where they can be used as normal CSS properties. It’s far better to think of them as dynamic properties than variables. That means they can only be used inside a declaration block, or in other words, custom properties are tied to a selector. This can be the <code>:root</code> selector, or any other valid selector.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--smashing-red</span><span class=\"token punctuation\">:</span> #d33a2c<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 800px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.smashing-text,<br>  .cats </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\">--margin-left</span><span class=\"token punctuation\">:</span> 1em<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>You can retrieve the value of a custom property anywhere you would otherwise use a value in a property declaration. This means they can be used as a single value, as part of a shorthand statement or even inside <code>calc()</code> equations.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.smashing-text,<br>.cats </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--smashing-red<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0 <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--margin-horizontal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--margin-horizontal<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> 2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>However, they cannot be used in media queries, or selectors including <code>:nth-child()</code>.</p>\n<p>There is probably a lot more you want to know about the syntax and how custom properties work, such as how to use fallback values and can you assign variables to other variables (yes), but this basic introduction should be enough to understand the rest of the concepts in this article. For more information on the specifics of how custom properties work, you can read “<a href=\"https://www.smashingmagazine.com/2017/04/start-using-css-custom-properties/\">It’s Time To Start Using Custom Properties</a>” written by Serg Hospodarets.</p>\n<h3>Dynamic vs. Static</h3>\n<p>Cosmetic differences aside, the most significant difference between variables in preprocessors and custom properties is how they are scoped. We can refer to variables as either statically or dynamically scoped. Variables in preprocessors are static, whereas custom properties are dynamic.</p>\n<p>Where CSS is concerned, static means that you can update the value of a variable at different points in the compilation process, but this cannot change the value of the code that came before it.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token property\"><span class=\"token variable\">$background</span></span><span class=\"token punctuation\">:</span> blue<span class=\"token punctuation\">;</span><br><span class=\"token selector\">.blue </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$background</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token property\"><span class=\"token variable\">$background</span></span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span><br><span class=\"token selector\">.red </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$background</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>results in:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.blue </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> blue<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.red </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Once this is rendered to CSS, the variables are gone. This means that we could potentially read an <code>.scss</code> file and determine its output without knowing anything about the HTML, browser or other inputs. This is not the case with custom properties.</p>\n<p>Preprocessors do have a kind of “block scope” where variables can be temporarily changed inside a selector, function or mixin. This changes the value of a variable inside the block, but it’s still static. This is tied to the block, not the selector. In the example below, the variable <code>$background</code> is changed inside the <code>.example</code> block. It changes back to the initial value outside the block, even if we use the same selector.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token property\"><span class=\"token variable\">$background</span></span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span><br><span class=\"token selector\">.example </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\"><span class=\"token variable\">$background</span></span><span class=\"token punctuation\">:</span> blue<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$background</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">.example </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$background</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>This will result in:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.example </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> blue<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.example </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Custom properties work differently. Where custom properties are concerned, dynamically scoped means they are subject to inheritance and the cascade. The property is tied to a selector and if the value changes, this affects all matching DOM elements just like any other CSS property.</p>\n<p>This is great because you can change the value of a custom property inside a media query, with a pseudo selector such as hover, or even with JavaScript.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">a </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--link-color</span><span class=\"token punctuation\">:</span> black<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">a:hover,<br>a:focus </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--link-color</span><span class=\"token punctuation\">:</span> tomato<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 600px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">a </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\">--link-color</span><span class=\"token punctuation\">:</span> blue<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">a </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--link-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>We don’t have to change where the custom property is used — we change the value of the custom property with CSS. This means using the same custom property, we can have different values in different places or context on the same page.</p>\n<h3>Global vs. Local</h3>\n<p>In addition to being static or dynamic, variables can also be either global or local. If you write JavaScript, you will be familiar with this. Variables can either be applied to everything inside an application, or their scope can be limited to specific functions or blocks of code.</p>\n<p>CSS is similar. We have some things that are applied globally and some things that are more local. Brand colors, vertical spacing, and typography are all examples of things you might want to be applied globally and consistently across your website or application. We also have local things. For example, a button component might have a small and large variant. You wouldn’t want the sizes from these buttons to be applied to all input elements or even every element on the page.</p>\n<p>This is something we are familiar with in CSS. We’ve developed design systems, naming conventions and JavaScript libraries, all to help with isolating local components and global design elements. Custom properties provide new options for dealing with this old problem.</p>\n<p>CSS Custom Properties are by default locally scoped to the specific selectors we apply them to. So they are kinda like local variables. However, custom properties are also inherited, so in many situations they behave like global variables — especially when applied to the <code>:root</code> selector. This means that we need to be thoughtful about how to use them.</p>\n<p>So many examples show custom properties being applied to the <code>:root</code> element and although, this is fine for a demo, it can result in a messy global scope and unintended issues with inheritance. Luckily, we’ve already learned these lessons.</p>\n<h4>Global Variables Tend To Be Static</h4>\n<p>There are a few small exceptions, but generally speaking, most global things in CSS are also static.</p>\n<p>Global variables like brand colors, typography and spacing don't tend to change much from one component to the next. When they do change, this tends to be a global rebranding or some other significant change that rarely happens on a mature product. It still makes sense for these things to be variables, they are used in many places, and variables help with consistency. But it doesn’t make sense for them to be dynamic. The value of these variables does not change in any dynamic way.</p>\n<p>For this reason, <strong>I strongly recommend using preprocessors for global (static) variables.</strong> This not only ensures that they are always static, but it visually denotes them within the code. This can make CSS a whole lot more readable and easier to maintain.</p>\n<h4>Local Static Variables Are OK (Sometimes)</h4>\n<p>You might think given the strong stance on global variables being static, that by reflection, all local variables might need to be dynamic. While it’s true that local variables do tend to be dynamic, this is nowhere near as strong as the tendency for a global variable to be static.</p>\n<p>Locally static variables are perfectly OK in many situations. I use preprocessors variables in component files mostly as a developer convenience.</p>\n<p>Consider the classic example of a button component with multiple size variations.</p>\n<p><img src=\"/img/buttons-small-medium-large.png\" alt=\"buttons of different sizes\"></p>\n<p>My <code>scss</code> might look something like this:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token property\"><span class=\"token variable\">$button-sml</span></span><span class=\"token punctuation\">:</span> 1em<span class=\"token punctuation\">;</span><br><span class=\"token property\"><span class=\"token variable\">$button-med</span></span><span class=\"token punctuation\">:</span> 1.5em<span class=\"token punctuation\">;</span><br><span class=\"token property\"><span class=\"token variable\">$button-lrg</span></span><span class=\"token punctuation\">:</span> 2em<span class=\"token punctuation\">;</span><br><br><span class=\"token selector\">.btn </span><span class=\"token punctuation\">{</span><br>  <span class=\"token comment\">// Visual styles</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">.btn-sml </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$button-sml</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">.btn-med </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$button-med</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">.btn-lrg </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$button-lrg</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Obviously, this example would make more sense if I was using the variables multiple times or deriving margin and padding values from the size variables. However, the ability to quickly prototype different sizes might be a sufficient reason.</p>\n<p>Because most static variables are global, I like to differentiate static variables that are used only inside a component. To do this, you can prefix these variables with the component name, or you could use another prefix such as <code>c-variable-name</code> for component or <code>l-variable-name</code> for local. You can use whatever prefix you want, or you can prefix global variables. Whatever you choose, it’s helpful to differentiate especially if converting an existing codebase to use custom properties.</p>\n<h3>When To Use Custom Properties</h3>\n<p>If it is alright to use static variables inside components, when should we use custom properties? Converting existing preprocessor variables to custom properties usually makes little sense. After all, the reason for custom properties is completely different. Custom properties make sense when we have CSS properties that change relative to a condition in the DOM — especially a dynamic condition such as <code>:focus</code>, <code>:hover</code>, media queries or with JavaScript.</p>\n<p>I suspect we will always use some form of static variables, although we might need fewer in future, as custom properties offer new ways to organise logic and code. Until then, I think in most situations we are going to be working with a combination of preprocessor variables and custom properties.</p>\n<p>It's helpful to know that we can assign static variables to custom properties. Whether they are global or local, it makes sense in many situations to convert static variables, to locally dynamic custom properties.</p>\n<p><strong>Note</strong>: <em>Did you know that <code>$var</code> is valid value for a custom property? Recent versions of Sass recognize this, and therefore we need to interpolate variables assigned to custom properties, like this: <code>#{$var}</code>. This tells Sass you want to output the value of the variable, rather than just <code>$var</code> in the stylesheet. This is only needed for situations like custom properties, where variable names can also be a valid CSS.</em></p>\n<p>If we take the button example above and decide all buttons should use the small variation on mobile devices, regardless of the class applied in the HTML, this is now a more dynamic situation. For this, we should use custom properties.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token property\"><span class=\"token variable\">$button-sml</span></span><span class=\"token punctuation\">:</span> 1em<span class=\"token punctuation\">;</span><br><span class=\"token property\"><span class=\"token variable\">$button-med</span></span><span class=\"token punctuation\">:</span> 1.5em<span class=\"token punctuation\">;</span><br><span class=\"token property\"><span class=\"token variable\">$button-lrg</span></span><span class=\"token punctuation\">:</span> 2em<span class=\"token punctuation\">;</span><br><br><span class=\"token selector\">.btn </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--button-size</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">#{$button-sml}</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 600px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.btn-med </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\">--button-size</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">#{$button-med}</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token selector\">.btn-lrg </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\">--button-size</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">#{$button-lrg}</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">.btn </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--button-size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Here I create a single custom property: <code>--button-size</code>. This custom property is initially scoped to all button elements using the <code>btn</code> class. I then change the value of <code>--button-size</code> above 600px for the classes <code>btn-med</code> and <code>btn-lrg</code>. Finally, I apply this custom property to all button elements in one place.</p>\n<h3>Don't Be Too Clever</h3>\n<p>The dynamic nature of custom properties allows us to create some clever and complicated components.</p>\n<p>With the introduction of preprocessors, many of us created libraries with clever abstractions using mixins and custom functions. In limited cases, examples like this are still useful today, but for the most part, the longer I work with preprocessors the fewer features I use. Today, I use preprocessors almost exclusively for static variables.</p>\n<p>Custom properties will not (and should not) be immune from this type of experimentation, and I look forward to seeing many clever examples. But in the long run, readable and maintainable code will always win over clever abstractions (at least in production).</p>\n<p>I read an excellent article on this topic on the Free Code Camp Medium recently. It was written by Bill Sourour and is called “<a href=\"https://medium.freecodecamp.org/dont-do-it-at-runtime-do-it-at-design-time-c4f59d1775e4\">Don't Do It At Runtime. Do It At Design Time</a>.” Rather than paraphrasing his arguments, I'll let you read it.</p>\n<p>One key difference between preprocessor variables and custom properties is that custom properties work at runtime. This means things that might have been borderline acceptable, in terms of complexity, with preprocessors might not be a good idea with custom properties.</p>\n<p>One example that illustrated this for me recently was this:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--font-scale</span><span class=\"token punctuation\">:</span> 1.2<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-1</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-scale<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size-2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-2</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-scale<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size-3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-3</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-scale<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size-4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-4</span><span class=\"token punctuation\">:</span> 1rem<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>This generates a modular scale. A modular scale is a series of numbers that relate to each other using a ratio. They are often used in web design and development to set font-sizes or spacing.</p>\n<p>In this example, each custom property is determined using <code>calc()</code>, by taking the value of the previous custom property and multiplying this by the ratio. Doing this, we can get the next number in the scale.</p>\n<p>This means the ratios are calculated at run-time and you can change them by updating only the value of the <code>--font-scale</code> property. For example:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 800px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\">--font-scale</span><span class=\"token punctuation\">:</span> 1.33<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>This is clever, concise and much quicker than calculating all the values again should you want to change the scale. It’s also something I would <em>not</em> do in production code.</p>\n<p>Although the above example is useful for prototyping, in production, I'd much prefer to see something like this:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--font-size-1</span><span class=\"token punctuation\">:</span> 1.728rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-2</span><span class=\"token punctuation\">:</span> 1.44rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-3</span><span class=\"token punctuation\">:</span> 1.2em<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-4</span><span class=\"token punctuation\">:</span> 1em<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 800px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\">--font-size-1</span><span class=\"token punctuation\">:</span> 2.369rem<span class=\"token punctuation\">;</span><br>    <span class=\"token property\">--font-size-2</span><span class=\"token punctuation\">:</span> 1.777rem<span class=\"token punctuation\">;</span><br>    <span class=\"token property\">--font-size-3</span><span class=\"token punctuation\">:</span> 1.333rem<span class=\"token punctuation\">;</span><br>    <span class=\"token property\">--font-size-4</span><span class=\"token punctuation\">:</span> 1rem<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Similar to the example in Bill's article, I find it helpful to see what the actual values are. We read code many more times than we write it and global values such as font scales change infrequently in production.</p>\n<p>The above example is still not perfect. It violates the rule from earlier that <strong>global values should be static</strong>. I'd much prefer to use preprocessor variables and convert them to locally dynamic custom properties using the techniques demonstrated earlier.</p>\n<p>It is also important to avoid situations where we go from using one custom property to a different custom property. This can happen when we name properties like this.</p>\n<h3>Change The Value Not The Variable</h3>\n<p>Change the value not the variable is one of the most important strategies for using custom properties effectively.</p>\n<p>As a general rule, you should never change which custom property is used for any single purpose.\nIt's easy to do because this is exactly how we do things with preprocessors, but it makes little sense with custom properties.</p>\n<p>In this example, we have two custom properties that are used on an example component. I switch from using the value of <code>--font-size-small</code> to <code>--font-size-large</code> depending on the screen size.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--font-size-small</span><span class=\"token punctuation\">:</span> 1.2em<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-large</span><span class=\"token punctuation\">:</span> 2em<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.example </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size-small<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 800px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.example </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size-large<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>A better way to do this would be to define a single custom property scoped to the component. Then using a media query, or any other selector, change its value.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.example </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--example-font-size</span><span class=\"token punctuation\">:</span> 1.2em<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 800px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.example </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\">--example-font-size</span><span class=\"token punctuation\">:</span> 2em<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Finally, in a single place, I use the value of this custom property:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.example </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--example-font-size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>In this example and others before it, media queries have only been used to change the value of custom properties. You might also notice there is only one place where the <code>var()</code> statement is used, and regular CSS properties are updated.</p>\n<p>This separation between variable declarations and property declarations is intentional. There are many reasons for this, but the benefits are most obvious when thinking about responsive design.</p>\n<h3>Responsive Design With Custom Properties</h3>\n<p>One of the difficulties with responsive design when it relies heavily on media queries is that the no matter how you organize your CSS, styles relating to a particular component become fragmented across the stylesheet.</p>\n<p>It can be very difficult to know what CSS properties are going to change. Still, CSS Custom Properties can help us organize some of the logic related to responsive design and make working with media queries a lot easier.</p>\n<h4>If It Changes, It's A Variable</h4>\n<p>Properties that change using media queries are inherently dynamic and custom properties provide the means to express dynamic values in CSS. This means that if you are using a media query to change any CSS property, you should place this value in a custom property.</p>\n<p>You can then move this, along with all the media rules, hover states or any dynamic selectors that define how the value changes, to the top of the document.</p>\n<h4>Separate Logic From Design</h4>\n<p>When done correctly, separation of logic and design means that <strong>media queries are only used to change the value of custom properties</strong>. It means all the logic related to responsive design should be at the top of the document, and wherever we see a <code>var()</code> statement in our CSS, we immediately know that this property that changes. With traditional methods of writing CSS, there was no way of knowing this at a glance.</p>\n<p>Many of us got very good at reading and interpreting CSS at a glance while tracking in our head which properties changed in different situations. I’m tired of this, and I don't want to do this anymore! Custom properties now provide a link between logic and its implementation, so we don’t need to track this, and that is incredibly useful!</p>\n<h4>The Logic Fold</h4>\n<p>The idea of declaring variables at the top of a document or function is not a new idea. It's something we do in most languages, and it's now something we can do in CSS as well. Writing CSS in this way creates a clear visual distinction between CSS at the top of the document and below. I need a way to differentiate these sections when I talk about them and the idea of a &quot;logic fold&quot; is a metaphor I’ve started using.<br>\nAbove the fold contains all preprocessor variables and custom properties. This includes all the different values a custom property can have. It should be easy to trace how a custom property changes.</p>\n<p>CSS below the fold is straightforward and highly declarative and easy to read. It feels like CSS before media queries and other necessary complexities of modern CSS.</p>\n<p>Take a look at a really simple example of a six column flexbox grid system:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.row </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--row-display</span><span class=\"token punctuation\">:</span> block<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 600px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.row </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\">--row-display</span><span class=\"token punctuation\">:</span> flex<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>The <code>--row-display</code> custom property is initially set to <code>block</code>. Above 600px the display mode is set to flex.</p>\n<p>Below the fold might look like this:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.row </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--row-display<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">flex-direction</span><span class=\"token punctuation\">:</span> row<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">flex-wrap</span><span class=\"token punctuation\">:</span> nowrap<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.col-1,<br>.col-2,<br>.col-3,<br>.col-4,<br>.col-5,<br>.col-6 </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-grow</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">flex-shrink</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.col-1 </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 16.66%<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.col-2 </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 33.33%<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.col-3 </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 50%<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.col-4 </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 66.66%<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.col-5 </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 83.33%<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.col-6 </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>We immediately know <code>--row-display</code> is a value that changes. Initially, it will be <code>block</code>, so the flex values will be ignored.</p>\n<p>This example is fairly simple, but if we expanded it to include a flexible width column that fills the remaining space, it's likely <code>flex-grow</code>, <code>flex-shrink</code> and <code>flex-basis</code> values would need to be converted to custom properties. You can try this or take a <a href=\"https://codepen.io/MadeByMike/pen/f42ce1a954af9796ae76c62a9ea801f4/\">look at a more detailed example here</a>.</p>\n<h3>Custom Properties For Theming</h3>\n<p>I've mostly argued against using custom properties for global dynamic variables and hopefully implied that attaching custom properties to the <code>:root</code> selector is in many cases considered harmful. But every rule has an exception, and for custom properties, it's theming.</p>\n<p>Limited use of global custom properties can make theming a whole lot easier.</p>\n<p>Theming generally refers to letting users customize the UI in some way. This could be something like changing colors on a profile page. Or it might be something more localized. For example, you can choose the color of a note in the Google Keep application.</p>\n<p>Theming usually involves compiling a separate stylesheet to override a default value with user preferences, or compiling a different stylesheet for each user. Both of these can be difficult and have an impact on performance.</p>\n<p>With custom properties, we don't need to compile a different stylesheet; we only need to update the value of properties according to the user's preferences. Since they are inherited values, if we do this on the root element they can be used anywhere in our application.</p>\n<h4>Capitalize Global Dynamic Properties</h4>\n<p>Custom properties are case sensitive and since most custom properties will be local, if you are using global dynamic properties, it can make sense to capitalize them.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--THEME-COLOR</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--user-theme-color<span class=\"token punctuation\">,</span> #d33a2c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Capitalization of variables often signifies global constants. For us, this is going to signify that the property is set elsewhere in the application and that we should probably not change it locally.</p>\n<h4>Avoid Directly Setting Global Dynamic Properties</h4>\n<p>Custom properties accept a fallback value. It can be a useful to avoid directly overwriting the value of a global custom properties and keep user values separate. We can use the fallback value to do this.</p>\n<p>The example above sets the value of <code>--THEME-COLOR</code> to the value of <code>--user-theme-color</code> if it exists. If <code>--user-theme-color</code> is not set, the value of <code>#d33a2c</code> will be used. This way, we don’t need to provide a fallback every time we use <code>--THEME-COLOR</code>.</p>\n<p>You might expect in the example below that the background will be set to <code>green</code>. However, the value of <code>--user-theme-color</code> has not been set on the root element, so the value of <code>--THEME-COLOR</code> has not changed.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--THEME-COLOR</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--user-theme-color<span class=\"token punctuation\">,</span> #d33a2c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">body </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--user-theme-color</span><span class=\"token punctuation\">:</span> green<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--THEME-COLOR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Indirectly setting global dynamic properties like this protects them from being overwritten locally and ensures user settings are always inherited from the root element. This is a useful convention to safeguard your theme values and avoid unintended inheritance.</p>\n<p>If we do want to expose specific properties to inheritance, we can replace the <code>:root</code> selector with a <code>*</code> selector:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">* </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--THEME-COLOR</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--user-theme-color<span class=\"token punctuation\">,</span> #d33a2c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">body </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--user-theme-color</span><span class=\"token punctuation\">:</span> green<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--THEME-COLOR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Now the value of <code>--THEME-COLOR</code> is recalculated for every element and therefore the local value of <code>--user-theme-color</code> can be used. In other words, the background color in this example will be <code>green</code>.</p>\n<p>You can see some more detailed examples of this pattern in the section on <a href=\"#manipulating-color-with-custom-properties\">Manipulating Color With Custom Properties</a>.</p>\n<h4>Updating Custom Properties With JavaScript</h4>\n<p>If you want to set custom properties using JavaScript there is a fairly simple API and it looks like this:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> elm <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">;</span><br>elm<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span><span class=\"token function\">setProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--USER-THEME-COLOR\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tomato\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Here I’m setting the value of <code>--USER-THEME-COLOR</code> on the document element, or in other words, the <code>:root</code> element where it will be inherited by all elements.</p>\n<p>This is not a new API; it's the same JavaScript method for updating styles on an element. These are inline styles so they will have a higher specificity than regular CSS.</p>\n<p>This means it's easy to apply local customizations:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.note </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--note-color</span><span class=\"token punctuation\">:</span> #eaeaea<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.note </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--note-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Here I set a default value for <code>--note-color</code> and scope this to the <code>.note</code> component. I keep the variable declaration separate from the property declaration, even in this simple example.</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> elm <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#note-uid\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>elm<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span><span class=\"token function\">setProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--note-color\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"yellow\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>I then target a specific instance of a <code>.note</code> element and change the value of the <code>--note-color</code> custom property for that element only. This will now have higher specificity than the default value.</p>\n<p>You can see how this works with this <a href=\"https://codepen.io/MadeByMike/pen/00ae89e134c7cb6914b417cb5c494f7d?editors=0110\">example using React</a>. These user preferences could be saved in local storage or, perhaps in the case of a larger application, in a database.</p>\n<h4>Manipulating Color With Custom Properties</h4>\n<p>In addition to hex values and named colors, CSS has colors functions such as <code>rgb()</code> and <code>hsl()</code>. These allow us to specify individual components of a color such as the hue or lightness. Custom properties can be used in conjunction with color functions.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--hue</span><span class=\"token punctuation\">:</span> 25<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">body </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">hsl</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--hue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> 80%<span class=\"token punctuation\">,</span> 50%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>This is useful, but some of the most widely used features of preprocessors are advanced color functions that allow us to manipulate color using functions like lighten, darken or desaturate:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token function\">darken</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base-color</span><span class=\"token punctuation\">,</span> 10%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token function\">lighten</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base-color</span><span class=\"token punctuation\">,</span> 10%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token function\">desaturate</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base-color</span><span class=\"token punctuation\">,</span> 20%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br></code></pre>\n<p>It would be useful to have some of these features in browsers. <a href=\"https://www.w3.org/TR/css-color-4/#funcdef-color-mod\">They are coming</a>, but until we have native color modification functions in CSS, custom properties could fill some of that gap.</p>\n<p>We’ve seen that custom properties can be used inside existing color functions like <code>rgb()</code> and <code>hsl()</code> but they can also be used in <code>calc()</code>. This means that we can convert a real number to a percentage by multiplying it, e.g. <code>calc(50 * 1%)</code> = <code>50%</code>.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--lightness</span><span class=\"token punctuation\">:</span> 50<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">body </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">hsl</span><span class=\"token punctuation\">(</span>25<span class=\"token punctuation\">,</span> 80%<span class=\"token punctuation\">,</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--lightness<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> 1%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>The reason we want to store the lightness value as a real number is so that we can manipulate it with <code>calc</code> before converting it to a percentage. For example, if I want to darken a color by <code>20%</code>, I can multiply its lightness by <code>0.8</code>. We can make this a little easier to read by separating the lightness calculation into a locally scoped custom property:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">:root </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--lightness</span><span class=\"token punctuation\">:</span> 50<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">body </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--lightness</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--lightness <span class=\"token operator\">*</span> 0.8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">hsl</span><span class=\"token punctuation\">(</span>25<span class=\"token punctuation\">,</span> 80%<span class=\"token punctuation\">,</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--lightness<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> 1%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>We <em>could</em> even abstract away more of the calculations and create something like <a href=\"https://codepen.io/MadeByMike/pen/YLQWeb\">color modification functions in CSS using custom properties</a>. This example is likely too complex for most practical cases of theming, but it demonstrates the full power of dynamic custom properties.</p>\n<h4>Simplify Theming</h4>\n<p>One of the advantages of using custom properties is the ability to simplify theming. The application doesn’t need to be aware of how custom properties are used. Instead, we use JavaScript or server-side code to set the value of custom properties. How these values are used is determined by the stylesheets.</p>\n<p>This means once again that we are able to separate logic from design. If you have a technical design team, authors can update stylesheets and decide how to apply custom properties without changing a single line of JavaScript or backend code.</p>\n<p>Custom properties also allow as to move some of the complexity of theming into the CSS and this complexity can have a negative impact on the maintainability of your CSS, so remember to keep it simple wherever possible.</p>\n<h3>Using Custom Properties Today</h3>\n<p>Even if you're supporting IE10 and 11, you can start using custom properties today. Most of the examples in this article have to do with how we write and structure CSS. The benefits are significant in terms of maintainability, however, most of the examples only reduce what could otherwise be done with more complex code.</p>\n<p>I use a tool called <a href=\"https://github.com/MadLittleMods/postcss-css-variables\">postcss-css-variables</a> to convert most of the features of custom properties into a static representation of the same code. Other similar tools ignore custom properties inside media queries or complex selectors, treating custom properties much like preprocessor variables.</p>\n<p>What these tools cannot do is emulate the runtime features of custom properties. This means no dynamic features like theming or changing properties with JavaScript. This might be OK in many situations. Depending on the situation, UI customization might be considered a progressive enhancement and the default theme could be perfectly acceptable for older browsers.</p>\n<h4>Loading The Correct Stylesheet</h4>\n<p>There are many ways you can use postCSS. I use a <a href=\"https://gulpjs.com/\"><code>gulp</code></a> process to compile separate stylesheets for newer and older browsers. A simplified version of my <code>gulp</code> task looks like this:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> gulp <span class=\"token keyword\">from</span> <span class=\"token string\">\"gulp\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> sass <span class=\"token keyword\">from</span> <span class=\"token string\">\"gulp-sass\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> postcss <span class=\"token keyword\">from</span> <span class=\"token string\">\"gulp-postcss\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> rename <span class=\"token keyword\">from</span> <span class=\"token string\">\"gulp-rename\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> cssvariables <span class=\"token keyword\">from</span> <span class=\"token string\">\"postcss-css-variables\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> autoprefixer <span class=\"token keyword\">from</span> <span class=\"token string\">\"autoprefixer\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">import</span> cssnano <span class=\"token keyword\">from</span> <span class=\"token string\">\"cssnano\"</span><span class=\"token punctuation\">;</span><br><br>gulp<span class=\"token punctuation\">.</span><span class=\"token function\">task</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"css-no-vars\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span><br>  gulp<br>    <span class=\"token punctuation\">.</span><span class=\"token function\">src</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./src/css/*.scss\"</span><span class=\"token punctuation\">)</span><br>    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">sass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span> sass<span class=\"token punctuation\">.</span>logError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br>    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">postcss</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token function\">cssvariables</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">cssnano</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br>    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">rename</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> extname<span class=\"token operator\">:</span> <span class=\"token string\">\".no-vars.css\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br>    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>gulp<span class=\"token punctuation\">.</span><span class=\"token function\">dest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./dist/css\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br>gulp<span class=\"token punctuation\">.</span><span class=\"token function\">task</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"css\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span><br>  gulp<br>    <span class=\"token punctuation\">.</span><span class=\"token function\">src</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./src/css/*.scss\"</span><span class=\"token punctuation\">)</span><br>    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">sass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span> sass<span class=\"token punctuation\">.</span>logError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br>    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">postcss</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token function\">cssnano</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br>    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">rename</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> extname<span class=\"token operator\">:</span> <span class=\"token string\">\".css\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br>    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>gulp<span class=\"token punctuation\">.</span><span class=\"token function\">dest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./dist/css\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>This results in two CSS files: a regular one with custom properties (<code>styles.css</code>) and one for older browsers (<code>styles.no-vars.css</code>). I want IE10 and 11 to be served <code>styles.no-vars.css</code> and other browsers to get the regular CSS file.</p>\n<p>Normally, I’d advocate using feature queries but <a href=\"https://caniuse.com/#search=%40supports\">IE11 doesn’t support feature queries</a> and we’ve used custom properties so extensively that serving a different stylesheet makes sense in this case.</p>\n<p>Intelligently serving a different stylesheet and avoiding a flash of unstyled content is not a simple task. If you don’t need the dynamic features of custom properties, you could consider serving all browser <code>styles.no-vars.css</code> and using custom properties simply as a development tool.</p>\n<p>If you want to take full advantage of all the dynamic features of custom properties, I suggest using a <a href=\"https://www.smashingmagazine.com/2015/08/understanding-critical-css/\">critical CSS technique</a>. Following these techniques, the main stylesheet is loaded asynchronously while the critical CSS is rendered inline. Your page header might look something like this:</p>\n<pre><code>&lt;head&gt;\n  &lt;style&gt;/* inlined critical CSS */&lt;/style&gt;\n  &lt;script&gt; loadCSS('non-critical.css'); &lt;/script&gt;\n&lt;/head&gt;\n</code></pre>\n<p>We can extend this to load either <code>styles.css</code> or <code>styles.no-vars.css</code> depending on whether the browser supports custom properties. We can detect support like this:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span><span class=\"token constant\">CSS</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token constant\">CSS</span><span class=\"token punctuation\">.</span><span class=\"token function\">supports</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"color\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"var(--test)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token function\">loadCSS</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"styles.css\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token function\">loadCSS</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"styles.no-vars.css\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<h3>Conclusion</h3>\n<p>If you’ve been struggling to organize CSS efficiently, have difficulty with responsive components, want to implement client-side theming, or just want to start off on the right foot with custom properties, this guide should tell you everything you need to know.</p>\n<p>It comes down to understanding the difference between dynamic and static variables in CSS as well as a few simple rules:</p>\n<pre><code>1. Separate logic from design;\n2. If a CSS property changes, consider using a custom property;\n3. Change the value of custom properties, not which custom property is used;\n4. Global variables are usually static.\n</code></pre>\n<p>If you follow these conventions, you will find that working with custom properties is a whole lot easier than you think. This might even change how you approach CSS in general.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/a-strategy-guide-to-css-custom-properties/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Using CSS Variables Correctly",
    "partialText": "\r\n      <p>CSS Variables (also known as Custom Properties) are now supported in all modern browsers and people are starting to use them in production. This is great but they're different from variables in preprocessors and I've already seen some examples of people using them without considering the advantage they offer.</p>\n<p>They have the potential to change how we write and think about CSS. I thought I'd do a few quick demos that show some good and bad ways to use CSS variables, and how their differences from preprocessors might change how we structure CSS.</p>\n<h2>How do they differ?</h2>\n<p>Firstly how do they differ? The main difference is CSS variables can change. This might not sound surprising, variables typically do change. You might not have thought about it, but variables in preprocessors like Sass are static. Sure, you can update the value of a variable at different points in the compilation process, but when it's rendered to CSS the values are always static.</p>\n<p>This makes variables in preprocessors a great tool for writing DRY (Don't Repeat Yourself) code and manageable CSS. CSS variables on the other hand, can respond to context within the page.</p>\n<p>We can refer to variables as statically or dynamically scoped and CSS variables as dynamically scoped.</p>\n<p>In this instance, dynamically scoped means they are subject to inheritance and the cascade. This is great because you can change the value of a CSS variable inside a media query or when an element matches a CSS selector. Using the same variable we can have different values in different places on the page. You can even read and manipulate CSS variables with JavaScript.</p>\n<p>If you haven't thought of a ton of uses for CSS Variables already you will have by the end of this article. But first let me demonstrate how not to use CSS variables.</p>\n<h2>Modular Scale with CSS variables</h2>\n<p>I'm going to use modular scales as an example. A modular scale is a mathematical scale that can be used as a basis for choosing heading sizes. I like to do this, and I like to choose different scales for small and large screens.</p>\n<p>I'm going to use a scale 1.2 for smalls screens and 1.33 for large screens. I don't like maths so I got these values from <a href=\"http://www.modularscale.com/\">modularscale.com</a> and these are my heading sizes:</p>\n<table class=\"table--full table--center\">\n<thead>\n<tr>\n<th>1.2</th>\n<th>1.33</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>2.488rem</td>\n<td>4.209rem</td>\n</tr>\n<tr>\n<td>2.074rem</td>\n<td>3.157rem</td>\n</tr>\n<tr>\n<td>1.728rem</td>\n<td>2.369rem</td>\n</tr>\n<tr>\n<td>1.44rem</td>\n<td>1.777rem</td>\n</tr>\n<tr>\n<td>1.2rem</td>\n<td>1.333rem</td>\n</tr>\n<tr>\n<td>1rem</td>\n<td>1rem</td>\n</tr>\n</tbody>\n</table>\n<h2>Not like this...</h2>\n<p>This is a perfect situation to use CSS variables. The way I would have approached this with Sass, and how I've seen most people use CSS variables so far, is something like this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token comment\">/* scale for 1.2 */</span><br>  <span class=\"token property\">--ms-small-1</span><span class=\"token punctuation\">:</span> 1rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--ms-small-2</span><span class=\"token punctuation\">:</span> 1.2rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--ms-small-3</span><span class=\"token punctuation\">:</span> 1.44rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--ms-small-4</span><span class=\"token punctuation\">:</span> 1.728rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--ms-small-5</span><span class=\"token punctuation\">:</span> 2.074rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--ms-small-6</span><span class=\"token punctuation\">:</span> 2.488rem<span class=\"token punctuation\">;</span><br><br>  <span class=\"token comment\">/* scale for 1.33 */</span><br>  <span class=\"token property\">--ms-large-1</span><span class=\"token punctuation\">:</span> 1rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--ms-large-2</span><span class=\"token punctuation\">:</span> 1.333rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--ms-large-3</span><span class=\"token punctuation\">:</span> 1.777rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--ms-large-4</span><span class=\"token punctuation\">:</span> 2.369rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--ms-large-5</span><span class=\"token punctuation\">:</span> 3.157rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--ms-large-6</span><span class=\"token punctuation\">:</span> 4.209rem<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>This seems fairly logical, We've defined variables for each of the values in each of the different scales. Next I'd expect to see this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token comment\">/* Small scale for small screens: */</span><br><span class=\"token selector\">h1</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-small-6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">h2</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-small-5<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">h3</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-small-4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">h4</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-small-3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">h5</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-small-2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">h6</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-small-1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token comment\">/* And large scale for larger screens */</span><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 800px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">h1</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-large-6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token selector\">h2</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-large-5<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token selector\">h3</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-large-4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token selector\">h4</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-large-3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token selector\">h5</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-large-2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token selector\">h6</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ms-large-1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p><a target=\"_blank\" href=\"https://codepen.io/MadeByMike/pen/dRoLpJ\">This works!</a> More than that, if I want to change any of these values I can do it in one place. That's an even bigger advantage if I'm using variables elsewhere in my CSS.</p>\n<p>This is DRY like Sass and I guess that's better than regular CSS. But we can do better.</p>\n<h2>More like this...</h2>\n<p>The example above might seem like the most logical way to do things but it's not taking advantage of how CSS variables work. Let's try again, remembering that CSS variables are scoped to the DOM therefore subject to inheritance and the cascade.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token comment\">/* scale for 1.2 */</span><br>  <span class=\"token property\">--font-size-1</span><span class=\"token punctuation\">:</span> 1rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-2</span><span class=\"token punctuation\">:</span> 1.2rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-3</span><span class=\"token punctuation\">:</span> 1.44rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-4</span><span class=\"token punctuation\">:</span> 1.728rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-5</span><span class=\"token punctuation\">:</span> 2.074rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--font-size-6</span><span class=\"token punctuation\">:</span> 2.488rem<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 800px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token comment\">/* scale for 1.33 */</span><br>    <span class=\"token property\">--font-size-1</span><span class=\"token punctuation\">:</span> 1rem<span class=\"token punctuation\">;</span><br>    <span class=\"token property\">--font-size-2</span><span class=\"token punctuation\">:</span> 1.333rem<span class=\"token punctuation\">;</span><br>    <span class=\"token property\">--font-size-3</span><span class=\"token punctuation\">:</span> 1.777rem<span class=\"token punctuation\">;</span><br>    <span class=\"token property\">--font-size-4</span><span class=\"token punctuation\">:</span> 2.369rem<span class=\"token punctuation\">;</span><br>    <span class=\"token property\">--font-size-5</span><span class=\"token punctuation\">:</span> 3.157rem<span class=\"token punctuation\">;</span><br>    <span class=\"token property\">--font-size-6</span><span class=\"token punctuation\">:</span> 4.209rem<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Notice that I have only one set of variables now and not one for each scale. I change the value of the variable depending on the screen size. This indirectly results in two things:</p>\n<ol>\n<li>\n<p>I'm forced to name the variables differently (not small or large anymore)</p>\n</li>\n<li>\n<p>There is no need for media queries elsewhere in my CSS</p>\n</li>\n</ol>\n<p>I can now use variables directly in my property declarations knowing they will change as required. All the responsive logic is in the variable. The rest of my CSS looks like this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">h1</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size-6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">h2</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size-5<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">h3</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size-4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">h4</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size-3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">h5</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size-2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">h6</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size-1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>The example above demonstrates a better way of writing CSS with variables. Now let's see if we can define some of these techniques in more detail.</p>\n<h2>Techniques for organising code with CSS variables</h2>\n<p>Variables have the potential to change how we organise and structure CSS, especially in relation to responsive design.</p>\n<h3>Separate logic from design</h3>\n<p>The main advantage is we now have the ability to fully separate logic from design. Effectively this means separating variable declarations from property declarations.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token comment\">/* This is a variable declaration */</span><br><span class=\"token selector\">.thing</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--my-var</span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token comment\">/* This is a property declaration */</span><br><span class=\"token selector\">.thing</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--my-var<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>My view is you should probably keep variable declarations and property declaration separate. Separating variables from the rest of the declarations is considered good practice when working with preprocessors. This shouldn't change when working with CSS variables.</p>\n<h3>Change the value not the variable</h3>\n<p>In most cases, <strong>I'd now consider it code smell if a media query or CSS selector swaps one variable for another</strong>. Rather than swapping variables it's better to define one variable, set its initial value and change it with a selector or media query.</p>\n<h3>If it changes it's a variable</h3>\n<p><strong>I'm convinced that in almost all cases, responsive design logic should now be contained in variables</strong>. There is a strong argument too, that when changing any value, whether in a media query or an element scope, it belongs in a variable. If it changes, it is by definition a variable and this logic should be separated from design.</p>\n<h3>Fewer media queries</h3>\n<p>It makes sense for all the logic related to variables to be at the top of the document. It's easier to maintain because you can change it in one place and it's easier to read because you can see what is changing without reading the entire stylesheet.</p>\n<p>We couldn't do this with media queries because it fragmented the rules for styling an element across different parts the stylesheet. This was not practical or maintainable, so it made sense group media queries with declarations relating to the sames selectors they changed.</p>\n<p>Variables now provide a link between the logic and the implementation of design. <strong>This means in most cases media queries should not be required except for changing CSS variables</strong> and they belong at the top of the document with variable declarations. Above the 'logic fold'.</p>\n<h3>Simplify selectors</h3>\n<p>Effectively separating logic from design also keeps the complexity out of the main property declarations to the point that you can combine selectors.</p>\n<p>In this example I have an aside and a main element with different font-sizes. The aside has a dark background and the main element has a light background.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token comment\">/* Default values */</span><br><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--font-size</span><span class=\"token punctuation\">:</span> 1.2rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--background-color</span><span class=\"token punctuation\">:</span> #fff<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--text-color</span><span class=\"token punctuation\">:</span> #222<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token comment\">/* Values in aside */</span><br><span class=\"token selector\">aside</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--font-size</span><span class=\"token punctuation\">:</span> 1rem<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--background-color</span><span class=\"token punctuation\">:</span> #222<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--text-color</span><span class=\"token punctuation\">:</span> #fafafa<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token comment\">/* Same property declarations */</span><br><span class=\"token selector\">main,<br>aside</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--font-size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--text-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--background-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Try it out:</p>\n<p data-height=\"400\" data-theme-id=\"light\" data-slug-hash=\"YQNVox\" data-default-tab=\"css,result\" data-user=\"MadeByMike\" data-embed-version=\"2\" data-pen-title=\"Organising code with CSS Variables\" data-editable=\"true\" class=\"codepen\">See the Pen <a href=\"https://codepen.io/MadeByMike/pen/YQNVox/\">Organising code with CSS Variables</a> by Mike (<a href=\"https://codepen.io/MadeByMike\">@MadeByMike</a>) on <a href=\"https://codepen.io\">CodePen</a>.</p>\n<script async src=\"https://production-assets.codepen.io/assets/embed/ei.js\"></script>\n<p>Despite having a completely different appearance these two elements have exactly the same property declarations.</p>\n<h3>Less generic variables</h3>\n<p>A quick warning about combining selectors with overly generic variables. You might think it's a fun idea to have a universal selector and let variables handle all the logic:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token comment\">/* Don't do this. */</span><br><span class=\"token selector\">*</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--display<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--Height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--border<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--background<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  ...<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Although fun, we should be careful about reusing variables and combining selectors. CSS variables are subject to the cascade. With the above example, when setting a border on a class <code>.container</code> like this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.container</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--border</span><span class=\"token punctuation\">:</span> solid 2px tomato<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Everything inside that container will inherit the same border. Pretty soon you will be overriding variables on everything, and you don't need a universal <code>*</code> selector to fall into this trap.</p>\n<h3>Use preprocessors for static variables</h3>\n<p>Do CSS variables replace preprocessors? No. Using preprocessors still makes sense. It's a good idea to keep all your static variables in Sass (or whatever preprocessor you use).</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token comment\">// Static variables:</span><br><span class=\"token property\"><span class=\"token variable\">$breakpoint-small</span></span><span class=\"token punctuation\">:</span> 600px<span class=\"token punctuation\">;</span><br><span class=\"token property\"><span class=\"token variable\">$theme-color</span></span><span class=\"token punctuation\">:</span> rebeccapurple<span class=\"token punctuation\">;</span><br><br><span class=\"token comment\">// Dynamic variables</span><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$breakpoint-small</span><span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">body </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\">--background</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$theme-color</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Not only does this denote static variables from dynamic variables in your code, but CSS variables can only be used for property declarations. In other words they can't be used in media queries.</p>\n<p>Preprocessor also have color functions, mixins and allows us to keep styles related to different components in different files. All of this stuff still makes sense.</p>\n<h2>New approach to responsive design</h2>\n<p>I think CSS variables offer a completely new approach to responsive design and will challenge some techniques and thinking we've developed over many years. These tips are just a few of the obvious things we need to consider.</p>\n<p>I made a <a target=\"_blank\" href=\"https://codepen.io/MadeByMike/pen/dRNqNw/\">detailed example</a> of a simple responsive site that demonstrates some of the techniques and suggestions outlined in this article.</p>\n<p><a target=\"_blank\" href=\"https://codepen.io/MadeByMike/pen/dRNqNw/\">Open this demo in CodePen</a> to see how it responds to different viewport sizes.</p>\n<p data-height=\"520\" data-theme-id=\"light\" data-slug-hash=\"dRNqNw\" data-default-tab=\"css,result\" data-user=\"MadeByMike\" data-embed-version=\"2\" data-pen-title=\"Responsive design with CSS variables\" data-editable=\"true\" class=\"codepen\">See the Pen <a href=\"https://codepen.io/MadeByMike/pen/dRNqNw/\">Responsive design with CSS variables</a> by Mike (<a href=\"https://codepen.io/MadeByMike\">@MadeByMike</a>) on <a href=\"https://codepen.io\">CodePen</a>.</p>\n<script async src=\"https://production-assets.codepen.io/assets/embed/ei.js\"></script>\n<p>If you have any thoughts about how CSS variables might change how we think about, manage and structure CSS please <a href=\"https://twitter.com/MikeRiethmuller\">let me know on Twitter</a>.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/using-css-variables/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Non-linear Interpolation in CSS",
    "partialText": "\r\n      <p>A few years ago I wrote about fluid typography techniques that show how you can use calc() and viewport units to create transitions between different font-sizes as the viewport size changes. If you'd like to know more about how this technique works you should read my article <a href=\"https://madebymike.com.au/writing/precise-control-responsive-typography/\">Precise control over responsive typography</a>.</p>\n<p>Recently these ideas have circulated and gained more traction. I've seen more large sites using fluid typography and other people writing about it and expanding on my initial ideas and techniques. One recent example of this was an article by Jake Wilson <a href=\"https://medium.com/@jakobud/css-polyfluidsizing-using-calc-vw-breakpoints-and-linear-equations-8e15505d21ab\">CSS Poly Fluid Sizing using calc(), vw, breakpoints and linear equations</a>.</p>\n<p>One of the most interesting things in Jake's article is the idea of having multiple points of transition. He refers to these as &quot;<em>Breakpoints + Multiple Linear Equations</em>&quot; but I like to think of these as &quot;bending points&quot;. I like the term bending points rather than breakpoints for these because to me, a breakpoint implies there should be a jump and that's not what this is. These are intermediary points where the rate of scale changes.</p>\n<p>This idea of non-linear transitions is something I’ve been thinking about for a while. Unfortunately at the moment we can't do this with CSS alone. So when I’m asked about this, I usually reply with the same suggestion Jake has, that is to use multiple linear transitions. But I remain a little hesitant about how people might use this technique.</p>\n<p>I'd love to be able to use non-linear equations for transitions of font-size or other properties, but until there is a native function in CSS, I think adding a large number of intermediary steps only adds complexity.</p>\n<p>Undoubtedly some people will be willing to set many bending points at the cost readability and maintainability. In a lot of cases, readability and maintainability are more important than finessing a few pixels difference at uncommon screen sizes. That's why the original examples I created only allowed for only a single minimum and maximum font-size.</p>\n<p>I also felt that that equations and ideas were complex enough and based on the feedback I've had, I think this is often still the case. I get that, sometimes you just want the font to bend and you don’t want to worry about how the maths works.</p>\n<p>Yet this is only one type of user. Clearly many people want to do this, and despite the complexity, some designs could benefit from using a small number of bending points. Besides, CSS has other complex concepts.</p>\n<p>If you want to use bending points to transition CSS values between multiple intermediary points, it should be done deliberately and with restraint; not just because you can. Aside from adding complexity to the CSS, for standard body text with limited variation in size the difference is not particularly noticeable. This is a technique better reserved for headings and other key features where small details matter. Assuming you do have a good case for more than one bending point, how do you determine what those intermediary points should be? And how do we make this accessible to all types of users?</p>\n<p>Jake talks about statistics as a tool for determining the minimum and maximum font-sizes at points along a trendline. I found this to be an interesting idea. I like the mathematical approach, but if maths is not your thing and calculating a polynomial regression trendline is probably not going to be up your alley either.</p>\n<p>For me the statistical approach is an interesting aside to what we are trying to do; choose a set of appropriate bending points. If you like this type of mathematics you can of course use statistics as a tool for determining these points, however, it would be equally valid to choose points that have no mathematical basis, or to use a modular scale, or a cubic bezier function, or any other method you can imagine for drawing a line between two points.\nIf we were to have a native interpolation function in CSS, it would likely be similar to existing features. One of the great things about CSS is that all the different parts of it are interoperable. That is, they work together and it is because calc() and viewport units work together that we’re able to get linear-interpolation in CSS. If we want a native interpolation function in CSS should be interoperable as well.</p>\n<p>Changing the way we are used to doing things is difficult, learning a new syntax is hard, even when it's superior to previous techniques. Interoperability can help with this and that’s one of the reasons why you see when new layout properties shared between flexbox and CSS grid. It turns out that fluid values in CSS have a lot in common with animation.</p>\n<p>That's why I think polynomial regression and statistics might not the best mental model for thinking about interpolation in CSS. After all, we already have native interpolation with animation. Animation-timing-functions like <code>cubic-bezier</code> and keywords like <code>ease-in</code>, provide all the tools we need in a way that will be somewhat familiar to developers and designers.</p>\n<p>The missing piece is direct access to the internal interpolation function that powers animation in CSS and the ability to replace the time dimension with the viewport or another custom completion value. A custom completion value could provide further compatibility with future CSS features such as container queries. I wrote about these ideas in more detail in an article <a href=\"https://madebymike.com.au/writing/interpolation-without-animation/\">interpolation outside of animation</a>.</p>\n<p>It might sound a little complex but it's the same mathematics we use when creating animation on the web. CSS does a good job of abstracting away the mathematical complexities you probably don’t think about it but you understand the result of applying keywords like <code>ease-in</code> to an animation. The average doesn't need to understand what type of function this is or how it works. It's not a big leap to take these ideas and use them for creating the effects in typography and other areas of the web.</p>\n<p>Fluid typography doesn’t need to be hard, so I've taken these ideas and feedback from the community to create a mixin that generates one or more bending points with a syntax that closely aligns with animation-functions:</p>\n<p data-height=\"550\" data-theme-id=\"light\" data-slug-hash=\"oWqvNa\" data-default-tab=\"result\" data-user=\"MadeByMike\" data-embed-version=\"2\" data-pen-title=\"Bending points\" class=\"codepen\">See the Pen <a href=\"http://codepen.io/MadeByMike/pen/oWqvNa/\">Bending points </a> by Mike (<a href=\"http://codepen.io/MadeByMike\">@MadeByMike</a>) on <a href=\"http://codepen.io\">CodePen</a>.</p>\n<script async src=\"https://production-assets.codepen.io/assets/embed/ei.js\"></script>\n<p>To properly see this in action you might want to <a href=\"http://codepen.io/MadeByMike/pen/oWqvNa/?editors=0100\" target=\"_blank\">open it in a new window</a> so you can resize it.</p>\n<p>You can <a href=\"https://www.sassmeister.com/gist/beac01f68da4f9ef3007c0d17f72d8c6\">grab the mixin you can get it here</a>.</p>\n<p>This code for the mixin looks complex but it does a lot of the maths, so that you don't need to consider anything except the type of easing you want to apply.</p>\n<p>Like other examples of fluid typography this one requires a min and max value for the target CSS property and screen sizes. But unlike other examples this one also takes an optional easing value.</p>\n<p>The easing value works exactly like an <a href=\"https://developer.mozilla.org/en/docs/Web/CSS/animation-timing-function\">animation-timing-function</a>. You can give it a keyword or even a <code>cubic-bezier</code> function and it will calculate the intermediary values and set up the transitions. Note: It does not accept <code>step</code> values.</p>\n<p>The final optional parameter is the number of bending points. This defaults to 2, and in most cases I'd recommend leaving it at the default, but because I know you are going to do it anyway, you can set as many bending points as you like.</p>\n<p>Here are some examples to get you started:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.classic-linear </span><span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">@include</span> <span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"font-size\"</span><span class=\"token punctuation\">,</span> 600px<span class=\"token punctuation\">,</span> 12px<span class=\"token punctuation\">,</span> 900px<span class=\"token punctuation\">,</span> 24px<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.easy-peasy </span><span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">@include</span> <span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"font-size\"</span><span class=\"token punctuation\">,</span> 600px<span class=\"token punctuation\">,</span> 12px<span class=\"token punctuation\">,</span> 900px<span class=\"token punctuation\">,</span> 24px<span class=\"token punctuation\">,</span> <span class=\"token string\">\"ease-in\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.cubic-bezier </span><span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">@include</span> <span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span><br>    <span class=\"token string\">\"font-size\"</span><span class=\"token punctuation\">,</span><br>    600px<span class=\"token punctuation\">,</span><br>    12px<span class=\"token punctuation\">,</span><br>    900px<span class=\"token punctuation\">,</span><br>    24px<span class=\"token punctuation\">,</span><br>    <span class=\"token string\">\"cubic-bezier(0.755, 0.05, 0.855, 0.06)\"</span><br>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.bloat-my-css </span><span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">@include</span> <span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span><br>    <span class=\"token string\">\"font-size\"</span><span class=\"token punctuation\">,</span><br>    600px<span class=\"token punctuation\">,</span><br>    12px<span class=\"token punctuation\">,</span><br>    900px<span class=\"token punctuation\">,</span><br>    24px<span class=\"token punctuation\">,</span><br>    <span class=\"token string\">\"ease-in-ease-out\"</span><span class=\"token punctuation\">,</span><br>    10<br>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>This aims to show how I think native interpolation should work in browsers, but it still only works where calc does. I think there is a lot more discussion to be had and problems that we need to solve before we can have a real native interpolation in CSS. I welcome contributions to this discussion and ideas from maths, statistics, animation or any areas. One thing that I think is increasingly apparent is that the web is fluid medium and breakpoints will not continue to be the only answer, or the key feature in the future of responsive design.</p>\n<p>If you want to <a href=\"https://www.sassmeister.com/gist/beac01f68da4f9ef3007c0d17f72d8c6\">use this in a project grab the mixin here</a>.</p>\n<p>If you want to don't want multiple bending points you can still use the example above, but if you want a simple linear interpolation mixin <a href=\"https://www.sassmeister.com/gist/d8714d9b987e376ad52db5ede5401ff3\">you can find my previous example here</a>.</p>\n<p>Finally if you want to look at some more examples <a href=\"http://codepen.io/collection/nLbRMZ/\">I have a fluid typography collection on CodePen</a>.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/non-linear-interpolation-in-css/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "The invisible parts of CSS",
    "partialText": "\r\n      <p>If you use CSS in your daily work, your primary goal is probably focused on making things 'look right'. How this is achieved is often far less important than the end result. This means we care less about how CSS works than the correct syntax and visual results.</p>\n<p>You may not have realised it, but the visual results of CSS are often an indirect consequence of manipulating hidden properties. Some CSS properties such as <code>background-color</code> have a direct and obvious relationship with what you see. While others such as <code>display</code> remain ambiguous to many of us because the results seem highly dependant on context.</p>\n<p>I doubt many developers could describe in simple terms what setting <code>display: block</code> actually does. At best you probably have an intuitive understanding of how properties like this work. That's ok, you can have a pretty good wrangle of CSS without understanding the underlying principles. Although, this might be knowing the solution without necessarily understanding the problem.</p>\n<p>If this describes you, that's ok. I learnt how to work with CSS, long before I understood <em>how</em> it worked. I guess that doesn’t make it ok, ...but at least you’re not alone!</p>\n<p>The underlying features of CSS are complicated and intentionally abstracted, yet we can't be completely unaware of them. Concepts such as the Box Model, Cascade and Specificity will be familiar to many of us. Although they are often misunderstood, knowing a little of how these work can help us write better CSS.</p>\n<p>The same can be said for many other hidden parts of CSS. The problem with understanding these better is that the barrier to entry is even higher. It often feels like nothing can be explained in isolation. You need to know everything before you can understand the smallest part of the process.</p>\n<p>Because of this I want to attempt to shed some light on the invisible parts of CSS, touching only on what you need to know and hopefully explaining the process in a logical order, so that you can gain a better understand of how CSS actually works.</p>\n<p>This is a long article so if you want to skip ahead to one of these sections, I'm totally fine with that:</p>\n<ul>\n<li><a href=\"#heading-overview-of-the-rendering-process\">Overview of the rendering process</a></li>\n<li><a href=\"#heading-cascade\">Cascade</a></li>\n<li><a href=\"#heading-the-box-model\">The Box Model</a>\n<ul>\n<li><a href=\"#heading-fill-area\">Fill Area</a></li>\n<li><a href=\"#heading-width-auto\">Width Auto</a></li>\n<li><a href=\"#heading-box-sizing\">Box-sizing</a></li>\n<li><a href=\"#heading-collapsing-margins\">Collapsing margins</a></li>\n</ul>\n</li>\n<li><a href=\"#heading-the-visual-formatting-model\">The Visual Formatting Model</a></li>\n<li><a href=\"#heading-display-types\">Display types</a></li>\n<li><a href=\"#heading-formatting-contexts\">Formatting contexts</a></li>\n<li><a href=\"#heading-positioning-schemes\">Positioning schemes</a>\n<ul>\n<li><a href=\"#heading-normal-flow\">Normal flow</a></li>\n<li><a href=\"#heading-floats\">Floats</a></li>\n<li><a href=\"#heading-absolute-positioning\">Absolute positioning</a></li>\n<li><a href=\"#heading-stacking-contexts\">Stacking context</a></li>\n</ul>\n</li>\n</ul>\n<h2>Overview of the rendering process</h2>\n<p>When you load an HTML document there is a lot that happens in order for that page to render.</p>\n<p>The first step is to parse the HTML document. From this the browser builds a 'document tree'. A tree structure is a way of representing information with an obvious hierarchy like HTML. Elements in a tree can be described in terms similar to a family tree, such as descendants, parents, children and siblings.</p>\n<p>You might have heard the term DOM. This stands for Document Object Model. It is an extension of the document tree structure, and is used to store and manipulate information about the content of a web document.</p>\n<p>As HTML is being parsed, stylesheets and other resources are fetched. Style declarations are interpreted and resolved through a process known as the <a href=\"#heading-cascade\">Cascade</a>.</p>\n<p>During this process the final values of CSS properties are resolved. After calculation these values may be different to what is written in our stylesheets. For example keywords like <code>auto</code> and relative units are assigned real values, and inherited values are applied. These computed values are stored in a tree, similar to elements in the DOM, in what is unsurprisingly called the CSS Object Model or CSSOM.</p>\n<p>It is now possible to begin the process of rendering the page. The first step in this process is the calculation of <a href=\"#heading-the-box-model\">the Box Model</a>. This is an important step for working out the size and spacing of elements, although not their final position.</p>\n<p>Less well known than the <a href=\"#heading-the-box-model\">Box Model</a> is a process called the <a href=\"#heading-the-visual-formatting-model\">Visual Formatting Model</a>. This process determines the layout and positioning of elements on the page. It encompases some concepts you might already be familiar with such as <a href=\"#heading-positioning-schemes\">positioning schemes</a>, <a href=\"#heading-formatting-contexts\">formatting contexts</a>, <a href=\"#heading-display-types\">display modes</a>, and <a href=\"#heading-stacking-contexts\">stacking contexts</a>.</p>\n<p>Finally the page is rendered.</p>\n<p>There might be a few terms in the paragraphs above that you are not yet familiar with. If so, what's most important is to understand that the <a href=\"#heading-cascade\">Cascade</a>, the <a href=\"#heading-the-box-model\">Box Model</a>, and the <a href=\"#heading-the-visual-formatting-model\">Visual Formatting Model</a> are the key steps involved in interpreting, processing and rendering HTML and CSS. I’ve skipped over a lot of detail when describing each of these so we’re now going to look at these 3 steps more closely.</p>\n<h2>Cascade</h2>\n<p>The cascade is probably one of the most misunderstood features of CSS. It refers to the process of combining different stylesheets and resolving conflicts between CSS selectors.</p>\n<p>The cascade looks at the importance, origin, specificity, and order of declarations to determine which style rules to use.</p>\n<p><strong>What you need to know:</strong></p>\n<p>Most websites have multiple stylesheets. Typically styles are added with a <code>link</code> tag that references a css file, or with a <code>style</code> tag in the HTML body. Even the most basic page will have default styles provided by the browser. This default stylesheet is sometimes called the user-agent stylesheet.</p>\n<p>During the cascade stylesheets are interpreted in the following order:</p>\n<ol>\n<li>!important declarations</li>\n<li>Author stylesheets</li>\n<li>Browser default stylesheets</li>\n</ol>\n<p><strong>Note:</strong> I've skipped over user stylesheets here because they are not a common thing anymore and probably wouldn’t factor in consideration for anyone reading this.</p>\n<p>After combining these sources, if multiple rules apply to the same element, specificity is used to determine which rules to apply.</p>\n<h3>Specificity</h3>\n<p>Specificity is a weighting given to selectors. It's a common mistake to think of this as a single number. It’s actually 4 separate numbers or 4 categories of weighting.</p>\n<p>To calculate specificity, count the number of:</p>\n<ol>\n<li>IDs,</li>\n<li>classes, attributes and pseudo-classes,</li>\n<li>elements and pseudo-elements</li>\n</ol>\n<p>For example: <code>#nav .selected:hover &gt; a::before</code> will be 1, 2, 2.</p>\n<p>No number of classes will ever have a higher specificity than an ID. When comparing selectors you compare the specificity of IDs first. Only if these match do you compare the value of classes, attributes and pseudo-classes and finally, if still equal, elements and pseudo-elements.</p>\n<p>If specificity is equal in every category, the last declaration in the source takes precedence.</p>\n<p>Yes! I know I said 4 categories. Inlines styles have a higher specificity than IDs. Although they are technically the first category in specificity calculations you don't typically end up with competing inline styles, so it’s easier just remember that inline styles will always win specificity.</p>\n<p><strong>Important note:</strong> !important declarations are not factored in specificity calculations but they do have a greater precedence than normal declarations in the cascade.</p>\n<h3>Inheritance</h3>\n<p>Inheritance is not part of the cascade but I've included it here because it is often discussed in conjunction with the cascade.</p>\n<p>Inheritance is the process where values that apply to an element can be passed on (or inherited) by its children.</p>\n<p>You are likely familiar with the fact that font properties, when applied to the body or another container element, are also inherited by every element inside that container. This is inheritance.</p>\n<p>Not all properties are inherited by default. Understanding inheritance is key to writing more deliberate and less verbose CSS. Forcing inheritance with the <code>inherit</code> keyword can be incredibly useful.</p>\n<p><strong>Note:</strong> Some properties are such as <code>border-color</code> have a default value of <code>currentcolor</code>. This means they will use the value set on the <code>color</code> property. This default value is not the same thing as inheritance. Although the color property itself is often inherited so I tend to think of this as defacto kind of inheritance.</p>\n<h2>The Box Model</h2>\n<p>Understanding the Box Model is essential and necessary for limiting frustration when working with layout and positioning. It is one of the most fundamental concepts in CSS.</p>\n<p>The box model is used to calculate the width and height of elements. It is a calculation step and not solely relied upon for determining the final layout and positioning of elements.</p>\n<p><strong>What you need to know:</strong></p>\n<p>Every element in HTML is a rectangular box. Each box has four regions defining the margin, borders, padding, and content areas of an element.</p>\n<p>By default, when you set the width of an element, this sets the width of the content area only. When you add padding, border or margin to an element, this is added in addition to the width. In practical terms this means that two elements with a width of 50%, will not fit side-by-side if padding, margin or borders are added.</p>\n<img alt=\"shows the content-width within the box model\" src=\"/img/content-width.png\" style=\"width:100%; max-width:550px;\">\n<p>That's it! It’s pretty simple right? So why is this often a source of confusion? Well, you might have encountered a few situations where things seem to behave a little differently…</p>\n<h3>Fill Area</h3>\n<p>When you set the background of an element this fills not only the content area but also the padding and border areas as well.</p>\n<img style=\"width:100%; max-width:550px;\" alt=\"shows the fill area within the box model\" src=\"/img/fill-area.png\" >\n<p>Conceptually we think of an HTML element as a single thing, so it's easy to think that the visual boundaries of an element are equal to its width however this is not the case. Although the visual boundaries of an element include the padding and border areas the width property is applied explicitly to the content box.</p>\n<p><strong>Note:</strong> Altering the <code>box-sizing</code> property can change this behaviour.</p>\n<h3>Width Auto</h3>\n<p>Another source of potential confusion is how <code>width: auto</code> works. A width of auto is the default setting for most HTML elements and for block elements such as divs and paragraphs, <code>auto</code> will calculate the width so that the margin, border, padding and content areas combined all fit within the available space.</p>\n<p>In this situation it can feel like adding padding and margins push inwards on the content, but in reality, the width is being recalculated to ensure everything fits. By comparison when setting a width of <code>100%</code>, the content area will fill the space available regardless of margin, padding and borders.</p>\n<img style=\"width:100%; max-width:550px;\" alt=\"shows how width auto works compared to width:100%\" src=\"/img/width-auto.png\" >\n<h3>Box-sizing</h3>\n<p>The box-sizing property changes the way the box model works. When box-sizing is set to <code>border-box</code> padding and border will reduce the inner width of the content area, rather than adding to the overall width of an element. This means that a width of an element is now the same as its visual width.</p>\n<img style=\"width:100%; max-width:550px;\" alt=\"shows how box-sizing:border-box works\" src=\"/img/box-sizing.png\" >\n<p>A lot of people prefer this, and if you're building a grid system, or any other kind of layout that requires aligning items horizontally, this can be much more intuitive way to work.</p>\n<h3>Collapsing margins</h3>\n<p>It can be really confusing when margins collapse unexpectedly and you don't know what is going on. Margins will sometimes collapse when two or more adjacent vertical margins touch and they are not separated with padding or border. A collapsing margin can also occur if the margin of a child element extends into that of its parent and is not separated by padding.</p>\n<p>Margins will not collapse if elements are absolutely positioned, floated, or have a different <a href=\"#heading-formatting-contexts\">formatting context</a>, as well as in a few other less likely situations.</p>\n<p>If you're confused that’s ok. The rules for when margins will and will not collapse are complicated. The main thing you need to know is when elements don’t have padding or borders, vertical margins can collapse.</p>\n<p>If you need more detail CSS Tricks has a wonderful <a href=\"https://css-tricks.com/what-you-should-know-about-collapsing-margins/\">explanation of collapsing margins</a>.</p>\n<h2>The Visual Formatting Model</h2>\n<p>While the box model calculates an element's dimensions, it’s the Visual Formatting Model that is responsible for determining the layout of these boxes. The Visual Formatting Model takes into account the box type, <a href=\"#heading-positioning-schemes\">positioning scheme</a>, relationships between elements and constraints imposed by content to determine the final position and presentation of each element on the page.</p>\n<p><strong>What you need to know:</strong></p>\n<p>The visual formatting model traverses the document tree and generates one or more boxes required to render elements according to the CSS box model. The CSS <code>display</code> property plays a key role in determining how an element participates in the current formatting context and positioning scheme. Together these pieces determine the final layout and positioning of elements.</p>\n<p>This is a complex step and was by far the most difficult to try and summarise. If you don't follow everything that’s ok. Understanding how we manipulate <a href=\"#heading-positioning-schemes\">positioning schemes</a> and <a href=\"#heading-formatting-contexts\">formatting contexts</a> through the CSS properties is a good start. If you can follow the interplay between different pieces of this model you are doing better than most. At very least you should know that they exist.</p>\n<h2>Display types</h2>\n<p>We know that setting the <code>display</code> property in CSS determines the how an element is rendered but it's not immediately clear how this works. In fact sometimes, it can even seem unpredictable.</p>\n<p>This is because the display property determines the element's 'box type’. This hidden property consists of an inner display type, and an outer display type which together help determine how the element is rendered.</p>\n<p>The outer display type usually resolves to either 'block' or ‘inline’ and is pretty much consistent what you expect of theses <code>display</code> properties in CSS. Technically speaking the outer display type dictates how an element participates in its parent <a href=\"#heading-formatting-contexts\">formatting context</a>.</p>\n<p>The inner display type determines what <a href=\"#heading-formatting-contexts\">formatting context</a> that element will generate. This will impact how its child elements are laid out.</p>\n<p>Think of how a Flexbox container works. Its outer type is <code>block</code> and its inner type is <code>flex</code>. Its children can also have an outer type of block, but their layout is influenced by the formatting context of the Flexbox container.</p>\n<p>One way of thinking about this is that the responsibility for display is shared between an element and it's parent element.</p>\n<h2>Formatting contexts</h2>\n<p>Formatting context are all about layout. They are the rules that govern the layout of elements inside a container and how they interact with each other.</p>\n<p>Some formatting contexts can be established directly on containers such as through the use of <code>display</code> values <code>flex</code>, <code>grid</code> or <code>table</code>. Other types such as block and inline formatting contexts are created as required by the browser.</p>\n<p><strong>Note:</strong> At one time, because of the way it interacts with floats, it was important to understand how to make the browser establish a new block formatting context. Elements with a block formatting context will contain floats. This is not as important today as it once was. In fact it's not even how modern <a href=\"https://css-tricks.com/snippets/css/clear-fix/\">clearfix techniques</a> work.</p>\n<h2>Positioning schemes</h2>\n<p>A box can be laid out according to one of three positioning schemes. These are <a href=\"#heading-normal-flow\">Normal flow</a>, <a href=\"#heading-floats\">Floats </a>and <a href=\"#heading-absolute-positioning\">Absolute positioning</a>. You are probably familiar with floats and absolute positioning because we interact with these more directly when writing CSS. Normal flow is just a name for the default positioning scheme when an element is not floated or positioned.</p>\n<h3>Normal flow</h3>\n<p>Normal Flow describes the default positioning scheme and 'in-flow' describes elements that conform to this. You could consider in flow to be the natural position of elements laid out according to their source order and <a href=\"#heading-formatting-contexts\">formatting context</a>.</p>\n<h3>Floats</h3>\n<p>Float is a CSS property that causes an element to be taken out of the normal flow and shifted to the left or right as far as possible, until it touches the edge of its containing box or another floated element. When this happens, text and inline elements will wrap around the floated elements.</p>\n<p>Normally if not set, the height of an element will adjust to fit all of its descendant elements. When elements are floated they are taken out of flow and this means containers will not adjust their height to clear them.</p>\n<p>It is this behaviour that allows multiple lines of text, heading and other elements to fluid wrap around floated content. But sometimes this is problematic. Clearfixes and establishing a new block formatting context will causes a container to clear its floated children. This technique has allowed floats to be used for layout which has been a corner-stone of web development techniques for a long time. It's still important to know but this is gradually being replaced with newer layout techniques such as Flexbox and Grid.</p>\n<h3>Absolute positioning</h3>\n<p>Elements with absolute positioning are removed from the flow entirely and unlike floated elements they have no impact on surrounding content.</p>\n<p>A container with relative positioning allows you to control the offset of descendant elements using absolute positioning.</p>\n<p>Relatively positioned elements can also be given an offset but this offset is relative to the element's normal position not another relative container.</p>\n<p>CSS properties <code>top</code>, <code>bottom</code>, <code>left</code> and <code>right</code> are used to calculate 'box offsets'. These properties are not two dimensional offsets but allow positioning of each edge, relative to its container’s content box.</p>\n<p>Positioned elements with overlapping offsets can result in elements occupying the same space. A stacking context is used to resolve this.</p>\n<h3>Stacking contexts</h3>\n<p>Stacking context determines the order that things are rendered to the page. You can think of a stacking context like a layer. Layers on the bottom of the stack are painted first and elements higher up the stack appear on top.</p>\n<p>Placing a <code>z-index</code> on an element that is absolutely or relatively positioned is the most common way to establish a new stacking context. But there are a number of other ways a stacking context can be formed including, setting opacity, transforms, filters or using the <code>will-change</code> property.</p>\n<p>Some of these reasons are not intuitive and have more to do with rendering performance than developers expectations. It helps to understand that these layers can be rendered separately by the browsers. As a result it can sometimes be useful to intentionally to create a new stacking context for performance reasons.</p>\n<p>Setting a z-index has no effect unless a stacking context is established. The higher the z-index the higher up the stack the layer is placed.</p>\n<p>One of the most confusing parts about stacking is that a new stacking context can be established inside an existing one. This means you can have layers of layers.</p>\n<p>In this situation, it's not always a case of the highest z-index wins.</p>\n<h2>That's it!</h2>\n<p>Almost 3000 words and I've only briefly touched some of the important hidden parts of CSS. If you’ve read this in full congratulations and please be sure to let me know, because you deserve some kind of reward!</p>\n<p>If you've just read some parts that’s ok too. I hope I’ve managed to clarify something or give a general insight into the processes involved. It’s been a real challenge to explain this stuff in simple terms without sacrificing accuracy. I hope got it right.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/the-invisible-parts-of-css/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Interpolation in CSS without animation",
    "partialText": "\r\n      <p>Interpolation is the estimation of a new value between two known values. This simple concept is vastly useful and it's commonly seen in animation on the web. With animation you declare the target properties and the end-state, and the browser will workout out the values in-between. Animation happens over time, but this is not the only dimension where interpolation can occur. In fact we interpolate values regularly in design, albeit manually, and particularly in responsive design. You may even do it unknowingly. Because of this, I think there is a need for a more native way of interpolating CSS values outside animation.</p>\n<p>If you are a web designer the chances are you frequently have two primary screen sizes in mind, a small screen and a large screen, or the device and the desktop. I know you probably think about more than just these two sizes, but these two sizes are especially important, they represent the upper and lower bounds of your design. When you make adjustments for screen sizes between these constraints, what you are doing is like interpolation.</p>\n<p>When adjusting properties such as font-size, font-weight, image width or grid dimensions at specific screen sizes between the upper and lower bounds, these values usually fall somewhere between the choices you've made for the largest small and smallest screen size. It would be unusual for the font to get larger, then smaller, then larger again as the viewport changes. Or to give another example, if a font varied between bold, normal, italic, then bold and italic. It's not unusual for these things to change from one state to another, but typically these changes are progressive, not back and forward.</p>\n<h2>Design intent vs constraints</h2>\n<p>We choose break-points where properties are to be adjusted. We don't do this because it is ideal, we're forced to select a fixed number break-points, often quite arbitrarily, where the design should change. Although sometimes we may want these break-points, more often it is due to technical limitations on the web.</p>\n<p>Media queries are our primary tool for adjusting design in relation to the screen size and for practical reasons, we are constrained to using a limited number of these. These limitations have shaped how we think about web design, and the choices we make about using break-points don't necessarily reflect the pure intentions of the designer.</p>\n<p>I've been told that good design is rarely arbitrary. It serves a purpose. If the font size is smaller, larger or its weight stronger, it's because that is the best experience for users, at that screen size. It's feasible to say that the best experience for some aspects of design, will vary directly in relation to the screen size rather than only at set points. This is the use-case for interpolation without animation.</p>\n<p>Let's illustrate this with an example, imagine the following CSS:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> bold<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 700px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 1.2rem<span class=\"token punctuation\">;</span><br>    <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> normal<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>It's unlikely a designer would decide bold font is uniquely suited to screen resolutions below 700px. Why would one pixel make such a difference? Design decisions like this are often the result of constrains imposed by media queries. A more likely intention is for the font-weight to be adjusted in relation to its size, for improved legibility on smaller screens.</p>\n<p>Media queries are the best tool available for approximately achieving this goal, but they are not always an accurate reflection of the designers intent.</p>\n<h2>Maximum safe operating pressure</h2>\n<p>I noticed the label on my barbecue gas cylinder says it has a maximum safe operating pressure. If I exceed this pressure when refilling it, it might explode (it actually won't, they have safety valves, but just imagine would). Web design doesn't explode quite as spectacularly as gas cylinders, but responsive design is exposed to a different kind of operating pressure.</p>\n<p>As the screen size gets smaller, there is often a point where a design is pressured by the limitations imposed by smaller screens. A break-point represents the point where the design cannot withstand this pressure any longer; it reached its maximum safe operating pressure and the appropriate response is to adjust some aspects of the design.</p>\n<p>Designers choose these break-points carefully. They probably have in mind where constraints like this begin to pressure the design, and how quickly it impacts overall quality. But in a compromise to technology, we are forced to choose a middle point, knowing that immediately before and after the break-point the design is often still pressured by constrains that demanded change.</p>\n<div class=\"live-demo\">\n<img alt=\"gradient demonstrating the location of ideal font-sizes in relation to a break-point and the design pressure experienced between these points\" src=\"/img/interpolation.png\">\n</div>\n<p>This graphic attempts to illustrate the location of ideal font-sizes in relation to a break-point. You can move the ideal font-size closer to the break-point but this only shifts the pressure to somewhere else in the design. Alternatively you can add more break-points until this becomes problematic, but ideally these changes would be introduced gradually and continuously to reduce pressure on the design as it's required.</p>\n<p>Media queries are not the right tool for this. Media queries have been around longer than responsive design and responsive design was as much a reaction to the available technology, as the idea of media queries was to user needs. As is often the case, real world implementations of responsive design pushed the technology further than spec writers had imagined, and uncovered new uses, new requirements and new limitations.</p>\n<p>This is normal process. And with the perspective we have now, it's easy to ask, if we were designing a technical solution for responsive design today, would media queries be the best tool to implement designers intentions? I think not; or at least not the only tool.</p>\n<h2>Live interpolation in the browser today</h2>\n<p>Theoretically, between two ideal points, there is an ideal value for every screen size, that can be expressed as a ratio, or a function relative to the screen-size (or even another relative factor).</p>\n<p>Previously I've written about techniques you can use to achieve some forms of interpolation using calc() and viewport units.</p>\n<p>My favourite example of this demonstrates how you can interpolate between different modular scales with heading levels.</p>\n<div class=\"live-demo\">\n  <video src=\"/img/modular-scale.mp4\" style=\"max-width:100%\" autoplay loop></video>\n</div>\n<p>Not only do the individual font-sizes change in a controlled way relative to the viewport, but the ratio between the heading levels also fluidly changes. This means there is a changing but consistent relationship between each of the headings. If you haven't seen this yet, you should read my article <a href=\"https://madebymike.com.au/writing/precise-control-responsive-typography/\">precise control over responsive typography</a>.</p>\n<p>This technique allows linear interpolation between any two length values. This is great, but linear interpolation is not the only form of interpolation, and length values are not the only properties that change in responsive design. In addition to that, the first example in this article demonstrated a situation where font-size should change relative to the screen size, and font weight should change relative to font-size. At the moment this isn't possible with CSS.</p>\n<h2>Limitations of interpolation with calc()</h2>\n<p>There are some limiting factors when it come to changing the font-weight in relation to the font-size. Firstly the calc() techniques work only with length values and font-weight is a unitless value.</p>\n<p>The problem with interpolating unitless values could potentially be solved with something called 'unit algebra'. Unit algebra would allow calc() expressions that contain CSS units to resolve to a different unit type or even a unitless number. E.g <code>calc(2rem * 2rem) = 4</code>. This could allow us to interpolate unitless values like font-weight or line-height, and maybe even open the door to non-linier equations (by multiplying units by themselves). Whilst this would be a great feature, the syntax for these equations is likely to be complicated and still leaves us wanting a more native solution. We're also not likely to see this anytime soon. As far as I am aware there is no formal proposal, and this exists only as an idea discussed in w3c mailing lists.</p>\n<p>The second problem with interpolating properties like font-weight is that by default a web font won't have all the variations required to smoothly interpolate between these values. Usually a font-family will include the standard font and a single variation for bold, or at worse, just a faux-bold. Adding more variations will increase network requests, loading time and FOUF (Flash Of Unstyled Font). This is another constraint designers will be familiar with.</p>\n<h2>Variable fonts and the future of font interpolation</h2>\n<p>Luckily the problem of limited font variations has a solution that is relatively close on the horizon. Variable fonts offer the ability to specify how bold or italic a font should be. And not just bold or italic but other 'axes of variation'. You can read more about variable fonts in Andrew Johnson's excellent A List Apart article: <a href=\"http://alistapart.com/article/live-font-interpolation-on-the-web\">Live font interpolation on the web</a>.</p>\n<p>In his article Andrew mentions a need for\n&quot;bending points—not just breaking points—to adapt type to the design&quot;. He also hints at <a href=\"http://alistapart.com/article/live-font-interpolation-on-the-web#section8\">some challenges we face interpolating font-values effectively</a> on the web.</p>\n<p>My main concern is that many of these 'axes of variation' are not length values and therefor, whilst I'm excited for the opportunities that variable font will provide, I see their potential limited by existing constraints.</p>\n<h2>How interpolation and animation works in browsers</h2>\n<p>CSS is already great at interpolating values and it knows how to do this with a whole bunch of different <a href=\"https://www.w3.org/TR/css3-transitions/#animatable-properties\">animatable properties</a> and <a href=\"https://www.w3.org/TR/css3-transitions/#animatable-types\">property types</a>.</p>\n<p>We can interpolate the value of any property that <a href=\"http://canianimate.com/\">can be animated</a> using CSS transitions or keyframe animations.</p>\n<p>During an animation the browser works out how much time has elapsed for every frame and picks an intermediary value. For example if 1 second of a 4 second animation has elapsed, we pick a point that is 25% of the way between the original and final value.</p>\n<p><object data=\"/img/easing.svg\" type=\"image/svg+xml\"></object></p>\n<p>This is easy to understand with numeric properties like width or position, but it works exactly the same with properties like color. Just imagine the same process happening for each of the R, G and B values that represents the color. You can think of them as 3 separate 2D interpolations that combine to give a color at each step of the animation.</p>\n<blockquote>\n<p>An interesting side note with CSS animations, is that no matter what values you use to define color the browser will always transition through an RGB colour space. This means that although the final colour will be the same, the path taken and intermediary colors will be different.</p>\n</blockquote>\n<p>We can manipulate the timing of an animation to get different results at different points of interpolation. By plotting an animation timing function on the same graph above, we can see how this changes the value returned at different points in the animation, while the start and end values remain the same.</p>\n<p><object data=\"/img/easing2.svg\" type=\"image/svg+xml\"></object></p>\n<p>This is a non-linear interpolation and it’s really handy for creating all kinds of animation effects and more natural looking movement with acceleration and easing. We can define <a href=\"https://developer.mozilla.org/en/docs/Web/CSS/animation-timing-function\">animation timing functions in CSS</a> using <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/single-transition-timing-function\">keywords, steps or cubic bezier curves</a> for greater control.</p>\n<h2>Interpolation outside animation</h2>\n<p>So far I've discussed the problem with media queries not always reflecting design intentions, and the limitations of interpolation with calc(). I've also shown how new features like variable fonts might be constrained by these limitations. The interesting thing is, we have all the tools we need to solve these problems, in CSS right now. Only they are tied closely to animation in the browser.</p>\n<p>The rest of this article is going to talk about the idea of exposing a native interpolation function in CSS, how it might work, and what problems might solve. It's very hypothetical and it's ok if you don't agree with either the idea in general or how it should work.</p>\n<p>I've talked about interpolation and animation together, however interpolating values over time is just one possibility. The duration and elapsed time of an animation simply provides a percentage completion. Somewhere within the browser an interpolation function is called and it will dutifully return a value at the given percentage completion, according to the timing function.</p>\n<p>Let’s imagine we could access this function directly in CSS and pass it our own percentage. If we could change this value using media queries, <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_variables\">CSS variables (custom properties)</a> and calc(), what are some of the things we might be able to do?</p>\n<p>First let’s imaging a syntax. We need an <code>initial-value</code>, a <code>target-value</code>, a <code>percentage-completion</code> and a <code>timing-function</code>. The timing function could be an optional value and default to a linear interpolation. That means it might look something like this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span>initial-value<span class=\"token punctuation\">,</span> target-value<span class=\"token punctuation\">,</span> percentage-completion<span class=\"token punctuation\">,</span> [timing-function]<span class=\"token punctuation\">)</span></code></pre>\n<p>And could be used like this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.thing</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span>0px<span class=\"token punctuation\">,</span> 500px<span class=\"token punctuation\">,</span> 0.5<span class=\"token punctuation\">,</span> linear<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p><strong>Note</strong>: This is a not real CSS, it is a hypothetical solution to a real problem for the purpose of discussion.</p>\n<p>Obviously in the example above it would be far easier to set the width to 250px. So, interpolation functions are not that useful without variables. We do have some variable values in CSS. Things like:</p>\n<ul>\n<li>the viewport width and height,</li>\n<li>the width and height of an element or its container,</li>\n<li>the number of siblings an element has, or</li>\n<li>the order of an element amongst its siblings.</li>\n</ul>\n<p>These are all things that in one context or another we can know and use in CSS; unfortunately in many cases these variables are not easily queried to create conditional statements. There are some useful tricks to take advantage of them. Things like <a href=\"https://madebymike.com.au/writing/precise-control-responsive-typography/\">advanced fluid typography</a> and <a href=\"http://alistapart.com/article/quantity-queries-for-css\">quantity queries</a> are great real world examples.</p>\n<p>A more hypothetical example in a native interpolation function might look something like this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--max-viewport</span><span class=\"token punctuation\">:</span> 500px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--min-viewport</span><span class=\"token punctuation\">:</span> 1000px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--range</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--max-viewport<span class=\"token punctuation\">)</span> - <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--min-viewport<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">--percentage-completion</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>100vw - <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--min-viewport<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> / <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--range<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.thing</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span>0px<span class=\"token punctuation\">,</span> 500px<span class=\"token punctuation\">,</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--percentage-completion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ease-in<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Although the above calculation is quite simple, but it's more than a bit ugly. This is because it uses CSS variables and unit algebra concepts I mentioned earlier to work out a percentage completion.</p>\n<p>A far neater solution would be a function to work out a percentage. This would reduce the above to something far more digestible like this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">root:</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--percentage-completion</span><span class=\"token punctuation\">:</span> <span class=\"token function\">percentage</span><span class=\"token punctuation\">(</span>500px<span class=\"token punctuation\">,</span> 1000px<span class=\"token punctuation\">,</span> 100vw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.thing</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span>0px<span class=\"token punctuation\">,</span> 500px<span class=\"token punctuation\">,</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--percentage-completion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ease-in<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p><strong>Note:</strong> Any interpolation function would probably need to clamp returned values to the specified range, as negative completion percentage are a likely result with variables.</p>\n<p>This doesn't need to work with just length values. I mentioned that CSS has a whole bunch of <a href=\"https://www.w3.org/TR/css3-transitions/#animatable-properties\">animatable properties</a> that it already knows how to interpolate. It makes sense that any native function should work with these definitions. This means interpolating a color is also valid:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">root:</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--percentage-completion</span><span class=\"token punctuation\">:</span> <span class=\"token function\">percentage</span><span class=\"token punctuation\">(</span>500px<span class=\"token punctuation\">,</span> 1000px<span class=\"token punctuation\">,</span> 100vw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.thing</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span>red<span class=\"token punctuation\">,</span> greed<span class=\"token punctuation\">,</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--percentage-completion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>The above example of changing the background color doesn't make much sense in relation to the viewport, but there are more legitimate use cases for interpolating a color in relation to an elements width. We just can't as easily query the properties needed to do this, as we can with the viewport. <a href=\"http://alistapart.com/article/container-queries-once-more-unto-the-breach\">Container queries</a> seem to be forever on the horizon. It won't be soon, but my hope is that container queries also ship with container and element units, that work much like viewport units, only for the width of an element.</p>\n<p>Container query units might look something like this:</p>\n<table>\n<thead>\n<tr>\n<th>Unit</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>cqw</td>\n<td>Relative to 1% of the container width</td>\n</tr>\n<tr>\n<td>cqh</td>\n<td>Relative to 1% of the container height</td>\n</tr>\n<tr>\n<td>cqmin</td>\n<td>Relative to 1% of the container width or height, whichever is smaller</td>\n</tr>\n<tr>\n<td>cqmax</td>\n<td>Relative to 1% of the container width or height, whichever is larger</td>\n</tr>\n<tr>\n<td>eqw</td>\n<td>Relative to 1% of the element width</td>\n</tr>\n<tr>\n<td>eqh</td>\n<td>Relative to 1% of the element height</td>\n</tr>\n<tr>\n<td>eqmin</td>\n<td>Relative to 1% of the element width or height, whichever is smaller</td>\n</tr>\n<tr>\n<td>eqmax</td>\n<td>Relative to 1% of the element width or height, whichever is larger</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Note</strong>: I used the <code>cq</code> prefix is because <code>ch</code> is already a valid unit type and <code>eq</code> for consistency.</p>\n<p>With units like these, we could do something like this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">root:</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">--percentage-completion</span><span class=\"token punctuation\">:</span> <span class=\"token function\">percentage</span><span class=\"token punctuation\">(</span>0px<span class=\"token punctuation\">,</span> 100cqw<span class=\"token punctuation\">,</span> 100eqw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.thing</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">interpolate</span><span class=\"token punctuation\">(</span>red<span class=\"token punctuation\">,</span> greed<span class=\"token punctuation\">,</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--percentage-completion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>In this example the percentage-completion is the percentage width of a child element, in relation to it's parent element. Allowing CSS property values to be relative to context like this opens up a whole range of possibilities for things like, dynamic progress bars, creative navigation components and data-visualisation.</p>\n<p>But maybe this isn't the right solution. If we have a unit type for viewport width, container width and element width, where does this stop? DOM order, line length, color? Is it better introduce another function to get a value? E.g. <code>value-of(width)</code> if we do this, what about container width and non CSS properties like DOM order or line length? Magic keywords? <code>value-of(dom-order)</code>. I don't know!</p>\n<p>Perhaps you don't agree with any of this. Perhaps you think we shouldn't introduce more functional features to CSS. That's ok. I hope you will agree that there is a need for discussion, that break-points don't necessarily match the intentions of designers and that interpolation will become a more significant feature of web design with the introduction of variable fonts, and an increasing adoption of viewport units and dynamic layout features.</p>\n<p>I'd like to start a discussion and if you have ideas please <a href=\"https://twitter.com/MikeRiethmuller\">let me know</a> or consider <a href=\"https://github.com/w3c/csswg-drafts/issues/581\">contributing to the issue</a> on the CSS Working Group's, GitHub page.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/interpolation-without-animation/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "On maths and coding",
    "partialText": "\r\n      <p>When I was at school I had a strong interest in learning to code, but I was terrible at maths. My teachers and parents told me I would need strong mathematical abilities to be a good developer and although they didn't mean it to be, I found this discouraging. I really wasn't good with numbers and I couldn't see this changing.</p>\n<p>On the one hand I was right, it didn't change and I've only recently learnt to use maths to great effect when coding. On the other hand, although my abilities haven't changed, my approach and appreciation for maths has.</p>\n<p>Another thing I was wrong about was that I hated maths. This turned out to be a symptom of a different problem. For whatever reason, and to this day still, my brain sometimes freaks out when asked to do simple mental arithmetic.</p>\n<p>This has been a real issue for me. If you ask me to calculate something in my head, there is a small but very real chance my brain will have a kernel panic. Sometimes it recovers and I get the answer in about the same time as an average 5 year old. On other occasions my brain just shuts down. At this point I have the choice to reboot and start the problem again from the beginning, or I could just run away. It can be embarrassing, so in public I avoid situations where I might be asked to do maths and if stuck try to divert attention from myself. This has led to me avoiding maths in general and downplaying any ability in this area.</p>\n<p>It was eventually coding that allowed me to realise that my handicap with mental arithmetic was not an in indication of my overall ability or my capacity to enjoy mathematical problems, and it does not need to be a limiting factor me as a developer.</p>\n<p>Obviously there are many different roles that you can choose as a developer. Some of these probably do require a greater affinity for maths. I'm not making physics engines, 3D rendering applications, or sending spacecraft to Mars. If you are doing these things, and I'm just guessing here, maybe my experience doesn't apply to you.</p>\n<p>Primarily, I'm a web developer and I consider myself more of a front-end developer as well. At any level this is still a highly technical role and there is a lot that <a href=\"https://css-tricks.com/front-end-developer-aware/\">front-end developers need to be aware</a> of, but for the most part, hard maths is not one of those things.</p>\n<p>So for a long time, despite my job as a developer, I successfully avoided thinking about maths in a direct way. This was particularly true early on in my career, but at some point I started to see maths in the things I was doing. Things like animation, colour, layout, typography, almost everywhere actually. Do you know what else I realised? I was actually good at many of these things!</p>\n<p>I was confidently tweaking numbers that represent bezier curves to manipulate motion in animation. I was using modular scales and other ratios in my designs. I understood colour theory and contrast.</p>\n<p>But whilst I understood the results of what I was doing, initially I didn't deeply understand the maths behind a lot of these concepts. I wanted to explore this more and in my spare time I started experimenting with creative coding.</p>\n<p>This opened my eyes to a lot of maths I already knew. I found I already had a reasonable understanding of how colour transitions worked in different 2D and 3D colour spaces. I was already using triangles and circles to calculate distance like Pythagoras himself. Occasionally, I was even playing with vectors, calculus and trigonometry in HTML canvas to create complex physics based animation.</p>\n<p>Experimenting with these things does not require any mental arithmetic. With code it's easy for me to visualise mathematical concepts and for once I can begin to understand how and why maths works. This was completely different from my attempts at school to understand a black-box with several disconnected, one dimensional experiments.</p>\n<p>Suddenly I was not hating maths any more. I looked at the things I was doing with my eyes more open. The more I learnt, the more I discovered mathamatical rules underpin a lot of my work. Daniel Shiffman's book <a href=\"http://natureofcode.com/\">The Nature of Code</a> and <a href=\"https://www.youtube.com/user/shiffman\">his videos</a> showed me even more examples and formulas I could use. I found new practical applications for mathematical concepts everywhere.</p>\n<p>Maths now inspires me as much as it scares and I'm willing to engage with more advanced concepts even those I don't fully understand. YouTube channels like <a href=\"https://www.youtube.com/user/numberphile\">Numberphile</a> and <a href=\"https://www.youtube.com/user/standupmaths\">Standup Maths</a> have shown me it is possible to understand and appreciate mathematics on a higher level while a deeper understanding may be out of reach. I feel proud that can understand concepts, implications, connections and the beauty of complexity, rather than let down that I can't compute the details. This is the same effect that coding had for me. I never got this inspiration in school.</p>\n<p>My brain still crashes sometimes when attempting to do mental arithmetic, but that's ok. Although you can probably do it 10 times faster than me, it doesn't count if you're not solving the right problem. When working on problems I don't fully understand I no longer feel the pressure to solve them in the same 90 minutes as everyone else. I feel my slower pace sometimes allows me to focus better.</p>\n<p>Although I haven't become great at maths, with more willingness to engage, my ability has gradually improved. Maybe one day I'll fix whatever bug there is in my brain code, that causes me crash when attempting mental arithmetic.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/maths-and-code/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "SVG has more potential",
    "partialText": "\r\n      <p>I think many of us are not using SVG to its full potential. I often see SVG used as an alternative image format or as a simple solution for icons, and whilst it's great for these things, it's also a lot more than that. SVG can solve problems that HTML and CSS alone can't. It has responsive properties that go beyond vector scaling, such as control over aspect ratio, embedded CSS and a unique co-ordinate system. I rarely see all the features of SVG used together to create unique responsive solutions.</p>\n<p>Perhaps the full potential of SVG on the web remains untapped because to get the most out of it, you need care a little more about the mark-up. I'm not advocating writing SVG by hand, but the level of control that most graphics applications give us is not adequate for implementing anything more than basic techniques.</p>\n<p>How we overcome this I'm not sure, unlike HTML we need a graphical interface for producing SVG images, but SVG is also a mark-up language, and there are good reasons why we use text editors for HTML. Perhaps SVG will always need both designers and developers to get the most out of it.</p>\n<p>With that in mind, let's take some things you can do with SVG that you might not have seen, and perhaps not even considered possible.</p>\n<h2>Complex positioning</h2>\n<p>SVG has a complex positioning and coordinate system that is entirely different from the box model that you are (hopefully) familiar with. To gain a full understanding of it, I recommend reading Sara Soueidan's excellent articles on <a href=\"https://sarasoueidan.com/blog/svg-coordinate-systems/\">Understanding SVG Coordinate Systems and Transformations</a> as well as Amelia Bellamy-Royd's, <a href=\"https://css-tricks.com/scale-svg/\">How to Scale SVG</a>. I couldn't match the detail provided in these articles, so I choose not to try.</p>\n<p>If you think of SVG like any other image format, to be responsive, it should stretch and scale to fill the available space. You should not be surprised to learn that &quot;Scalable Vector Graphics&quot; are great at this. Amelia's article demonstrated that, depending on the <code>viewBox</code> and <code>preserveAspectRatio</code> attributes, we can exercise more precise control over how SVG images scale.</p>\n<p>Take a look at this example of an ornate border and try to imaging how you might do this with only CSS and HTML.</p>\n<div class=\"live-demo-extended card\">\n  <div class=\"js-resizable\">\n    <img class=\"js-resizable-image\" src=\"/demos/svg/simple-border.svg\">\n  </div>\n</div>\n<p>Dig into the SVG source and you will see we're taking advantage of symbols, masks, transformations and other goodness that HTML and CSS have only ever dreamt of. It works great, but it is by no means the extent of the responsive capabilities of SVG.</p>\n<p>One interesting and little known fact about SVG is that the <code>viewBox</code> is an optional attribute. Did you also know that you can nest SVG elements and establish a new coordinate system on nested SVG and symbol elements, by applying a new <code>viewBox</code>?</p>\n<p>With that in mind, imaging for a minute that this is not an image on the web. How might a traditional artist adapt this design for a different sized page? They would probably not just uniformly scale the design. More likely, the corner flourishes and diamond would remain roughly same size and the length of the line connecting them would be reduced.</p>\n<div class=\"live-demo-extended card\">\n  <div class=\"js-resizable\">\n    <img class=\"js-resizable-image\" src=\"/demos/svg/complex-border.svg\">\n  </div>\n</div>\n<p>We can do this with SVG! Compare this to the prior example, the difference is particularly notable on smaller screens.</p>\n<p>This type of responsive design is particularly suited to SVG and with a little understanding of the SVG coordinates system you can break out of the limitations of the box model.</p>\n<h2>Art directed responsive images with SVG</h2>\n<p>Although the <a href=\"http://caniuse.com/#feat=picture\">picture element</a> and <a href=\"http://caniuse.com/#feat=srcset\">srcset</a> are now widely supported (with the exception of Internet Explorer), did you know you can create responsive art-directed images using SVG?</p>\n<div class=\"live-demo-extended card\">\n  <div class=\"js-resizable\">\n    <img class=\"js-resizable-image\" src=\"/demos/svg/ad-main.svg\" >\n  </div>\n</div>\n<p>Resize your window to see how it works.</p>\n<p>You may recognise the image from an <a href=\"http://cloudinary.com/blog/automatically_art_directed_responsive_images\">influential blog post</a> and <a href=\"https://ericportis.com/etc/cloudinary/\">example by Eric Portis</a>. Although it looks the same, this example is achieved using only SVG and CSS.</p>\n<p>To achieve this technique I'm loading an SVG as the <code>src</code> attribute for an image. The SVG itself has an image element and embedded CSS that resizes and reframes the image using media queries.</p>\n<p>The image element inside the SVG, has a base64 encoded dataURI. I'm using a dataURI because when loading external SVG files in an image element, such as via <code>&lt;image src=&quot;image.svg&quot; &gt;</code> they will not load additional linked resources. This is perhaps to prevent recursive references or for network performance reasons. Either way, to get around this limitation I'm using a dataURI.</p>\n<p><strong>Note:</strong> Thanks to Amelia Bellamy-Royds for letting me know that external resources will load in SVG files referenced via an <code>object</code> or <code>iframe</code> element.</p>\n<p>CSS is global, so when embedding SVG in HTML (inline SVG), any CSS in the HTML document can also style SVG elements. Likewise <code>&lt;style&gt;</code> tags embedded in the SVG, when used inline, will not be scoped to the SVG element. They will be treated just like any other <code>&lt;style&gt;</code> tag found in the HTML body, that is, applied globally.</p>\n<p>Developers often take advantage of this, using SVG sprites and CSS to change the colour of icons. Some developers complain that they cannot use CSS to style SVG elements that are not used inline.</p>\n<p>I agree that this would be handy in some cases, but if you think about it the other way around many people are failing to take advantage of the fact that a referenced SVG (not inline) has its own document context.</p>\n<p>Therefore, CSS in referenced SVG files, is scoped. This includes media queries! I can take advantage of that fact to create a responsive image that is aware of its own width and adjusts display accordingly. The size of the page doesn't matter, it's responsiveness is relative to the size of the image itself. This works the same for backgrounds and other methods of referencing external SVG.</p>\n<p>One disadvantage this technique has over <code>srcset</code> or the <code>picture</code> element is that everything in the SVG will be loaded, there is no opportunity to prioritise loading only required assets first, depending on the user agent.</p>\n<p>On the flip side, this technique works anywhere SVG does including in IE and offers the opportunity for customisation beyond just supplying a different source image. For example you could apply different filters for particular image sizes or anything else you can do with CSS and SVG.</p>\n<p>Depending on the situation, this technique will not necessarily result in a larger download. So be clever and creative; use this technique where it makes sense.</p>\n<h2>Adaptive images</h2>\n<p>We've learnt that media queries in referenced SVG will be bound to the width of the image or element they are used on. This sounds a lot like <a href=\"https://alistapart.com/article/container-queries-once-more-unto-the-breach\">container queries</a>, one of the most requested browser features over the last few years, and in many ways (although not all), it works now in SVG.</p>\n<p>I've seen very few examples that take advantage of this, the icon library <a href=\"https://useiconic.com/\">iconic</a> is one that comes to mind. But I don't think I've seen anyone use it to its full potential yet.</p>\n<p>How about something that's not an icon? Let's update my ornate border example to resize and even remove the corner flourishes, in response to the available width.</p>\n<div class=\"live-demo-extended card\">\n  <div class=\"js-resizable\">\n    <img class=\"js-resizable-image\" src=\"/demos/svg/adaptive-border.svg\" >\n  </div>\n</div>\n<p>There is no way that I know of to achieve this with just CSS and HTML. Why aren't we doing much more of this on the web?!</p>\n<h2>Container queries?</h2>\n<p>How far can we push this? Pretty far is the answer! But as always, with some caveats and limitations.</p>\n<p>Let's try and reproduce another influential example. Remember Mat Marquis' article <a href=\"https://alistapart.com/article/container-queries-once-more-unto-the-breach\">Container Queries: Once More Unto the Breach</a>? Do you think we can do that with SVG?</p>\n<div class=\"live-demo-extended card\">\n  <div class=\"js-resizable\">\n    <img class=\"js-resizable-image\" style=\"min-width: 250px !important;\" src=\"/demos/svg/cq-main.svg\">\n  </div>\n</div>\n<p><strong>Note</strong>: Sorry this demo is a little buggy in Firefox &amp; IE.</p>\n<h3>Caveats and limitations</h3>\n<p>Now that you are hopefully excited, I'm sorry to say this example is intended to demonstrate some limitations. It is obviously not the type of content you would normally use an image for, and this technique does not change that. It is definitely not accessible. On top of that, I've detailed some further technical limitations below.</p>\n<h4>Setting X &amp; Y attributes with CSS</h4>\n<p>For the most part setting and changing X and Y attributes of SVG elements with CSS will not work. Although this will be fully possible in SVG 2.0, for now there is an exception to this rule in Chrome with regard to <code>&lt;image&gt;</code> elements. It is sometimes possible to use CSS transforms to manipulate positioning, but you will find this has limitations as well.</p>\n<h4>External sources in embedded SVG</h4>\n<p>As I mentioned in the earlier example of responsive art directed images, external SVG files loaded as an <code>img</code> source, will not load additional link references in the SVG source. Other limitations require that I use images, so I've used base64 encoded dataURIs.</p>\n<p>In this case I'm encoding additional SVG files as the image source. Each has their own CSS and the ability to be responsive based on their own width. This can get complicated quickly, but it can also be a powerful technique.</p>\n<h4>Changing the height</h4>\n<p>The final limitation and the one I could not get around is that setting or changing the height of an SVG with CSS doesn't work! Even if it did, the image in the HTML sets its height based on the SVG attribute value only. I doubt the image would resize when an internal media query changes the height of the resource. It's like the SVG would have to reach up into the parent context and notify it of a change in height. This is the same for other methods of embedding external SVG.</p>\n<p>There's still plenty you can do, given these limitations.</p>\n<h2>Time of discovery</h2>\n<p>Every new technology has limitations, and the web has many. Because of this, I think we often give ourselves perceived limitations, based on our past experience. In this case it's easy to approach SVG with the same mindset as HTML and CSS, because &quot;I know how images work on the web&quot;.</p>\n<p>When we do this it's easy to miss opportunities to explore new and creative techniques. The examples I've demonstrated, probably only scratch the surface of unique possibilities with SVG. I hope I've got you thinking and I would love to see more examples.</p>\n<p>One final though, it's important to be wary of perceived limitations, not just with SVG. This is especially true at the moment with a wealth of new layout features landing in browsers soon. It will require new perspectives to take advantage of new opportunities. Practice this now, there's never been a better time in the history of the web for creativity and discovery.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/svg-has-more-potential/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Offline content with service workers",
    "partialText": "\r\n      <p>Service workers can do a lot more than make web pages work offline but for most people, myself included, this will be their first experience with them. I recently implemented a simple offline page for my blog and was surprised with how easy it was. Full of confidence, I wanted to do more. I decided to start saving blog posts for offline reading and things escalated quickly. I soon learnt the rabbit hole is deep.</p>\n<p>This is not a criticism of service workers, it's an indication of how powerful and versatile they are. I think in time, as the concepts become more familiar, and the complexities are abstracted away, offline content will become common place. In fact, I drank the kool-aid and can see why many people think that, within a few years, offline content will become as ubiquitous in web development as responsive design today.</p>\n<p>Having said that, there are a few things I wish I had known before getting started.</p>\n<h2>Browser support &amp; caching</h2>\n<p>Service workers are an easy candidate for progressive enhancement and on the surface, it's easy to check for support before registering a service worker. You do that like this:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"serviceWorker\"</span> <span class=\"token keyword\">in</span> navigator<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token comment\">// Yay, service workers work!</span><br>  navigator<span class=\"token punctuation\">.</span>serviceWorker<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/sw.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>It seems simple enough but there is one gotcha. If you look at the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Cache\">MDN page for the service worker cache API</a>, you will see that different versions of Chrome support different caching methods. This means that, despite diligently checking for feature support, versions of Chrome between 40 and 45 will get an error when using the <code>addAll</code> method. This is less of a problem now than it was when these versions were more widely used. I checked <a href=\"http://caniuse.com/usage-table\">Can I Use</a> and at the time of writing this, it looks like it might impact around 1.15% of users.</p>\n<p>I read several blogs and tutorials on getting started with service workers, some advocate using only <code>put</code> rather than <code>addAll</code>, others recommend using a <a href=\"https://github.com/dominiccooney/cache-polyfill\">cache pollyfill</a>, while others still make no mention of it. Obviously these were all written at different times and it took me a lot of research to work out what the right approach was.</p>\n<p>In the end, with such a small number of users, that is only getting smaller, I opted to check for the <code>addAll</code> method and treat browsers that don't support it, like those that don't support service workers at all.</p>\n<p>So, my feature detection now becomes:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><br>  <span class=\"token string\">\"serviceWorker\"</span> <span class=\"token keyword\">in</span> navigator <span class=\"token operator\">&amp;&amp;</span><br>  <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> Cache <span class=\"token operator\">!==</span> <span class=\"token string\">\"undefined\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token class-name\">Cache</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>addAll<span class=\"token punctuation\">)</span><br><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token comment\">// Yay, this is a problem we didn't need to have!</span><br>  navigator<span class=\"token punctuation\">.</span>serviceWorker<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/sw.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>This is a bit verbose, and I'm really going out of my way here just to avoid a console error, but I tested this in all major browsers, including critical versions that don't support the <code>addAll</code> method, and I'm happy with it. It was so much fun!</p>\n<h2>Where to put service workers</h2>\n<p>When you register a service worker you point to a JavaScript file with the service worker logic, and this brings me to the second thing I wish I'd known. That is, if you want to implement service workers across your domain, you <strong>must place the service worker in the root directory of your site</strong>. For security reasons, service workers only control pages in the same directory as the service worker or below. Effectively this means, not in your site's JavaScript directory as I attempted at first. I'm sure this was written as clear as day, somewhere that was obvious to everyone but me.</p>\n<p>While on this topic, it's worth mentioning that service workers only work over HTTPS or localhost domains. Luckily for me my blog was already configured to redirect HTTP traffic to HTTPS. If you can do this, it's a great idea, if not, you could check you are on a secure domain before registering a service worker.</p>\n<h2>Can we service worker yet?</h2>\n<p>Yes, we are now ready to service worker! When getting started I recommend reading, Jake &quot;The Service Worker&quot; Archibald's <a href=\"https://jakearchibald.com/2014/offline-cookbook/\">Offline Cookbook</a>. It's still a great place to start and the links and references contain a wealth of information.</p>\n<p>You'll soon learn that, where offline content is concerned, there are 3 main events we listen for in a service worker:</p>\n<ul>\n<li>install,</li>\n<li>activate, and</li>\n<li>fetch.</li>\n</ul>\n<p>The <strong>install</strong> event is fired only once when the service worker is first registered. Here we setup the cache prime it with essential resources. My install event is pretty simple, nothing special here. I cache the homepage, CSS and an offline page:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> <span class=\"token constant\">CACHE_NAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"v1::madebymike\"</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">var</span> urlsToCache <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/offline.html\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/css/styles.min.css\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><br><br><span class=\"token comment\">// Install</span><br>self<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"install\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  event<span class=\"token punctuation\">.</span><span class=\"token function\">waitUntil</span><span class=\"token punctuation\">(</span><br>    caches<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CACHE_NAME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cache</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>      <span class=\"token keyword\">return</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">addAll</span><span class=\"token punctuation\">(</span>urlsToCache<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><br>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>The <strong>activate</strong> event is fired after install and every time you navigate to the domain managed by the service worker. It's not fired for subsequent navigation between pages on the same domain.</p>\n<p>My activate event is also pretty standard. I'm only using one cache for my service worker. This pattern checks the names of any caches to ensure they match the variable <code>CACHE_NAME</code>, if they don't, it will delete them. This gives me a manual means of invalidating my service worker cache.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">self<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"activate\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  event<span class=\"token punctuation\">.</span><span class=\"token function\">waitUntil</span><span class=\"token punctuation\">(</span><br>    caches<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cacheNames</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>      <span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><br>        cacheNames<br>          <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cacheName</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>            <span class=\"token keyword\">return</span> cacheName <span class=\"token operator\">!==</span> <span class=\"token constant\">CACHE_NAME</span><span class=\"token punctuation\">;</span><br>          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><br>          <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cacheName</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Deleting \"</span> <span class=\"token operator\">+</span> cacheName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>            <span class=\"token keyword\">return</span> caches<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>cacheName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><br>      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><br>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Finally, the <strong>fetch</strong> event is fired every time a page is requested. The fetch event is intercepted regardless of whether the user is offline or not. Like I said earlier service workers != offline content. Offline content is just one implementation of service workers. And this is really good news! Service workers have the ability speed up everyday web browsing, like, a lot.</p>\n<p>Here is my first example of a fetch event. It's really little more than custom error page, but it's a start.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">self<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fetch\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  e<span class=\"token punctuation\">.</span><span class=\"token function\">respondWith</span><span class=\"token punctuation\">(</span><br>    <span class=\"token comment\">// If network fetch fails serve offline page form cache</span><br>    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>      <span class=\"token keyword\">return</span> caches<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CACHE_NAME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cache</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>        <span class=\"token keyword\">return</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/offline.html\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><br>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<h2>A better service worker (down the rabbit hole)</h2>\n<p>At this point I was pretty happy with myself and if you want to implement offline content, aiming for the above is a great start. Brazened by my success I could see the potential. I needed to cache blog posts for offline reading, and where possible, I needed to return pages from the cache for connected users.</p>\n<p>It took me a lot of testing and several mistakes to finally arrive at this pattern. You need to be really careful when serving cached pages by default. You could end up showing really old content, or even breaking your site.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">self<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fetch'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br><br>  <span class=\"token keyword\">var</span> requestURL <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">URL</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br>  event<span class=\"token punctuation\">.</span><span class=\"token function\">respondWith</span><span class=\"token punctuation\">(</span><br>    caches<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CACHE_NAME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cache</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>      <span class=\"token keyword\">return</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br><br>        <span class=\"token comment\">// If there is a cached response return this otherwise grab from network</span><br>        <span class=\"token keyword\">return</span> response <span class=\"token operator\">||</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br><br>          <span class=\"token comment\">// Check if the network request is successful</span><br>          <span class=\"token comment\">// don't update the cache with error pages!!</span><br>          <span class=\"token comment\">// Also check the request domain matches service worker domain</span><br>          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>ok <span class=\"token operator\">&amp;&amp;</span> requestURL<span class=\"token punctuation\">.</span>origin <span class=\"token operator\">==</span> location<span class=\"token punctuation\">.</span>origin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><br>            <span class=\"token comment\">// All good? Update the cache with the network response</span><br>            cache<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>          <span class=\"token punctuation\">}</span><br><br>          <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">;</span><br><br>        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br><br>          <span class=\"token comment\">// We can't access the network, return an offline page from the cache</span><br>          <span class=\"token keyword\">return</span> caches<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/offline.html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br>        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br>      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br></code></pre>\n<p>This pattern always attempts to serve content from the cache first, but at the same time I start a network request. If the network request resolves successfully, and is not an error page, I update the cache. This means that when a user visits my website, they will see the last cached version, not necessarily the latest version. On a subsequent visit or a refresh, they will retrieve the updated page from the cache. If I make major changes, such as to CSS and I want to manually invalidate the service worker cache, I can change the <code>CACHE_NAME</code> in my service worker script.</p>\n<h2>A better offline page (deeper down the rabbit hole)</h2>\n<p>The generic offline page, from my first fetch example, is still served when the content is not cached and the network request fails. I wanted to do more with this. If we can't show the page they want, I thought it would be helpful to list pages the user has available in their cache. So I went down the rabbit hole again.</p>\n<p>There is a method for communicating with service workers and web workers called the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Channel_Messaging_API\">channel messaging API</a>.</p>\n<p><strong>IMPORTANT UPDATE:</strong></p>\n<p>I don't need to use the channel messaging API to get a URL from the cache in this example (Thanks to <a href=\"https://twitter.com/nhoizey\">Nicolas Hoizey</a> for brining that to my attention). The channel messaging API is useful when you want to respond to an event that only the service worker is aware of. In this case, since I am only grabbing a list of pages fron the cache I can access the <code>window.caches</code> object in the offline page. The only thing the service worker is aware of that my ofline page is not, is the <code>CACHE_NAME</code> variable. It contains the cache version and I didn't want to update it in multiple places each time it changed, but since it follows a predictable pattern I can do something like the following:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Get a list of cache keys</span><br>window<span class=\"token punctuation\">.</span>caches<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cacheNames</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><br><br>  <span class=\"token comment\">// Find the key that matches my cacheName</span><br>  cacheName <span class=\"token operator\">=</span> cacheNames<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cacheName</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> cacheName<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"::madebymike\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><br><br>  <span class=\"token comment\">// Open the cache for that key</span><br>  caches<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>cacheName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cache</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br><br>    <span class=\"token comment\">// The rest of this function is very similar to the Channel messaging API example</span><br>    <span class=\"token comment\">// where I fetch and return a list of URLs that are cached for offline reading</span><br><br>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><br><span class=\"token punctuation\">}</span></code></pre>\n<h2>Channel messaging API</h2>\n<p>This is the old method I used to fetch cached pages from the service worker. Although it turned out I didn't need to message the service worker to do this, it's still a valuable technique for other purposes.</p>\n<p>In the service worker, I listen for a <code>message</code> event. Once received, I get a list of pages from the cache that match the URL pattern for blog posts on my site and post a response back to the offline page.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">self<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  caches<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CACHE_NAME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cache</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> cache<br>      <span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><br>      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">requests</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>        <span class=\"token keyword\">var</span> urls <span class=\"token operator\">=</span> requests<br>          <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">request</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>            <span class=\"token keyword\">return</span> request<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/writing/\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span><br>          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><br>          <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">request</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>            <span class=\"token keyword\">return</span> request<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">;</span><br>          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>        <span class=\"token keyword\">return</span> urls<span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><br>      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">urls</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>        event<span class=\"token punctuation\">.</span>ports<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span>urls<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>In my offline page I send a message to the service worker and listen for a response. It's not very clever. At the moment it doesn't matter what message I post, I will always get the same response. But this is sufficient for now and I didn't want to complicate it more than necessary.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> messageChannel <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MessageChannel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>messageChannel<span class=\"token punctuation\">.</span>port1<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmessage</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token comment\">// Add list of offline pages to body with JavaScript</span><br>  <span class=\"token comment\">// `event.data` contains an array of cached URLs</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br>navigator<span class=\"token punctuation\">.</span>serviceWorker<span class=\"token punctuation\">.</span>controller<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"get-pages\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><br>  messageChannel<span class=\"token punctuation\">.</span>port2<br><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>My worst case offline experience now looks something like this:</p>\n<img src=\"/img/offline.png\" style=\"border: solid 1px #999\">\n<h2>What next?</h2>\n<p>I'd like to give users an indication of when they are reading something offline. I think this could be helpful, and in poor network conditions it might not always be obvious. This would probably would use the message API as well, but I might also investigate push notifications. I'll update this post if I ever get around to it.</p>\n<p>I hope explaining my experience implementing offline content can help make it easier for you or just inspire you to get started. I think the most difficult thing was understanding the impact of choices when serving cached content to all users. Making sure you get this right is important and it takes some time to understanding how service workers, and caching in general works. I'm not an expert at this so please, if I've got anything wrong, let me know so I can update it.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/service-workers/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Image manipulation techniques with 2d canvas",
    "partialText": "\r\n      <p>Canvas is a really interesting piece of our web development toolkit, but it is often overlooked or misunderstood. It is, as the name suggests, very much a blank canvas; not providing much in the way of prebaked solutions. It is up to us as developers to ensure what we make with canvas, is accessible and performant.</p>\n<p>Canvas has no DOM, so when compared to working with HTML and CSS it may be less intuitive, and more work. For example if we want to interact with elements on a canvas we need to define our own object model and events. Why would we want to do this if we can find a solution where things like events, layout and rendering are already taken care of by the browser?</p>\n<p>The problem is also the answer. We can take direct control over things like layout and rendering. This means we can effectively bypass many layers of abstraction (albeit often useful abstractions) put in place by the browser, and create very streamlined, purpose-built solutions.</p>\n<p>In this article I’m going to use the example of applying an image effect with canvas. I chose this example because it is simple enough, and there are directly comparable methods using CSS and SVG. The aim is not to argue that canvas is in any way better than CSS or SVG for this task. In fact the results and usage cases are slightly different. I want to demonstrate these differences and approaches to solving the problem with canvas.</p>\n<h2>Why use canvas?</h2>\n<p>Recently my friend Una Kravets wrote an excellent article for Smashing Magazine, <a href=\"https://www.smashingmagazine.com/2016/05/web-image-effects-performance-showdown/\">Web Image Effects Performance Showdown</a>. In the article Una compared the ease of implementation and performance of HTML Canvas, SVG filters, CSS filters and CSS blend modes. One of Una’s conclusions was that we should not use Canvas for image effects and I’m inclined to agree with her conclusion, especially on the basis of simplicity.</p>\n<p>Una knows a lot when it comes to applying image effects in the browser. You should checkout some of her other work including her A List Apart article, <a href=\"http://alistapart.com/article/finessing-fecolormatrix\">Finessing feColorMatrix</a> and <a href=\"https://una.im/CSSgram/\">CSSgram</a> which implements Instagram style filters using only CSS!</p>\n<p>That’s amazing right? But it leaves the question; why would we ever want to use Canvas?</p>\n<p><strong>The answer is when we want to do more than just apply image effects.</strong></p>\n<p>Filters and blend modes don’t change images directly. Instead they are applied like mask layers in Photoshop where the source image is not modified. This means that if a user tries to save the image, they will get the original image without any effects. This might be exactly what you want, but for the average web user it’s probably a little confusing. That’s why I think CSS filters and blend modes work best for subtle effects and on background images, but not so much for applications where you want to make use of the end result.</p>\n<p>For purely aesthetic purposes and in probably the vast majority of cases, CSS filters are exactly what you need but if you want to do something more involved, you probably need to start thinking about canvas. If you want to save an image or programmatically access the pixel data after an image effect is applied with CSS, you can’t. In the future <a href=\"https://www.smashingmagazine.com/2016/03/houdini-maybe-the-most-exciting-development-in-css-youve-never-heard-of/\">Houdini</a> may allow access the rendered output of CSS filters, but for now and in the immediate future, this stuff is locked away by the browser.</p>\n<h2>Using canvas for image effects</h2>\n<p>Ok, you need to apply an image effect and do something with the result? You will need to use canvas. Hopefully you’ve now read Una’s article and seen the performance of canvas compared with CSS filters and blend modes. You’re probably wondering, what is the best way to apply image effects with canvas, and can I get better performance? You can get great performance from canvas. I’m going to step through a few different techniques for applying image effects with canvas. Each technique has different levels of complexity and performance factors. As always, the best solution will depend on your specific needs and appetite for complexity.</p>\n<h2>Basic pixel manipulation with canvas</h2>\n<p>It makes sense that at its most basic Canvas is slower than other image manipulation techniques. We’re accessing the image data and manipulating it pixel by pixel then rendering the result back onto the Canvas. This means that we are doing a lot of extra work, rather than leveraging the built-in rendering capabilities of the browser. As well as this, because canvas can do a lot more than just apply image effects, we need to give explicit instructions, that would otherwise be assumed when using CSS filters and blend modes.</p>\n<p>Despite these drawbacks the most basic technique is still useful to learn and we will build upon it in the following examples. Let’s start with an image and apply a desaturation effect using Canvas and JavaScript.</p>\n<p>The HTML might look like this:</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>image<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>image.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre>\n<p>We need to make sure the image has fully loaded before we access the image data and because, web browsers, there are some inconsistencies in how the load event is triggered; especially when the image is loading from the cache. I’ve found the following method works well in browsers I tested.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> image <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"image\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">.</span>complete<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token comment\">// From cache</span><br>  <span class=\"token function\">desaturateImage</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token comment\">// On load</span><br>  image<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"load\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token function\">desaturateImage</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Now let’s write the desaturateImage function. First we replace the image element with a canvas element:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">desaturateImage</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">image</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">var</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  image<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span><span class=\"token function\">insertBefore</span><span class=\"token punctuation\">(</span>canvas<span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  canvas<span class=\"token punctuation\">.</span>width  <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">;</span><br>  canvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">;</span><br>  image<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token operator\">...</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Next we get a 2D rendering context, draw the image onto the canvas and get the pixel data using the <code>getImageData</code> method.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2d\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">drawImage</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">var</span> imgData <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">getImageData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> imgData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span></code></pre>\n<p>Now that we have the image data we want to apply an effect and write it back onto the canvas. Each pixel has 4 pieces of color information, one for each rgb value and an alpha value. Because of this you might expect <code>getImageData</code> to return some kind of structured data, instead—for reasons that become clear in the next example—it returns a simple unstructured array. The first four values in the array represent the first pixel and so on. This means we have to loop over it in chunks of four. We can do this like so:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> data<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i <span class=\"token operator\">+=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token operator\">...</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>To desaturate the image I’m using the following technique <code>grey = (red _ 0.2126 + green _ 0.7152 + blue * 0.0722)</code>. There are numerous <a href=\"http://www.tannerhelland.com/3643/grayscale-image-algorithm-vb6/\">greyscale conversion algorithms</a> with subtly different results, which I found an interesting and distracting side topic. One thing I like about Canvas is you have fine-grained control over any technique you apply.</p>\n<p>Next, inside the loop, assign the grey to the next four values in the <code>imgData</code> array, leaving the alpha value unchanged.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> data<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i <span class=\"token operator\">+=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">var</span> grey <span class=\"token operator\">=</span> <span class=\"token number\">0.2126</span> <span class=\"token operator\">*</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">0.7152</span> <span class=\"token operator\">*</span> data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">0.0722</span> <span class=\"token operator\">*</span> data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><br>  data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> grey<span class=\"token punctuation\">;</span><br>  data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> grey<span class=\"token punctuation\">;</span><br>  data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> grey<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Finally, outside the loop, let’s write the modified pixel data back onto the canvas.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">ctx<span class=\"token punctuation\">.</span><span class=\"token function\">putImageData</span><span class=\"token punctuation\">(</span>imgData<span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>We did it! We applied a simple image effect with canvas. If you’d like to see this technique in action here is the code and a working example of <a href=\"/demos/image-effects/basic.html\">basic pixel manipulation with canvas</a>. It’s not as simple as a CSS filter, but it’s not overly complicated either. You can use this technique in moderation for small images, where performance is not critical.</p>\n<div class=\"live-demo\">\n  <iframe src=\"/demos/image-effects/basic.html\" style=\"height:620px; width:100%; border: none;\"></iframe>\n</div>\n<h2>32bit pixel manipulation</h2>\n<p>Canvas is very flexible and there are many ways we can optomise our code to ensure that performance is comparable, or in some cases even better than CSS and SVG filters. With canvas unfortunately the trade-off for better performance is often an increase in code complexity.</p>\n<p>One of the biggest overheads in the first example was writing to the <code>imgData</code> array. Write operations are always expensive and although individually insignificant, we needed to write three values to the image data array for every pixel in the image. That’s a lot! Using 32bit pixel manipulation we will be able to write to the array once for each rgba value and reduce the number write operations in our example by a factor of three. This obviously comes with significant performance gains.</p>\n<p>In addition to using getImageData, we’re going to create some array buffers that will give a different “view” for accessing the pixel data.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> imgData <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">getImageData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">var</span> buf <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayBuffer</span><span class=\"token punctuation\">(</span>imgData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">var</span> buf8 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint8ClampedArray</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint32Array</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>We can then replace our loop with the following:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> data<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i <span class=\"token operator\">+=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">var</span> grey <span class=\"token operator\">=</span><br>    <span class=\"token number\">0.2126</span> <span class=\"token operator\">*</span> imgData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span><br>    <span class=\"token number\">0.7152</span> <span class=\"token operator\">*</span> imgData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span><br>    <span class=\"token number\">0.0722</span> <span class=\"token operator\">*</span> imgData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><br>  data<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span><br>    <span class=\"token punctuation\">(</span><span class=\"token number\">255</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token comment\">// alpha</span><br>    <span class=\"token punctuation\">(</span>grey <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token comment\">// blue</span><br>    <span class=\"token punctuation\">(</span>grey <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token comment\">// green</span><br>    grey<span class=\"token punctuation\">;</span> <span class=\"token comment\">// red</span><br>  j<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Advance current the increment</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>There are a few things going on in the example above that you might not be familiar with, including [array buffers](Typed Arrays: Binary Data in the Browser) and <a href=\"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators#Left_shift\">Bitwise shift operations</a>. For the purpose of this tutorial all you need to know is the array buffers allow us to access the image data array in a 32bit format and the bitwise operations convert separate rgba values into a single 32bit value.</p>\n<p>Finally, this is how we write the pixel data back to the canvas:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">imgData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>buf8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Extra step</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">putImageData</span><span class=\"token punctuation\">(</span>imgData<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>This technique is significantly faster than the basic example and should be applied whenever using basic pixel manipulation techniques. Here is the code and a working example of <a href=\"/demos/image-effects/32bit.html\">applying image effects using canvas and 32bit pixel manipulation</a>.</p>\n<div class=\"live-demo\">\n  <iframe src=\"/demos/image-effects/32bit.html\" style=\"height:620px; width:100%; border: none;\"></iframe>\n</div>\n<h2>Image effects &amp; WebGL</h2>\n<p>Finally, if we want blazingly fast results that compare with CSS we are going to have to leverage WebGL. WebGL gives you access to hardware acceleration that is usually orders of magnitude faster than basic pixel manipulation. But it’s also the most complicated of the examples demonstrated. It includes some fairly low-level stuff that might not be intuitive if, like me, you don’t have prior experience with 3D graphics programming.</p>\n<p><a href=\"http://caniuse.com/#feat=webgl\">WebGL has good support</a> including on many mobile devices, however support for WebGL may depend on more than just the browser. For example on mobile devices and laptops the GPU may not be available in low power modes. In these cases you can fallback on 2D methods depending on your application.</p>\n<p><strong>Note:</strong> Do not expect a full WebGL tutorial, that’s more than I could provide in this article, but I’ll aim to give a general overview of the steps involved in setting up a scene for rendering 2D image effects.</p>\n<h3>Creating a WebGL program</h3>\n<p>We need to setup what is known as the rendering pipeline, a controllable sequence of steps for rendering 3D graphics. In WebGL this pipeline is fully configurable, which means we have the laborious task of setting up all the vertices, textures, variables and other information required by the shaders.</p>\n<p>To many people this setup will not be particularly interesting; it’s the same boilerplate whatever the image effect applied. For this reason, and because a full introduction to WebGL deserves its own article, I’m going to skip over of most the initialisation code fairly quickly.</p>\n<p>I’m going to create a helper function to compile a WebGL program.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">createWebGLProgram</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx<span class=\"token punctuation\">,</span> vertexShaderSource<span class=\"token punctuation\">,</span> fragmentShaderSource</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">;</span><br><br>  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">compileShader</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">shaderSource<span class=\"token punctuation\">,</span> shaderType</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">var</span> shader <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">createShader</span><span class=\"token punctuation\">(</span>shaderType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">shaderSource</span><span class=\"token punctuation\">(</span>shader<span class=\"token punctuation\">,</span> shaderSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">compileShader</span><span class=\"token punctuation\">(</span>shader<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">return</span> shader<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br><br>  <span class=\"token keyword\">var</span> program <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">createProgram</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">attachShader</span><span class=\"token punctuation\">(</span><br>    program<span class=\"token punctuation\">,</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">compileShader</span><span class=\"token punctuation\">(</span>vertexShaderSource<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">VERTEX_SHADER</span><span class=\"token punctuation\">)</span><br>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">attachShader</span><span class=\"token punctuation\">(</span><br>    program<span class=\"token punctuation\">,</span><br>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">compileShader</span><span class=\"token punctuation\">(</span>fragmentShaderSource<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">FRAGMENT_SHADER</span><span class=\"token punctuation\">)</span><br>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">linkProgram</span><span class=\"token punctuation\">(</span>program<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">useProgram</span><span class=\"token punctuation\">(</span>program<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br>  <span class=\"token keyword\">return</span> program<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>This function takes the source code for our fragment and vertex shaders, creates a program, compiles our shaders, and finally links it all together.</p>\n<p>The next part of our code should look more familiar. We wait for the image to load then call the <code>desaturateImage</code> function, prepare our canvas, and replace the image element; the only difference is this time we request a <code>webgl</code> context rather than a 2D rendering context.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> image <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'image'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">.</span>complete<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><br>  <span class=\"token function\">desaturateImage</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span><br>  image<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><br>    <span class=\"token function\">desaturateImage</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token keyword\">function</span> <span class=\"token function\">desaturateImage</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">image</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">var</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  image<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span><span class=\"token function\">insertBefore</span><span class=\"token punctuation\">(</span>canvas<span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  canvas<span class=\"token punctuation\">.</span>width  <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">;</span><br>  canvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">;</span><br>  image<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br>  <span class=\"token keyword\">var</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"webgl\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"experimental-webgl\"</span><span class=\"token punctuation\">)</span><br>  <span class=\"token operator\">...</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>We are now ready to call our helper function <code>createWebGLProgram</code> and we do that like this:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> fragmentShaderSource <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fragment-shader\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">;</span><br><span class=\"token keyword\">var</span> vertexShaderSource <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"vertex-shader\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">;</span><br><span class=\"token keyword\">var</span> program <span class=\"token operator\">=</span> <span class=\"token function\">createWebGLProgram</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> vertexShaderSource<span class=\"token punctuation\">,</span> fragmentShaderSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Before this can work, we need the source code for our shaders.</p>\n<h3>Shaders</h3>\n<p>It’s convenient to write the shaders in unique script tags, not only does this keep them separate, but it avoids the mess and stress of writing strings with line-breaks in JavaScript.</p>\n<p>Where image effects are concerned, shaders are the most important part of the process, as this is where the pixel manipulation takes place.</p>\n<p>There are two types of shaders:</p>\n<ul>\n<li>Vertex shaders</li>\n<li>Fragment shaders</li>\n</ul>\n<p>Generally speaking vertex shaders are responsible for determining the final position of each point (vertex) that forms part of a 3D shape. It does this by setting a variable named <code>gl_Position</code>. In our example, the 3D shape we are representing is a simple 2D rectangle or plane, upon which we will draw a texture.</p>\n<p>Our Vertex shader takes the vertices that represent the rectangle, these points will match our image dimensions, and it converts them to &quot;clip space&quot;, a representation of the same points in a space with dimensions between -1 and 1. It also sets the <code>v_texCoord</code> variable to be used by the fragment shader.</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>vertex-shader<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>x-shader/x-vertex<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"><br>  attribute vec2 a_position<span class=\"token punctuation\">;</span><br>  attribute vec2 a_texCoord<span class=\"token punctuation\">;</span><br>  uniform vec2 u_resolution<span class=\"token punctuation\">;</span><br>  varying vec2 v_texCoord<span class=\"token punctuation\">;</span><br><br>  <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>     vec2 clipSpace <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a_position <span class=\"token operator\">/</span> u_resolution<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2.0</span> <span class=\"token operator\">-</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">;</span><br>     gl_Position <span class=\"token operator\">=</span> <span class=\"token function\">vec4</span><span class=\"token punctuation\">(</span>clipSpace <span class=\"token operator\">*</span> <span class=\"token function\">vec2</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>     v_texCoord <span class=\"token operator\">=</span> a_texCoord<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre>\n<p><strong>Note</strong>: We give the script tags a <code>type</code> of <code>x-shader/x-vertex</code> and <code>x-shader/x-fragment</code> because we don’t want the browser to try and run them like normal JavaScript.</p>\n<p>Next we need a fragment shader. While the vertext shader sets final position of each vertex on the canvas, the fragment shader sets the final color for each pixel, once the shape has been rasterised. Like the vertex shader, it does this by setting a special variable <code>gl_FragColor</code>.</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fragment-shader<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>x-shader/x-fragment<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"><br>  precision mediump float<span class=\"token punctuation\">;</span><br>  uniform sampler2D u_image<span class=\"token punctuation\">;</span><br>  varying vec2 v_texCoord<span class=\"token punctuation\">;</span><br><br>  <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    vec4 color <span class=\"token operator\">=</span> <span class=\"token function\">texture2D</span><span class=\"token punctuation\">(</span>u_image<span class=\"token punctuation\">,</span> v_texCoord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    float grey <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.2126</span> <span class=\"token operator\">*</span> color<span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.7152</span> <span class=\"token operator\">*</span> color<span class=\"token punctuation\">.</span>g<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.0722</span> <span class=\"token operator\">*</span> color<span class=\"token punctuation\">.</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    color<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>grey <span class=\"token operator\">-</span> color<span class=\"token punctuation\">.</span>rgb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    gl_FragColor <span class=\"token operator\">=</span> color<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre>\n<p>You will notice the method for converting the color values to greyscale is the same as in the previous examples. The line <code>color.rgb += (grey - color.rgb)</code> is a short-hand way of setting all the rgb values of color to grey.</p>\n<h3>Data &amp; Variables</h3>\n<p>We’ve setup our shaders and WebGL program, but we need to provide the data and variables for the shaders to work with.</p>\n<p>First we provide canvas dimensions to the vertex shader.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> resolutionLocation <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">getUniformLocation</span><span class=\"token punctuation\">(</span>program<span class=\"token punctuation\">,</span> <span class=\"token string\">\"u_resolution\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">uniform2f</span><span class=\"token punctuation\">(</span>resolutionLocation<span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Next we provide the data for the rectangle (2 triangles) on which we will draw the image.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> positionLocation <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribLocation</span><span class=\"token punctuation\">(</span>program<span class=\"token punctuation\">,</span> <span class=\"token string\">\"a_position\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">var</span> buffer <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">createBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">bindBuffer</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">ARRAY_BUFFER</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">bufferData</span><span class=\"token punctuation\">(</span><br>  ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">ARRAY_BUFFER</span><span class=\"token punctuation\">,</span><br>  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Float32Array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><br>    <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><br>    image<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span><br>    <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><br>    image<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">,</span><br>    <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><br>    image<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">,</span><br>    image<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span><br>    <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><br>    image<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span><br>    image<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">,</span><br>  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>  ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">STATIC_DRAW</span><br><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">enableVertexAttribArray</span><span class=\"token punctuation\">(</span>positionLocation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">vertexAttribPointer</span><span class=\"token punctuation\">(</span>positionLocation<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">FLOAT</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>We also need to provide data for shape of our texture. This tells the shaders how to map the texture onto the shape.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> texCoordLocation <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribLocation</span><span class=\"token punctuation\">(</span>program<span class=\"token punctuation\">,</span> <span class=\"token string\">\"a_texCoord\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">var</span> texCoordBuffer <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">createBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">bindBuffer</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">ARRAY_BUFFER</span><span class=\"token punctuation\">,</span> texCoordBuffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">bufferData</span><span class=\"token punctuation\">(</span><br>  ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">ARRAY_BUFFER</span><span class=\"token punctuation\">,</span><br>  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Float32Array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><br>    <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span><br>    <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span><br>  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>  ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">STATIC_DRAW</span><br><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">enableVertexAttribArray</span><span class=\"token punctuation\">(</span>texCoordLocation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">vertexAttribPointer</span><span class=\"token punctuation\">(</span>texCoordLocation<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">FLOAT</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>You can experiment with changing some of the numbers in either of the <code>bufferData</code> arrays to understand their purpose.</p>\n<p>Finally we need to provide the image data itself, and we do this by creating a texture.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> texture <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">createTexture</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">bindTexture</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_2D</span><span class=\"token punctuation\">,</span> texture<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">texParameteri</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_2D</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_WRAP_S</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">CLAMP_TO_EDGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">texParameteri</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_2D</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_WRAP_T</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">CLAMP_TO_EDGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">texParameteri</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_2D</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_MIN_FILTER</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">NEAREST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">texParameteri</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_2D</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_MAG_FILTER</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">NEAREST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">texImage2D</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_2D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">RGBA</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">RGBA</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">UNSIGNED_BYTE</span><span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Load the image into the texture.</span></code></pre>\n<p>Now that we have setup a program, shaders and provided the data the final step is to draw the scene on the canvas. We do that like this:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">ctx<span class=\"token punctuation\">.</span><span class=\"token function\">drawArrays</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token constant\">TRIANGLES</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>And that’s it! Checkout the <a href=\"/demos/image-effects/webgl.html\">WebGL image effects demo page</a>.</p>\n<div class=\"live-demo\">\n  <iframe src=\"/demos/image-effects/webgl.html\" style=\"height:620px; width:100%; border: none;\"></iframe>\n</div>\n<p>This example is fast! And I mean really fast! The results are directly comparable with CSS and SVG filters. That’s because with WebGL, the image effects are processed directly on your graphics card’s GPU, which is highly optimised for this type of work.</p>\n<p>The code is definitely more complicated than using CSS or SVG filters but unlike these methods you can access the result, and apply many more types of effects. This technique is a good choice for an application where performance is critical and you need to save the image.</p>\n<p>Once you understand a little about how shaders works it’s not that difficult to modify example above. You can create your own abstractions and make applying different image effects as familiar and easy as using CSS or SVG filters. To demonstrate this I wrote an examples that takes an SVG <code>feColorMatrix</code> value and applies a <a href=\"/demos/image-effects/webgl-matrix.html\">color matrix transformation using WebGL</a>. This can produce an almost infinite number of image effects by simply changing the input variables.</p>\n<div class=\"live-demo\">\n  <iframe src=\"/demos/image-effects/webgl-matrix.html\" style=\"height:800px; width:100%; border: none;\"></iframe>\n</div>\n<p>As is often the case with modern web development, there are many features you can use to achieve the same results. For image effects CSS, SVG and canvas each have different strengths. Even after choosing the right technology, differences in implementation can make a huge difference in performance.</p>\n<p>Whilst it is tempting to pick the simplest implementation from a development perspective, what is simple is sometimes more nuanced than this. The rendering process for CSS and SVG filters, whilst largely hidden from developers, is complicated due to its many features and abstractions. If we need to, we can take more direct control over the rendering process and have purpose-built applications that are amazingly fast. Although the path is less clear, and it may be more work initially, canvas can open a range <a href=\"/demos/image-effects/webgl-interactive.html\">unique possibilities</a> not available using more defined &quot;paint by number&quot; solutions.</p>\n<div class=\"live-demo\">\n  <iframe src=\"/demos/image-effects/webgl-interactive.html\" style=\"height:700px; width:100%; border: none;\"></iframe>\n</div>\n<h2>You might also be interested in reading</h2>\n<ul>\n<li><a href=\"http://codepen.io/jakealbaugh/post/canvas-image-pixel-manipulation\">Canvas image pixel manipulation</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Pixel_manipulation_with_canvas\">Pixel manipulation with canvas</a></li>\n<li><a href=\"https://dev.opera.com/articles/introduction-to-webgl-part-1/\">An Introduction to WebGL - Part 1</a></li>\n<li><a href=\"https://aerotwist.com/tutorials/an-introduction-to-shaders-part-1/\">An introduction to shaders - Part 1</a></li>\n</ul>\n<h2>Examples in this article</h2>\n<ul>\n<li><a href=\"/demos/image-effects/basic.html\">Basic pixel manipulation</a></li>\n<li><a href=\"/demos/image-effects/32bit.html\">32bit pixel manipulation</a></li>\n<li><a href=\"/demos/image-effects/webgl.html\">WebGL image effects</a></li>\n<li><a href=\"/demos/image-effects/webgl-matrix.html\">WebGL simulate SVG feColorMatrix</a></li>\n<li><a href=\"/demos/image-effects/webgl-interactive.html\">WebGL interactive image effects</a></li>\n</ul>\n<br>\n<section class=\" pal mtl background-dark\">\nIf your interested in implementing any of these techniques in a real project, why not <a href=\"/hire\">get in touch with me</a>? Let's make something interesting!\n</section>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/canvas-image-manipulation/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Style Guides: 50 shades of corporate blue",
    "partialText": "\r\n      <p>I recently completed my third attempt at implementing a style guide within my organisation. So far this is the first attempt that looks to be maintainable and has some traction outside the development team. I want to share with you how we got there and what I learnt from 2 failed attempts.</p>\n<p>My first attempt at a style guide used an automated tool called <a href=\"http://warpspire.com/kss/styleguides/\">KSS</a>, it automatically generated a style guide from comments in the CSS. It was clever. I was sold by the efficiency. It failed quickly. I don't think it failed because of the choice of tool. I just hadn't adequately prepared. I hadn't discussed the objectives with other developers and definitely not more broadly with the team.</p>\n<p>However before I could learn that lesson there was an immediate barrier of technical debt. At the time we didn't use build tools or even SASS. I'm ashamed to say that despite my best efforts the CSS was a little all over the place. This meant that the style guide was difficult to maintain. As well as this, people in the development team were also used to working reactively. The style guide was not being used as a tool for development and planning, so inevitably it became a post implementation task to update and it quickly fell behind production.</p>\n<p>We needed to change how we worked. I began the mammoth task of refactoring seven thousand lines of CSS as well as making preprocessors and build tools a part our toolkit. We started discussing our prefered approach to CSS architecture and other development principles and guidelines. We settled on <a href=\"https://smacss.com/\">SMACSS</a> for naming conventions, <a href=\"http://codeguide.co/\">Mark Otto’s Code guide</a> and <a href=\"http://patternlab.io/about.html\">Atomic Design</a> principles. We were not instant experts at any of these things and developing discipline takes time. You never arrive at perfect and it’s a moving target anyway, so we just kept working towards it. I wrote about this in <a href=\"http://madebymike.com.au/writing/how-do-I-css\">another blog post on how I CSS</a>.\nWe worked with these principles without a style guide for a while. Everyone up-skilled and we noticed better consistency and maintainability of our code. We were pretty sure we were ready and style guide version 2.0 was going to be brilliant. It was for a while. We used <a href=\"https://fbrctr.github.io/\">Fabricator</a> and <a href=\"http://gulpjs.com/\">Gulp</a> to create a custom style guide. Unlike KSS we manually created a markdown file for each component. The extra work was offset by a high degree of flexibility and the live reload features meant the style guide became the place for development and testing.</p>\n<p>This worked really well for developers with only a slightly steeper learning curve and set-up cost for new staff.</p>\n<p>The next thing I learnt was that the success of a style guide depends as much on the processes you have within your organisation as it does on on the discipline of your development team. It's not just the development process that matters, content and design processes also influence your chance of success.</p>\n<p>This matters even more in large organisations. Unfortunately a lot of developers focus on the build process and no matter how clever that is it's not going to be successful if it doesn't enable content writers and designers to do their job better. They don't care how efficient your build process is. It also has to enable managers and decision makers to get an overview of how isolated changes are going to influence the boarded aesthetic. Only then will they see value in it.</p>\n<p>Done well style guides reduce conflict and lead to better design decisions, at worst they cause friction and the development team will soon be seen as a blocker rather than an enabler. Right from the beginning start thinking about how your style guide is going to make other people's jobs easier not your own.</p>\n<p>You might need to influence people's thinking and modify existing processes to move to a place in your organisation where a style guide will be accepted as an important design tool. A strong foundation in the concepts of atomic design is important but do not try to sell these concepts to non technical staff. Instead talk about the benefits of visual consistency from a user experience perspective and how patterns help streamline the design process and lead to better business outcomes.</p>\n<p>This is easy to say now but this is not how I did it. Instead I harped on about maintainability of stylesheets, about reducing lines of code and more efficient development processes. &quot;So what&quot;, was often the response, “I want that button, on that page only, to be corporate bule” and I would fight the good fight, but in the end, more often than not I found myself saying “which of the 49 shades of corporate blue we have, would you like to use”. No doubt only because I'd made such a fuss about it, “can I have a new one?” was the answer.</p>\n<p>Eventually I clicked and I started talking about what does blue represent to our customers, where and why do we use buttons and what are the business rules that govern or guide our decisions to use these indicators. Everything in design conveys meaning and if you can define it on a per component basis, you can start to get non-technical people to understand the design language.</p>\n<p>For the most part managers, designers and developers are all out to achieve the same goals and style guides can give you a common language to discuss this. Who’d have thought that style guides were not just a vanity exercise in developer tooling.</p>\n<p>I started focusing on what purpose each component has on the site. Asking questions like: &quot;What is its function?&quot; and &quot;Where should it be used?&quot; I also realised that it is equally important to define where something should not be used. Soon I found we were wanting to put even more business logic in there, things like “What are the character limits?” and “How many times can a component be used on a single page?”.</p>\n<p>Now we have a tool that is a lot more than a style guide it is a framework for discussion. When new feature is proposed we see if we have an existing component that fulfills the stated need. If we do, we use that. If we don’t we create a new one, modify an existing one or create a new variation of a base component. This forces more stringent thinking. Firstly am I happy with an existing feature, secondly am I prepared to modify something globally and if not, can I describe the reason and purpose for a variation.</p>\n<p>Does this always work? It’s early days and we need more time to see how much influence this process will actually have. Although I’m optimistic, I don’t think it will always work. At the end of the day a process only works as long as people are prepared to follow it. The style guide now gives us a really good chance of showcasing the value of our process and the reason behind them but if someone high enough up the food chain says &quot;it must be this shade of blue&quot;, I guess we'll just have to put that reason in the style guide.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/style-guides-50-shades-of-corporate-blue/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "A love letter to jQuery",
    "partialText": "\r\n      <p>jQuery I love you. We've been together for 10 years and that's more than 50 years in JavaScript framework lifetimes. I might see you now less often than I did once, but I need you now no less than when we first met.</p>\n<p>I’ll never forget our first function together:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ready</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><br>  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>‘page loaded’<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Ha! I hope you will forgive me for that alert. That’s how we did things then and I wanted to be sure you worked; of course you worked, I would never doubt it now. We don’t do <code>$(document).ready()</code> very much these days, but I still remember the good times we had. I also remember the pain I had trying to do this without you!</p>\n<p>You were always there for me when things were tough. You made things consistent, how they should be, often without me even realising you were doing it. The web was a scary place and you brought order to it. You gave me confidence.</p>\n<p>You were there for me too when I had no clue what I was doing. You helped me achieve things I would have never achieved on my own. In some ways, you made it too easy for me and I did some things I should have never done; I'm sorry, that was my fault not yours.</p>\n<p>Shallow though it might be, I like the way you look. I can recognise your form anywhere. I love your neat and tidy closures and your chainable methods that keep me wanting more. I look upon you with comfort and familiarity. You always make me smile.</p>\n<p>You are selfless. So selfless in fact, that you made me less reliant on you. You taught me how to think. And not just me, but the world around us has been shaped by your influence. Everytime I hear someone say “Native JavaScript” I smile and I think of you. You are so brilliant they needed a term to describe your absence. You have been my fearless leader and guiding light. That’s why I love you jQuery.</p>\n<p>I wish those that didn't know you as well as I do, would treat you with more respect. Younger suitors like Angular and React will come and go; some will make their mark and one day they might even be worthy of comparison. But you will always be my first love; my one true love.</p>\n<p>It hurts me when I hear them say things like “you don’t need jQuery”. They don’t remember how dark it was before your light. We needed you then and we still need you now. I like the way you do things and although the years have passed, for certain tasks, you still do what you do better than anyone else could. I trust you. I know you and you know me. There will always be other ways we could do things, but I know I can rely on you and you’re always there when I need you to be.</p>\n<p>So thank you jQuery! It’s been a wonderful 10 years. I hope we have another 10, but if we don’t it will always be with dignity and respect that I remember you and never less, because you do the perfect job of making yourself redundant. It is befitting that you do this so gracefully. If the time does come to say goodbye it will be because you have given us all that you can. To not be needed does not mean you will not forever be important to the me and the web.</p>\n<p>Thank you jQuery.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/love-letter-to-jquery/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Pattern: Robust icons",
    "partialText": "\r\n      <p>I want to share a design pattern I've been using for icons. It's a robust technique that works in almost any situation. With this technique you can use icons inline or append &amp; prepend them to existing content. It works with paragraphs, headings, navigation items, buttons …almost any element.</p>\n<div class=\"robust-icon-container\">\n\t<a class=\"robust-icon-examples icon-right-tomato icon-large\" href=\"http://codepen.io/MadeByMike/pen/xGoMMw?editors=010\">\n    \t<h2 class=\"icon-left-tomato mtl\">Examples</h2>\n    \t<p>View more examples <span class=\"icon icon-tomato icon-small\"></span> on CodePen.</p>\n    \t<span class=\"faux-btn icon-right-tomato mtl mbl\">View Examples</span>\n    </a>\n</div>\n<p>It's also easy to extend so I can usually drop it into almost any project.</p>\n<h2>Usage</h2>\n<h3>Inline:</h3>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>icon icon-{icon-name}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span></code></pre>\n<h3>Prepend:</h3>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>icon-left-{icon-name}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre>\n<h3>Append:</h3>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>icon-right-{icon-name}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre>\n<h3>Size modifiers:</h3>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>icon icon-{icon-name} icon-small<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span><br><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>icon-right-{icon-name} icon-large<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><br><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>icon icon-{icon-name} icon-responsive<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span></code></pre>\n<h2>How it works</h2>\n<p>When appending or prepending, no matter the hight of the content, the icon will always be centred. Icons are vertically centred using absolutely positioned pseudo elements and left and right padding is added to the parent element as required to ensure icons and content always have adequate spacing.</p>\n<p>The clever part of this technique, apart from the vertical centring, is the use of attribute selectors to target elements that that contain various <code>icon-</code> prefixes. By targeting attribute selectors we need fewer class names to apply icon styles and adding new icons or modifiers becomes exceptionally easy.</p>\n<h2>Extending the icon library</h2>\n<p>If you follow the naming conventions all you need to add a new icon to the set is a background image. To add a new icon we just need to add following line and change <code>{icon-name}</code> to the name of our new icon.</p>\n<p>Check out some <a href=\"http://codepen.io/MadeByMike/pen/xGoMMw?editors=010\">demos on CodePen</a> or just <a href=\"https://gist.github.com/MadeByMike/b15aac18adc6a664efa4\">grab the code</a>.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.icon-</span><span class=\"token punctuation\">{</span>icon-name<span class=\"token punctuation\">}</span><span class=\"token selector\">,<br>.icon-left-</span><span class=\"token punctuation\">{</span>icon-name<span class=\"token punctuation\">}</span><span class=\"token selector\">:before,<br>.icon-right-</span><span class=\"token punctuation\">{</span>icon-name<span class=\"token punctuation\">}</span><span class=\"token selector\">:after</span><span class=\"token punctuation\">{</span><br>\t<span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>icon-name.svg<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>This is the first of hopefully more short articles, where I share some of my favourite design patterns.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/pattern-robust-icons/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Fluid typography examples",
    "partialText": "\r\n      <p>A few months ago I published a <a href=\"/writing/precise-control-responsive-typography/\">fluid type technique</a> that doesn't require any JavaScript. Even though I consider it experimental the technique works well enough as a progressive enhancement and it generated a lot of interest, comments and suggestions. So I thought I'd put together a bunch of examples and address some comments.</p>\n<h2>Fluid type with pixels</h2>\n<p>This is a simplified version of my original example. The minimum font size is 14px and the maximum is 22px. I've removed a redundant media query and reduced the complexity of the calc() equation.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.fluid-type</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 14px<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 320px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.fluid-type</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>14px + 8 * <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>100vw - 320px<span class=\"token punctuation\">)</span> / 960<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 1280px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.fluid-type</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 22px<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<h3>Example</h3>\n<p class=\"example-1\">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo.</p>\n<h2>Fluid type with Rem units</h2>\n<p>This example should have the same result as the one above when the base font size is 16px (default).</p>\n<p>It shows that the technique works with any length unit, as long as you can use it in a media query. It also addresses comments regarding how my initial example will override user preferences for the default font size.</p>\n<p>The only catch is that all unit types must be the same for the calc() equation to work. That's a shame because we often use different unit types for breakpoints in media queries than we do for <code>font-size</code>.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.fluid-type</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 0.875rem<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 20rem<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.fluid-type</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>0.875rem + 0.5 * <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>100vw - 20rem<span class=\"token punctuation\">)</span> / 60<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 80rem<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.fluid-type</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 1.375rem<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<h3>Example</h3>\n<p class=\"example-2\">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo.</p>\n<h2>Reverse fluid type</h2>\n<p>In this example the text gets smaller as the viewport gets larger. This might have novel uses or it might not.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.fluid-type</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 22px<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 320px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.fluid-type</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>22px + -8 * <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>100vw - 320px<span class=\"token punctuation\">)</span> / 960<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 1280px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.fluid-type</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 14px<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<h3>Example</h3>\n<p class=\"example-3\">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo.</p>\n<h2>Fluid line-height (Molten leading)</h2>\n<p>In this example the line-height is fluid. This is a pure CSS implementation of Wilto's <a href=\"https://github.com/Wilto/Molten-Leading\">Molten leading technique</a>.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.molten-leading</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">line-height</span><span class=\"token punctuation\">:</span> 1.2em<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 20em<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.molten-leading</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">line-height</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>1.2em + 0.6 * <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>100vw - 20em<span class=\"token punctuation\">)</span> / 60<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 80em<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.molten-leading</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">line-height</span><span class=\"token punctuation\">:</span> 1.8em<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<h3>Example</h3>\n<p class=\"example-4\">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo.</p>\n<h2>Fluid box</h2>\n<p>This example shows how the technique can be applied to more than just font sizes, in this case <code>width</code>.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.fluid-box</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 200px<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 320px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.fluid-box</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>200px + 300 * <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>100vw - 320px<span class=\"token punctuation\">)</span> / 960<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen and <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 1280px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">.fluid-box</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 500px<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<h3>Example</h3>\n<p class=\"example-5\">The width of this box will scale and at a different rate to the viewport.</p>\n<h2>Fluid type in Sass</h2>\n<p><a href=\"https://twitter.com/indrekpaas\">Indrek Paas</a> developed a Sass mixin to help make fluid type using this technique easier. <a href=\"http://sassmeister.com/gist/7f22e44ace49b5124eec\">You can find the latest fluid type Sass mixin here</a>.</p>\n<p><strong>Update</strong>: I now recommend using <a href=\"https://codepen.io/MadeByMike/pen/vNrvdZ\">this mixin</a></p>\n<p>I use a slightly modified version to generate the examples on this page.</p>\n<h3>Example:</h3>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.fluid-type </span><span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">@include</span> <span class=\"token function\">fluid-type</span><span class=\"token punctuation\">(</span>320px<span class=\"token punctuation\">,</span> 1280px<span class=\"token punctuation\">,</span> 14px<span class=\"token punctuation\">,</span> 18px<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<h2>Fluid type in Less</h2>\n<p>If Less is how you roll I've got you covered with a <a href=\"http://codepen.io/MadeByMike/pen/RWJyML\">Less mixin</a>.</p>\n<h2>Fluid type in PostCSS</h2>\n<p><a href=\"https://www.npmjs.com/package/rucksack-css\">Rucksack is a postCSS module</a> that makes use of this technique for fluid typography.</p>\n<p>I have a collection of <a href=\"http://codepen.io/MadeByMike/pens/tags/2/?selected_tag=responsive+typography\">other examples on CodePen</a>. <a href=\"https://twitter.com/MikeRiethmuller\">Let me know</a> if you have one you'd like me to share.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/fluid-type-calc-examples/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "How do I CSS?",
    "partialText": "\r\n      <p>When starting a new project with new developers one of the first things I want to do is get on the same page in terms of how we structure and manage CSS.</p>\n<p>There are so many methodologies and guidelines today that I wonder why you would bother writing your own detailed documentation.</p>\n<p>It's pretty simple choose a methodology, choose a set of guidelines and choose a build process.</p>\n<h3>Methodologies</h3>\n<ul>\n<li><a href=\"https://en.bem.info/\">BEM</a></li>\n<li><a href=\"https://smacss.com/\">SMACSS</a></li>\n<li><a href=\"http://www.smashingmagazine.com/2011/12/12/an-introduction-to-object-oriented-css-oocss/\">OOCSS</a></li>\n</ul>\n<h3>Guidelines</h3>\n<ul>\n<li><a href=\"http://codeguide.co/#css\">codeguide.co</a></li>\n<li><a href=\"http://cssguidelin.es/\">cssguidelin.es</a></li>\n<li><a href=\"https://github.com/necolas/idiomatic-css\">idiomatic-css</a></li>\n</ul>\n<p>It doesn't matter which set of methodologies or guidelines you prefer at the end of the day consistency is what you are after. You could just place these all on a big wheel and spin it.</p>\n<p>The problem we might have with this approach is they overlap, methodologies wander into the territory of guidelines, and guidelines get opinionated our build tools and processes. In my view we'd be better off if there were clearer guidelines for our guidelines. No, I'm not <em>actually</em> suggesting we write guidelines about guidelines. But if methodologies were primarily about organisation, structure and other big picture stuff, and guidelines were mostly about the style, formatting and other fine detail, we'd be more able to mix and match.</p>\n<p>So what do you do about that short of specifying every detail? I recently came across <a href=\"http://codepen.io/chriscoyier/blog/codepens-css\">Chris Coyier's tour of CodePen's CSS</a> which was a response to <a href=\"http://ianfeather.co.uk/css-at-lonely-planet/\">Ian Feather's tour of Lonely Planet's CSS</a>, which was in response to <a href=\"http://markdotto.com/2014/07/23/githubs-css/\">Mark Otto's tour of GitHub's CSS</a>. I promise I am not going to add another 'in response' article to add to that chain! But it did get me thinking. This is the perfect way to state your preferred methodologies and guidelines and how you apply them.</p>\n<p>Rather than doing this as a review of how you work what if you did this <em>before</em> starting a project as an agreed way of how you would like to work? You could state how strictly you follow certain guidelines, the things that matter most and where you are more agnostic. You can list your key points of difference and detail your preferred build process and importantly the reasons for these choices. It seems like a much faster way to arrive at a consensus in a new team.</p>\n<p>So I've written down how I CSS for a typical website project and I thought I'd share it. Remember this is how I like to CSS and I'm not saying this is how you should CSS, or even that this always works for me. I'll be flattered if you find this useful or apply this method for arriving at a consensus within your team. But there is no expectation that what I have written is right for you.</p>\n<h2>How I CSS</h2>\n<ul>\n<li><a href=\"#css-architecture\">I follow SMACSS conventions</a></li>\n<li><a href=\"#preprocessors\">I use SCSS</a></li>\n<li><a href=\"#autoprefixer\">I use Autoprefixer</a></li>\n<li><a href=\"#linting\">I use CSSLint</a></li>\n<li><a href=\"#comments-docs\">I comment extensively</a></li>\n<li><a href=\"#build-it\">I use Grunt for my build process</a></li>\n<li><a href=\"#human-am-i\">I don't always follow my own advice</a></li>\n</ul>\n<h3 id=\"css-architecture\">CSS Architecture</h3>\n<p>I lean towards the naming conventions in SMACSS and generally aim to structure my CSS according to these guidelines. However I also prefer common-sense over strict adherence to naming conventions and guidelines.</p>\n<p>I try to follow <a href=\"http://mdo.github.io/code-guide/#css\">these guidelines</a> by Mark Otto for the smaller things like formatting and declaration order. I also have immense respect for Harry Robert's <a href=\"http://cssguidelin.es/\">CSS Guidelines</a> but my personal preferences differ (slightly) from Harry's and his guidelines are so extensive it's easier for me to list my points of difference from Mark's code guide.</p>\n<p>Some of my key personal preferences include:</p>\n<ul>\n<li>using 'classy' selectors and not IDs</li>\n<li>don't nest media queries, it makes me sad :(</li>\n<li>I like tabs, but I don't hate spaces so don't hate me</li>\n<li>unlike this bullet point, I try to keep class names and selectors chains as short as possible without sacrificing clarity</li>\n<li>I care about accessibility and valid mark-up</li>\n<li>I like REM units, but I'm happy to use the odd pixel</li>\n</ul>\n<h3 id=\"preprocessors\">Preprocessors</h3>\n<p>I use SASS and the SCSS syntax because it's widely used and understood. But more importantly because it works for me.</p>\n<p>Source SCSS files are compiled into two separate stylesheets:</p>\n<ul>\n<li>a bare minimum set of styles for older devices and &lt;IE9</li>\n<li>a fully featured and enhanced version for everything else</li>\n</ul>\n<p>I minifiy my CSS files straight out of SASS. I also generate source map files and publish my .SCSS files to production.</p>\n<p>I did use LESS for a long time because it felt more declarative like CSS is 'meant' to be, however also I enjoyed creating wild experimental things with SASS. Eventually I made the switch using SASS almost exclusively, in part because of its growing popularity. I know, I'm a sell-out and a sheep!</p>\n<p><strong>Note:</strong> I don't get too excited about my SASS (in production). I keep it basic with variables, keep mixins simple, use color and math functions, don't nest too deeply and don't try to be clever or fancy.</p>\n<p>I also frequently inline my critical CSS and load additional styles asynchronously for better performance using the method described by Scott Jhel in <a href=\"https://www.filamentgroup.com/lab/performance-rwd.html\">How we make RWD sites load fast as heck</a> the results of this can be amazingly noticeable.</p>\n<h3 id=\"autoprefixer\">Autoprefixer</h3>\n<p>I don't use any vendor prefixes in my SCSS or use mixins to generate them. Rather I write regular CSS according to the specification and run Autoprefixer as a post process (after SASS produces the CSS files). Not only is this easier, but it produces a better quality result because developers are human and sometimes forget to use prefixes and mixins. It also allows me to easily remove large chunks of legacy code by simply updating the target browsers in the Autoprefixer config.</p>\n<h3 id=\"linting\">Linting</h3>\n<p>Rather than maintaining my own set of rules for code formatting I mostly follow suggestions from <a href=\"http://mdo.github.io/code-guide/#css\">Mark Otto's code-guide</a></p>\n<p>I differ in some respects such as I prefer using tabs rather than 2 spaces. But importantly, I don't get upset about this or any other code formatting convention. I understand that each developer has their own habits and preferences. When working together it is nice when if our code looks the same and is reasonably tidy, so that's why my build process usually includes linting.</p>\n<h3 id=\"comments-docs\">Commenting &amp; Documentation</h3>\n<p>I am liberal with my use of comments. No one has ever complained a stylesheet is over documented. Comments range from highly structured block declarations describing modules to silly jokes and apologies for hacks, both are good.</p>\n<p>Ideally each UI component, utility class, layout module and mixin should have a block comment briefly describing it.</p>\n<p>In the past I've tried a whole range of automated documentation tools for SASS and CSS. My &quot;professional&quot; opinion is they all suck a little bit, so I don't get too hung up about it. When you are working with a team of developers a little bit of sucky documentation is often better than none.</p>\n<p>At the end of the day documentation is made for humans and machines are only good at providing us a with the templates and structure. You need to put in real work to get good CSS documentation and this is only good if someone is going to read it. Find the right balance of documentation for your project, it might be none or it might be a lot.</p>\n<p>I think of the <a href=\"http://rizzo.lonelyplanet.com/styleguide/\">lonely planet style guide</a> and the process described by <a href=\"http://ianfeather.co.uk/a-maintainable-style-guide/\">Ian Feather</a> as the standard we should be aiming for.</p>\n<h3 id=\"build-it\">Build process</h3>\n<p>I chose Grunt to string together the various tasks that help me build and maintain my stylesheets:</p>\n<p>Linting -&gt; Preprocessor -&gt; Autoprefixer -&gt; CSS</p>\n<p>I probably should have chosen Gulp cause word is it's much cooler now, but at the end of the day I just want to keep my build process as simple as possible and Grunt has allowed me to do this. I try not to over engineer the build process.</p>\n<h3 id=\"human-am-i\">I am a Human</h3>\n<p>Finally I should say that at best I do this only about 60-70% of the time. Sometimes for small projects I very loosely apply these guidelines or don't follow them at all. Sometimes I'm lazy or tired or I'm tricked into thinking some marketing element will only be on the homepage for &quot;2 weeks absolute maximum&quot; and it's Friday so I just do it quickly. Two years later it's still there. I'm ok with that, these are only guidelines and we are humans not machines.</p>\n<p><strong>Final disclaimer</strong>: Things are constantly changing. This might not be how I CSS in the future. And ok, I guess this is kind of an 'in response' article.</p>\n<h2>You might like</h2>\n<ul>\n<li><a href=\"http://codepen.io/chriscoyier/blog/codepens-css\">Chris Coyier's tour of CodePen's CSS</a></li>\n<li><a href=\"http://ianfeather.co.uk/css-at-lonely-planet/\">Ian Feather's tour of Lonely Planet's CSS</a></li>\n<li><a href=\"http://markdotto.com/2014/07/23/githubs-css/\">Mark Otto's tour of GitHub's CSS</a>.</li>\n</ul>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/how-do-i-css/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "HTML5 periodic table DMCA takedown request",
    "partialText": "\r\n      <p>Today I received a <a href=\"http://en.wikipedia.org/wiki/Digital_Millennium_Copyright_Act\">DMCA takedown request</a> against my personal website over a <a href=\"http://madebymike.com.au/html5-periodic-table/\">trivial GitHub project that involves a periodic table layout</a> and information about HTML5 elements.</p>\n<p><strong>Update:</strong> The legal threats and the DMCA takedown request were withdrawn. In addition to that the person involved has apologised and as such I've removed their name from this post.</p>\n<p>Normally I like to write about my projects and experiments but it seems this an unfortunate part of what we do so I will detail it here in case anyone else has this experience.</p>\n<p>The reasons for the DMCA takedown are detailed below. At the end of the day, whether there is a legal basis for it or not, the claim is in very poor spirit.</p>\n<p>Prior to being informed about the DMCA takedown request I received an impersonal email. In fact it was not just an impersonal email, it was a ‘cease and desist notice’ full of legal speak and threats such as this:</p>\n<p>“You neither asked for nor received permission to use the Work… nor to make or distribute copies of it. Therefore, you have infringed my rights under 17 U.S.C. Section 101 et seq. and could be liable for statutory damages as high as $150,000 as set forth in Section 504(c)(2) therein.”</p>\n<p>I’d had no prior contact with this person or any knowledge of their work or existence, so it came as a bit of a shock. It was not what I’ve come to expect from the development community. But I respect the rights of fellow developers and designers to make a living by selling their work, so I thought I’d better check this out in more detail before responding.</p>\n<p>Like most developers in our community I’m always very careful to check and attribute sources so I could not understand what basis there could be for this claim.</p>\n<p>The HTML5 periodic table I made was intended to be just a fun css challenge. It is responsive and the entire project including the interaction is done with just CSS (thank you :target attribute). The information about each element was shamelessly stolen from the <a href=\"https://developer.mozilla.org/en/docs/Web/HTML/Element\">Mozilla Developer Network</a> (MDN) and the layout is thanks to <a href=\"http://en.wikipedia.org/wiki/Dmitri_Mendeleev\">Dmitri Mendeleev</a>. But luckily MDN and Dmitri are all about the learning and they support the community; as such I have much love for them both.</p>\n<p>But getting back to the basis for this claim. The original idea for the challenge came from an image:</p>\n<img src=\"/img/html5-periodic-table-source.png\" />\n<p>I’m not sure where I first saw this image but I believe it was shown to me by a friend who also proposed the challenge. I later traced the source of the image to Josh Duck and made an effort to attribute him.</p>\n<p>The person who contacted me claims to have produced a poster of a HTML periodic table earlier than the work by Josh Duck. They also claimed to have sued Josh Duck. So they seem like a reasonable person. I responded and suggested: “Shall we try talking first?”. I pointed out that:</p>\n<ul>\n<li>I have not seen the original poster</li>\n<li>I cannot find any proof of an earlier work - only a recent version can be found online</li>\n<li>my final effort was substantially different to that by Josh Duck and even more different from the poster</li>\n<li>a printed poster and HTML are completely different mediums with different interactions and purpose</li>\n<li>the ability to claim copyright over public domain information such as a periodic table layout and the HTML5 specification is questionable at best</li>\n<li>I am not a US citizen so different copyright laws may apply</li>\n<li>And importantly the GitHub project exists purely as a learning exercise and has very little traffic (it’s just a simple hack day project!)</li>\n</ul>\n<p>Further to this I’m not selling anything, it’s purely educational and if someone likes it, they would be more likely to take an interest in a print product with a similar concept.</p>\n<p>I’d love to remake this using flexbox and update it with newer HTML elements and more detailed content. I’d love people to be able to fork it and learn more about creating challenging layouts with css. Or develop something new from this concept.</p>\n<p>Imagine if we all received copyright challenges over something as tenuous a particular layout and subject matter. This would mean there could only be one single column web development blog (and not only that it would be a book).</p>\n<p>At the end of the day whether there is a legal basis for this claim or not it’s in very poor spirit and I think it amounts to nothing more than trolling and is not what DMCA was intended for.</p>\n<p>It might be a small, outdated and largely insignificant GitHub project but I intend to challenge this through all reasonable means. Firstly this involves a <a href=\"https://help.github.com/articles/guide-to-submitting-a-dmca-counter-notice/\">DMCA Counter Notice with GitHub</a>.</p>\n<p>Luckily in the end (after posting this origional story) the person involved had a change of heart. The approach may have been a tad overzealous and the reaction not anticipated, and I think we can forgive that. I also think a lot more can be achieved by working with the community, there is room for similar ideas and generally we're a great bunch of people who are happy to share a link and promote each other's work.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/html5-periodic-table-dmca-takedown-request/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Precise control over responsive typography",
    "partialText": "\r\n      <p>It is possible to have precise control over responsive typography. Using calc() and viewport units you can create fluid type that scales perfectly between specific pixel values, within a specific viewport range.</p>\n<p>\n<a href=\"http://codepen.io/MadeByMike/pen/YPJJYv\" class=\"responsive-type\">\n  This text is limited to between 20px and 40px, over a viewport range of 600px to 800px.\n</a>\n</p>\n<p>I don’t know why we don’t see viewport units being used more extensively for creating designs with responsive typography.</p>\n<p>Viewport units have been around since 2012 and are <a href=\"http://caniuse.com/#feat=viewport-units\">fairly well supported</a>. In fact Internet Explorer was an early mover on this and supports viewport units as far back as IE9.</p>\n<p>They are also really easy to understand. One viewport unit is simply 1% of the viewport and there are 4 types of viewport units:</p>\n<ul>\n<li>vw - viewport width,</li>\n<li>vh - viewport height,</li>\n<li>vmin - height or width, whichever is smaller,</li>\n<li>vmax - height or width, whichever is larger</li>\n</ul>\n<p>So the reason viewport units are not used more extensively is probably not due to a lack of browser support or developers' understanding. My guess is it’s probably more likely to do with the lack of precise control designers have over the font-size.</p>\n<p>Designers that love typography often really love typography and they enjoy precise control over line-height, font-size, letter-spacing and other elements of typography those of us not in the club might not even know exist.</p>\n<p>This desire for precise control is the reason that some designers still prefer to declare these properties using pixels. But it doesn’t really matter, whether they use ems, rems or percentages the truth is, they are all just abstractions of a base font size and that is usually 16 pixels. So they have never really had to give up complete control. It’s not difficult to work out what font-size an element is, as long as we know the base font-size.</p>\n<p>But viewport units are different! They represent a fundamental change in approach. Unlike all the other units, viewport units are not relative to the base font size in any way. Instead they are relative to the viewport, which the user controls, and that might be scary for some.</p>\n<p>But there are advantages to using viewport units, a font-size declared with viewport units is fluid, meaning it will scale smoothly. This is a clearly a better experience than <a href=\"http://codepen.io/MadeByMike/pen/c54dfa521cf08e0439943b7a745f77f0\">clunky responsive typography techniques</a> that require multiple media queries.</p>\n<p>Responsive typography with viewport units is really easy to implement, just declare the base font-size using vw; as long as you are not using pixels elsewhere in your stylesheet, other units are relative to the base font-size, (which is now viewport units) so they will all scale accordingly.</p>\n<p>But there are a few rough edges you will need to sand back. Firstly when you get down to a very small viewport scaling is problematic. Luckily there are a few good methods for avoiding this.</p>\n<h2>Limit font scaling with calc()</h2>\n<p>If you would like set an exact minimum font-size in pixels you can use calc().</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>16px + 3vw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>This example says set the default size to 16px + 3vw.</p>\n<p><strong>Note</strong>: There are still issues in some browsers when using viewport units and calc() together, so for now media queries is probably safer.</p>\n<h2>Limit font scaling with media queries</h2>\n<p>You can prevent the text from scaling below a specific threshold simply by using a media query and only applying viewport units above a certain device resolution.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 18px<span class=\"token punctuation\">;</span> <span class=\"token comment\">/* default below 600px */</span><br><span class=\"token punctuation\">}</span><br><span class=\"token atrule\"><span class=\"token rule\">@media</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 600px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 3vw<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>We can also stop scaling above a specific font-size, but for this we need to first work out what the viewport size will be at the font-size we want to stop scaling. For that we need a bit of maths:</p>\n<pre class=\"language-text\"><code class=\"language-text\">font-size / ( number of viewport units / 100 )<br>Eg. 24 / ( 3 / 100 ) = 800px</code></pre>\n<p>With that result just set another media query to change the root font-size back to a fixed unit.</p>\n<pre class=\"language-css\"><code class=\"language-css\">... <span class=\"token atrule\"><span class=\"token rule\">@media</span> <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> 800px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 24px<span class=\"token punctuation\">;</span> <span class=\"token comment\">/*above 800px */</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>The calculations are not that hard but I find it easier to look at a simple table. This helps me visualise the change in font-size across different resolutions.</p>\n<table>\n  <tbody>\n    <tr>\n      <th>Viewport units:</th><th>1vw</th><th>2vw</th><th>3vw</th><th>4vw</th><th>5vw</th>\n    </tr>\n    <tr>\n      <th>Viewport size</th><th colspan=\"5\">font-size in pixels</th>\n    </tr>\n    <tr>\n      <th>400px</th><td>4px</td><td>8px</td><td>12px</td><td>16px</td><td>20px</td>\n    </tr>\n    <tr>\n      <th>500px</th><td>5px</td><td>10px</td><td>15px</td><td>20px</td><td>25px</td>\n    </tr>\n    <tr>\n      <th>600px</th><td>6px</td><td>12px</td><td>18px</td><td>24px</td><td>30px</td>\n    </tr>\n    <tr>\n      <th>700px</th><td>7px</td><td>14px</td><td>21px</td><td>28px</td><td>35px</td>\n    </tr>\n    <tr>\n      <th>800px</th><td>8px</td><td>16px</td><td>24px</td><td>32px</td><td>40px</td>\n    </tr>\n    <tr>\n      <th>900px</th><td>9px</td><td>18px</td><td>27px</td><td>36px</td><td>45px</td>\n    </tr>\n    <tr>\n      <th>1000px</th><td>10px</td><td>20px</td><td>30px</td><td>40px</td><td>50px</td>\n    </tr>\n  </tbody>\n</table>\n<p>Looking at the table you can see there are many limitations. We have little control over the rate at which viewport units change and we are confined to the options available in the table.</p>\n<h2>Precise control with calc()</h2>\n<p>In his 2012 article on <a href=\"http://trentwalton.com/2012/06/19/fluid-type/\">Fluid Type</a> Trent Walton said:</p>\n<blockquote>\"It's been hard to let go of setting a static font-size for a site and calling things done. I’m realizing that the predictability & control we've had over web type is becoming a thing of the past.\"</blockquote>\n<p>But perhaps not all predictability and control is lost.</p>\n<p>Let's imagine that as a typography nerd with an eye for absolute precision, you want the font-size at a resolution of 600px to be 12px. Great! Looking at the table, setting a font-size of 2vw will achieve this. But you also want the font-size at 800px to be 32px. It seems you can’t do this without changing from 2vw to 4vw and this means a break-point and our font scaling will be jumpy and not fluid. I consider this a pretty significant limitation.</p>\n<p>There is a solution to this! It's not exactly pretty but it works – at least in modern browsers. As stated earlier, some browser have bugs when using calc() and viewport units together, so this might be buggy in some older browsers. (This is not really a concern anymore, just set sensible default font sizes before declaring a fluid type calc() expression.)</p>\n<p>It appears that by using calc() and vw we can get responsive typography that scales perfectly between specific pixel values within a specific viewport range.</p>\n<p>This means you can have perfect smooth scaling between any 2 font sizes over any viewport range. The font will start scaling and stop scaling exactly where you want.</p>\n<p>Try the demo: <a href=\"http://codepen.io/MadeByMike/pen/YPJJYv?editors=110\">Precise control over responsive typography</a>\nThe demo uses SASS so you can easily change the upper and lower limits of the font-size and media queries. But the important part looks something like this:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>12px + <span class=\"token punctuation\">(</span>24 - 12<span class=\"token punctuation\">)</span> * <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>100vw - 400px<span class=\"token punctuation\">)</span> / <span class=\"token punctuation\">(</span>800 - 400<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p><strong>Note</strong>: In the example above, 12px is the minimum font-size and 24px is the maximum. 400px is the start of the viewport range and 800px is where it should stop scaling. The inclusion or absence of the units after each value is important.</p>\n<p>Put simply, it is a function that takes a value within a range and works out what the new value would be if applied to a different range. I can take the current viewport width (100vw) as input into this ‘function’. For example if I had viewport range of 500px to 1000px, and let’s imagine the current viewport is 750px, I then apply this to a font-size range. If my font-size range was 20px to 30px, because the input of 750px is right in the middle of 500px and 1000px my new font-size will also be right in the middle, 25px. Simple right?</p>\n<p>This seems like it could be a pretty useful way to control the scaling of viewport units. It could also have uses beyond typography. You can do other interesting things, by inverting the range for example, you can have font sizes that get smaller as the viewport gets larger. Perhaps there is a use for this? I’d love to hear your thoughts and see other applications or extensions of this idea.</p>\n<p><strong>Update</strong>: Each of the methods above use pixels for 'precise' control, however some readers have expressed concern that this will override user preferences for default font size. This is true, however all methods also work equally well with rem or any other unit type.</p>\n<h2>More info</h2>\n<ul>\n<li><a href=\"http://trentwalton.com/2012/06/19/fluid-type/\">Fluid Type</a>, Trent Walton</li>\n<li><a href=\"https://web-design-weekly.com/2014/11/18/viewport-units-vw-vh-vmin-vmax/\">Viewport units</a>, Tim Severien</li>\n<li><a href=\"https://dev.opera.com/articles/css-viewport-units/\">CSS Viewport Units</a>, Chris Mills</li>\n<li><a href=\"http://fittextjs.com/\">FitText</a>, Dave Rupert</li>\n<li><a href=\"https://eduardoboucas.com/blog/2015/06/18/viewport-sized-typography-with-minimum-and-maximum-sizes.html\">Viewport sized typography</a>, a similar concept by Eduardo Bouças</li>\n<li><a href=\"http://nicewebtype.com/notes/2012/02/03/molten-leading-or-fluid-line-height/\">Molten leading</a></li>\n</ul>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/precise-control-responsive-typography/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Zero element loading animations",
    "partialText": "\r\n      <p>With a &quot;zero element&quot; loading animation, a loading state can be applied to any element with just the addition of a class name.</p>\n<div class=\"l-50-50\">\n  <div>\n    <a href=\"http://codepen.io/MadeByMike/pen/LEbYgr?editors=110\">\n      <div class=\"loading horizontal-example\"></div>\n    </a>\n    <p class=\"caption\"><a href=\"http://codepen.io/MadeByMike/pen/LEbYgr?editors=110\">view examples on codepen</a></p>\n  </div>\n  <div>\n    <a href=\"http://codepen.io/MadeByMike/pen/bNeyEj?editors=110\">\n      <div class=\"loading radial-example\"></div>\n    </a>\n    <p class=\"caption\"><a href=\"http://codepen.io/MadeByMike/pen/bNeyEj?editors=110\">view examples on codepen</a></p>\n  </div>\n</div>\n<p>First of all, I'm not a huge fan of loading animations and neither are your users but sometimes, for various reasons an action is going to take time and we need to let people know we're working on it. So if we must use a loading animation we want it to have a light footprint and be easy to toggle on and off when and where we need it.</p>\n<p>I've seen a lot of css only loading animations. A quick search on CodePen will find thousands of examples. They are popular because they are relatively quick and easy to make, yet can be creatively challenging and the result is usually visually pleasing. These type of experiments are fun and can be a rewarding and worthwhile exercise, but the practicality of many examples is more questionable.</p>\n<p>There are definite benefits to css only solutions such as improving the number of network requests, page weight and animation performance. But in my opinion these benefits are often outweighed by the need to insert a div soup into the mark-up. Not only that, positioning a css only &quot;spinner&quot; can be challenging, it often requires changes to the surrounding mark-up to avoid breaking the layout.</p>\n<p>Perhaps slightly more practical are the &quot;single element&quot; examples. They tend to be a bit more robust and whilst it's simple enough to toggle a single element to show and hide the loading animation, I don't like toggling element visibility or adding and removing elements with JavaScript. To me this seems to defeat the purpose of a CSS only solution. It feels like the correct way to approach a css loading animation would be for it to work simply by adding a class name such as <code>loading</code> to an element to indicate that it's in a loading state.</p>\n<p>After all loading is a &quot;describing word&quot;, it indicates the state of something and is not an object itself. Maybe it is a little silly to think we should apply this logic to our mark-up, but it feels right to me. So I set out to make a &quot;zero element&quot; loading animation, one that can be applied simply by adding a class name.</p>\n<p>I eventually settled on a solution that works almost everywhere. There are only 2 conditions. The element we're adding the loading animation to:</p>\n<ul>\n<li>cannot have <code>:before</code> or <code>:after</code> pseudo-elements applied</li>\n<li>must be possible to change the <code>position</code> property to <code>relative</code></li>\n</ul>\n<p>This works in every situation I’ve ever needed a loading animation but if we want to apply this technique to an element that requires absolute positioning or already has pseudo-elements, it’s usually possible to add the loading class to a container or child element.</p>\n<h2>How it works</h2>\n<p>This technique works by using <code>:before</code> and <code>:after</code> pseudo-elements to create the different parts of the animation. CSS transformations and absolute positioning are applied and these properties are animated to create different types of loading indicators.</p>\n<p>The difficult part is working out how to position and animate the various parts, taking into account the width, height, borders and css transformations.</p>\n<p>For a typical horizontal loading animation we can work this out without too much trouble but to create a smooth radial animation or anything more complex you will probably want to rely on something like sass or a generator.</p>\n<p>If you want to understand how it works let’s look at making a simple horizontal example.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.loading</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>255<span class=\"token punctuation\">,</span> 255<span class=\"token punctuation\">,</span> 255<span class=\"token punctuation\">,</span> 0.8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">.loading:before</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">box-sizing</span><span class=\"token punctuation\">:</span> border-box<span class=\"token punctuation\">;</span><br><br>  <span class=\"token comment\">/* centre everything */</span><br>  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">top</span><span class=\"token punctuation\">:</span> 50%<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">left</span><span class=\"token punctuation\">:</span> 50%<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate</span><span class=\"token punctuation\">(</span>-50%<span class=\"token punctuation\">,</span> -50%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br>  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 200px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 30px<span class=\"token punctuation\">;</span><br><br>  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> solid 1px #000<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 30px<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token selector\">.loading:after</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">box-sizing</span><span class=\"token punctuation\">:</span> border-box<span class=\"token punctuation\">;</span><br><br>  <span class=\"token comment\">/* centre everything */</span><br>  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate</span><span class=\"token punctuation\">(</span>-50%<span class=\"token punctuation\">,</span> -50%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">top</span><span class=\"token punctuation\">:</span> 50%<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">left</span><span class=\"token punctuation\">:</span> 50%<span class=\"token punctuation\">;</span><br><br>  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> solid 5px #000<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 28px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 28px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 50%<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>With the above css we can add a class name <code>loading</code> to any element on the page and we should get something like the following, positioned in the centre:</p>\n<img style=\"margin-left: auto; margin-right: auto; display:block;\" src=\"/img/zero-element-example.png\">\n<p>If you want to apply this to the whole page, by applying the class name to the body element, you will also need to add the following css:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">html,<br>body</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>To complete the loading animation we need to move the circle back and forward along the bar.</p>\n<p>To our circle add the following css:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.loading:after</span> <span class=\"token punctuation\">{</span><br>  ... <span class=\"token property\">-webkit-animation</span><span class=\"token punctuation\">:</span> loading 3s ease-in-out infinite alternate<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">animation</span><span class=\"token punctuation\">:</span> loading 3s ease-in-out infinite alternate<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Important animation properties in this example are the <code>animation-timing-function</code> and <code>animation-direction</code>. For the timing function I selected <code>ease-in-out</code> which causes it to slow before changing direction, although <code>linear</code> also works, however for this example the animation direction must be set to <code>alternate</code>. Next we add the animation keyframes.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@keyframes</span> loading</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">0%</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate</span><span class=\"token punctuation\">(</span>-99px<span class=\"token punctuation\">,</span> -50%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token selector\">100%</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate</span><span class=\"token punctuation\">(</span>71px<span class=\"token punctuation\">,</span> -50%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token atrule\"><span class=\"token rule\">@-webkit-keyframes</span> loading</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token selector\">0%</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate</span><span class=\"token punctuation\">(</span>-99px<span class=\"token punctuation\">,</span> -50%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token selector\">100%</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate</span><span class=\"token punctuation\">(</span>71px<span class=\"token punctuation\">,</span> -50%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>For the animation keyframes we translate the position of the circle so that is starts with its left edge against the left edge of the bar and ends with its right edge against the right edge of the bar. We also need to translate the vertical position by <code>-50%</code> to maintain its vertical centring. We do not change the vertical position in this animation.</p>\n<p>Without any transformations applied, the left edge of the circle is positioned in the centre of the bar. Since we know the width of the bar is 200px, to position the left edge of the circle against the left edge of the bar we need to move it <code>-100px</code> horizontally. So why in the example do I have <code>-99px</code>? This is simply because I want the circle to bounce against the inside edge of the bar. In the css I have <code>box-sizing: border-box;</code> applied to the bar so I need to account for the border width. It’s barely noticeable with a border width of 1px but with a thick border it will make a difference. This is the same reason the width and height of the circle are <code>28px</code> rather than <code>30px</code>.</p>\n<p>The full calculation for the first keyframe is:</p>\n<pre><code>-(half the width of the bar - border width of the bar)\n-(100 - 1) = -99\n</code></pre>\n<p>For the final keyframe the calculation is similar however as already stated positions in css are relative to the top left corner of the element, so we need to take off the width of the circle.</p>\n<p>The full calculation is for the final keyframe is:</p>\n<pre><code>(half the width of the bar - border width of the bar – width of circle)\n100-1-28 = 71\n</code></pre>\n<p><strong>Note</strong>: You might not want to confine the circle to the inner width of the bar. Take a look at some of the examples I’ve done in the links at end of this article.</p>\n<p>You can of course change the sizes and colors to suit your preferences, as well as the border width or other properties, just remember if you change these adjust the calculations accordingly.</p>\n<p>If you’d like to make a horizontal zero element loading animation you can, <a href=\"http://codepen.io/MadeByMike/pen/6fced0cf51ce07ef6833aa775d254652\">fork my zero element animation boilerplate</a>.</p>\n<p>This is of course only one possible type of loading animation. There are plenty of alternatives that could be made using the same technique.</p>\n<p>I’ve created some other examples such as a radial loading animation - I'll admit, this one generates some lengthy css, but in most cases it is still smaller than an image or even an SVG. To create more complex animations like this you are going to need a preprocessor or some kind of script to generate the keyframes. Otherwise minor changes are going to result in a significant re-calculations and this is not something you would want to do by hand.</p>\n<p>Please let me know on <a href=\"https://twitter.com/MikeRiethmuller\">twitter</a> if you find this useful, if you have some more examples or if you have any questions. I'll be happy to add your examples here.</p>\n<h2>Examples</h2>\n<ul>\n<li><a href=\"http://codepen.io/MadeByMike/pen/LEbYgr?editors=110\">Horizontal zero element loaders</a></li>\n<li><a href=\"http://codepen.io/MadeByMike/pen/bNeyEj?editors=110\">Radial loaders zero element</a></li>\n</ul>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/zero-element-loading-animations/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Determine the quality of light in live video streams",
    "partialText": "\r\n      <p>I've been messing around with live video capture in the browser and have developed a nifty demo showing different methods for estimating the quality of light in realtime.</p>\n<p>To view the demo you are going to need a web cam and a modern Chrome, Firefox or Opera browser. If you have what it takes you can <a href=\"http://codepen.io/MadeByMike/full/d8369096b18e2192d0c9d721b9b2a673/\">view my demo here</a>. Please select allow when asked for permission to use the web cam.</p>\n<p>These tests have some potential real world uses. For example to advise of optimal lighting in a camera app or to estimate the size of the subject in the frame.</p>\n<h2>A brief history of html video capture</h2>\n<p>Before I explain my demo, it's worth sharing what I've learnt about the history of video capture and webRTC as well as its <a href=\"http://caniuse.com/#search=getusermedia\">state today</a>.</p>\n<p>The first thing to know is, it had a bit of a rocky start. This history is well covered in <a href=\"http://www.html5rocks.com/en/tutorials/getusermedia/intro/\">this excellent HTML5rocks article</a> by Eric Bidelman.</p>\n<p>The next thing to know is that <code>getUserMedia()</code> is still not fully supported in all browsers and there are some quirks (huge gaping inconsistencies) in implementation across browsers.</p>\n<p>Not to fear because web development superhero Addy Osmani and others have come to the rescue with pollyfills such as:</p>\n<ul>\n<li><a href=\"https://github.com/addyosmani/getUserMedia.js/\">getUserMedia.js</a></li>\n<li><a href=\"https://github.com/jhuckaby/webcamjs\">webcamjs</a></li>\n</ul>\n<p>To keep it as simple as possible I haven't included any pollyfills in my demo, but I've tested them and they work, so there's no reason not to start using this now.</p>\n<h2>Estimating the quality of lighting</h2>\n<p>In my demo there were 2 methods I trialed for determining the brightness.</p>\n<p>The first method was to find the average color of all the pixels in the frame then work out the relative brightness of this color. This method worked really well, in most situations it gave a good indication of the general brightness and would be suitable for uses such as a light indicator in a camera app.</p>\n<p>But eventually I found some limitations with the average color method when testing subjects with a high level of contrast. Images with a very dark background can give a false indication of the overall brightness and there is not enough information in the average color method to determine the 'quality' of light.</p>\n<p>I realised that I wanted to know not just the average brightness but also how much of the frame was lit. To do this I applied a threshold filter to the incoming video stream. The threshold filter determines the brightness of each pixel and sets it to either black or white depending on whether it's above or below a certian level of brightness. In the end I can tell what percentage of the frame is lit and this is number can be very differnt to the average brightness.</p>\n<p>Used together we can determine a lot about the composition and lighting of the frame.</p>\n<h2>Taking it further</h2>\n<p>If I apply more than one threshold I can set a maximum and minimum brightness and measure which parts of the image are potentially under or over exposed.</p>\n<p>Finally and it's not in my demo but you could potentially automatically adjust the threshold based on the average color brightness.</p>\n<p>So there we have a ton of information we can use to make inferences about the quality of lighting in a video stream. Now it's up to you work out how to put them to practical application.</p>\n<h2>Performance tips</h2>\n<p>Despite being very poorly optomised my demo seems to run ok. Not only am I adjusting the brightness before rendering each frame to a canvas, I'm also showing the results of the threshold and average filters on a separate smaller canvas. In most cases you won't need to do either of these things.</p>\n<p>I was able to get these methods working on an average machine with a HD video input by combining each of the filters so that I was only looping over the pixel data once. I used an off screen canvas and only processed every 5th frame and every 5th pixel. The results were as accurate as the method shown in this demo.</p>\n<h2>Further reading</h2>\n<p>Interesting articles I found along the way include:</p>\n<ul>\n<li><a href=\"https://dev.opera.com/articles/getusermedia-access-camera-privacy-ui/\">getUserMedia: Accessing the Camera and Privacy UI</a> - Bruce Lawson</li>\n<li><a href=\"http://www.html5rocks.com/en/tutorials/getusermedia/intro/\">Capturing Audio &amp; Video in HTML5</a> - Eric Bidelman</li>\n<li><a href=\"http://www.sitepoint.com/introduction-getusermedia-api/\">introduction to the getUserMedia API</a> - Aurelio De Rosa</li>\n</ul>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/html5-video-streaming/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Resizing and Cropping Images with Canvas",
    "partialText": "\r\n      <p>Learn how to resize and crop images using JavaScript and the HTML5 Canvas element using controls, commonly seen in photo editing applications.</p>\n<p>I published an article on the Codrops website: <a href=\"http://tympanus.net/codrops/2014/10/30/resizing-cropping-images-canvas/\">Resizing and Cropping Images with Canvas</a></p>\n<p>This tutorial focuses on the interaction and design aspects of this task rather than just the technical details of using Canvas for image resampling.</p>\n<p>I also recommend using this example with the FileReader and Drag and Drop APIs which are not covered in this tutorial.</p>\n<p>A huge thanks to Mary Lou (Manoela Ilic) for support with the design and much more!</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/resizing-and-cropping-images-with-canvas/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Understanding flexbox",
    "partialText": "\r\n      <p>Instead of covering all properties of Flexbox this article focuses on understanding how Flexbox calculates the width of items. The examples in this article are all in the context of a horizontal layout, but the same logic applies if you use a vertical layout.</p>\n<p>If you don't know what Flexbox is, it's a layout method best suited for distributing the available space inside a container, amongst child items, even when the number of child items, their size and even their DOM order is not known or might change. <a href=\"http://css-tricks.com/snippets/css/a-guide-to-flexbox/\">Have a look at this guide</a>, and <a href=\"http://codepen.io/MadeByMike/pen/26cb650eaef356da925e75139537f74e\">take a look at some examples</a> it might look like magic, but it's not, there is a method for calculating the size of child items.</p>\n<p>The full algorithm for working out a flexbox layout in any situation is <a href=\"http://dev.w3.org/csswg/css-flexbox/#layout-algorithm\">available here</a>, but as the spec rightly states:</p>\n<blockquote>Authors writing web pages should generally be served well by the individual property descriptions, and do not need to read this section unless they have a deep-seated urge to understand arcane details of CSS layout.</blockquote>\n<p>While this is true, I believe that designers and developers will still want to understand some parts of the layout algorithm. In particular so that they can roughly estimate width or height of flex items and confidently assign flex values without excessive trial and error.</p>\n<h2>How does it work?</h2>\n<p>Flexbox wants to fit in. If a flex item is allowed to be itself the flex-basis tells the browser what size it wants to be. Think of the flex-basis as a suggested size or ideal size. If a flex-basis is not set, or if it is set to 'auto', it will equal the initial size of the element. In other words, it will be the width of its inner content.</p>\n<p><strong>Note:</strong> If a flex item has borders, margin or padding these values need to be added to the flex-basis according to the current box-sizing method when calculating the remaining space. They should also be added to the values at the end of calculation to get the final outer width of each flex item.</p>\n<p>Once each flex-basis has been determined the browser adds these together along with any margins, borders or padding and checks to see if there is any space remaining in the container. If there is space remaining it will distribute this proportionally amongst the flex items, according to their flex-grow values. Similarly, if the space remaining is negative it will shrink each item proportionately, according to their flex-shrink values. Of course if the remaining space is 0, nothing more needs to be done.</p>\n<h3>Increasing the size of flex items (flex-growing)</h3>\n<p>When the combined size of all the flex items is less than their container, the remaining space is distributed amongst all the items. The flex-grow attribute is used to determine how the remaining space should be allocated. To work out how much space is allocated to each item, take the ratio of the item's flex-grow value, over the total of all the other flex-grow values in the same container and multiply this by the space remaining. Here is an example:</p>\n<div id=\"example-static-flex-1\" class=\"flex-container\">\n\t<div class=\"flex-item flex-item-1\"><span>Item 1</span></div>\n\t<div class=\"flex-item flex-item-2\"><span>Item 2</span></div>\n</div>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.flex-container</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 600px<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.flex-item-1</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 200px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">flex-grow</span><span class=\"token punctuation\">:</span> 3<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.flex-item-2</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 200px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">flex-grow</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<pre><code>Total basis: 400px\nSpace remaining: 200px\n\nItem 1 grow factor: 3/4 × 200px = 150px\nItem 2 grow factor: 1/4 × 200px = 50px\n</code></pre>\n<p>The space remaining is 200px, this is equal to the width of the flex container (600px) minus the total basis (400px). Of the remaining space (200px), ¾ (150px) is allocated to item 1 and ¼ (50px) to item 2.</p>\n<p>These fractions are determined by taking the items individual flex-grow value over the combined flex-grow value of all items. To get the final width of each item, add this result to the initial flex-basis (350px and 250px).</p>\n<p>To give another example; if both items had a flex-grow value of 1, or in any case where they had the same number, they would each be allocated half the remaining space. If one item had a value of 2 and the other 1, the first flex item would be allocated ⅔ of the remaining space and the other ⅓. This works the same with 3, 4, 5 or any number of items although obviously the fractions will differ.</p>\n<h3>Decreasing the size of flex items (flex-shrinking)</h3>\n<p>If the space remaining is a negative this means that the flex container is smaller than the preferred width of all the flex items. They are going to have to shrink. By assigning a flex-shrink value we can control much space each flex item will surrender.</p>\n<p>For some reason the method for working out flex shrink differs slightly and is a little harder.</p>\n<p>Rather than working out the ratio of an items flex-shrink value against the total of all flex-shrink values, for each item we first multiply its flex shrink value by its basis and then workout the ratio of this number against the sum of all flex-basis values, and multiply by the space remaining.</p>\n<div id=\"example-static-flex-2\" class=\"flex-container\">\n\t<div class=\"flex-item flex-item-1\"><span>Item 1</span></div>\n\t<div class=\"flex-item flex-item-2\"><span>Item 2</span></div>\n\t<div class=\"flex-item flex-item-3\"><span>Item 2</span></div>\n</div>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.flex-container</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 600px<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.flex-item-1</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 100px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">flex-shrink</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.flex-item-2</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 400px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">flex-shrink</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.flex-item-3</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 400px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">flex-shrink</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<pre><code>Total basis: 900px\nSpace remaining: -300px\n\nItem 1 shrink factor: (1 × 100) / (100px + 400px + 400px) = .111 × -300px = -33.333px\nItem 2 shrink factor: (1 × 400) / (100px + 400px + 400px) = .444 × -300px = -133.333px\nItem 3 shrink factor: (1 × 400) / (100px + 400px + 400px) = .444 × -300px = -133.333px\n</code></pre>\n<p>The space remaining is -300px, this is equal to the width of the flex container (600px) minus the total basis (900px). To find the shrink factor for each, multiply its flex-shrink value by its flex-basis value (1×100px or 1×400px), then divide this by the combined sum of the flex-shrink multiply the flex-basis for all items (1×100px) + (1×400px) + (1×400px).</p>\n<p>Finally multiply this number by the space remaining (-300px) to get the amount to reduce each item by (33.33px and 66.66px).</p>\n<p>In the above example if the flex shrink of the first item was to change to 2 the result would differ as follows:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.flex-container</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 600px<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.flex-item-1</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 100px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">flex-shrink</span><span class=\"token punctuation\">:</span> 2<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.flex-item-2</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 400px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">flex-shrink</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><span class=\"token selector\">.flex-item-3</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> 400px<span class=\"token punctuation\">;</span><br>  <span class=\"token property\">flex-shrink</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<pre><code>Total basis: 900px\nSpace remaining: -300px\n\nItem 1 shrink factor: (2 × 100) / (200px + 400px + 400px) = .2 × -300px = -60px\nItem 2 shrink factor: (1 × 400) / (200px + 400px + 400px) = .4 × -300px = -120px\nItem 3 shrink factor: (1 × 400) / (200px + 400px + 400px) = .4 × -300px = -120px\n</code></pre>\n<h2>More info</h2>\n<ul>\n<li>I built a little <a href=\"/demos/flexbox-tester/\">tool for testing flexbox calculations</a>,</li>\n<li>Chris Wright covers his <a href=\"http://chriswrightdesign.com/experiments/flexbox-adventures/\">adventures with flexbox</a>,</li>\n<li>Chris Coyier <a href=\"http://css-tricks.com/snippets/css/a-guide-to-flexbox/\">a Complete Guide to Flexbox</a>,</li>\n<li>Chris Mills, wrote a great <a href=\"https://dev.opera.com/articles/flexbox-basics/\">introduction to flexbox</a>,</li>\n<li>If you really must, every detail is available <a href=\"http://dev.w3.org/csswg/css-flexbox/#layout-algorithm\">in the spec</a></li>\n</ul>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/understanding-flexbox/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Merging JSON data sets",
    "partialText": "\r\n      <p>Merging deeply nested data in JSON is more difficult than it might seem.</p>\n<p>In the past I've used a brute force approach when dealing with small and well structured data. This approach proved completely inadequate for large volumes of real world data.</p>\n<p>Imagine we have a monthly darts competition and at the end of each month record the scores in a JSON file:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">data_jan <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"mike\"</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">:</span> <span class=\"token number\">47</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br>data_feb <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"mike\"</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">:</span> <span class=\"token number\">25</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n<p>(I have no clue what a darts score should look like)</p>\n<p>At this level getting mike's total score is trivial <code>data_jan.score + data_feb.score</code>. But if we add more players, more months or more data getting totals quickly becomes a bit more involved.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">data_jan <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><br>  <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"mike\"</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">:</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> team<span class=\"token operator\">:</span> <span class=\"token string\">\"A\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br>  <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"jill\"</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">:</span> <span class=\"token number\">51</span><span class=\"token punctuation\">,</span> team<span class=\"token operator\">:</span> <span class=\"token string\">\"B\"</span> <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><br>data_feb <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><br>  <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"mike\"</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">:</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> team<span class=\"token operator\">:</span> <span class=\"token string\">\"A\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br>  <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"jill\"</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">:</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> team<span class=\"token operator\">:</span> <span class=\"token string\">\"B\"</span> <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Your first instinct might be to find all the players then for each player, loop over all the months, find score and add this to the current players total.</p>\n<p>With help from something like <a href=\"http://jquery.com/\">jQuery</a> or <a href=\"http://underscorejs.org/\">Underscore</a>, enough nested loops and liberal use filter and map statements you might get a result.</p>\n<p>This will work until you run into some real world situations like players absent or a need for both team and player totals. In short this type of solution is a bit of a house of cards.</p>\n<p>Thinking more about the problem I soon realised that it is similar to the use case for <code>.extend()</code> that both jQuery and Underscore provide. The only difference is I want control when merging so that I can change values and not just overwrite.</p>\n<p>It was eventually suggested that I checkout <a href=\"http://lodash.com/\">Lodash</a> and I found the <code>.merge()</code> function allows a callback for data manipulation. So to get player totals all we need is:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">_<span class=\"token punctuation\">.</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>data_jan<span class=\"token punctuation\">,</span> data_feb<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">.</span><span class=\"token function\">isNumber</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> _<span class=\"token punctuation\">.</span><span class=\"token function\">isNumber</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token keyword\">return</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>This is much faster and easier to follow than nested loops.</p>\n<p>One small downside is you can only merge 2 objects at a time and my only other complaint is I don't have access to the key in the callback.</p>\n<p>Bonus: If you are using Underscore, Lodash is almost a one for one replacement so it's easy to switch.</p>\n<p><strong>Update</strong></p>\n<p>If you're using jQuery and do not want to add another library to the mix I wrote a jQuery extension to merge objects:</p>\n<p><a href=\"https://gist.github.com/MadeByMike/e57dd16797acf5d105b5\">https://gist.github.com/MadeByMike/e57dd16797acf5d105b5</a></p>\n<p>It works much like <code>jQuery.extend()</code> however the first parameter is an array containing the objects to merge. The 2nd parameter is a callback that allows you to modify the data while merging.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">$<span class=\"token punctuation\">.</span><span class=\"token function\">mergeObjects</span><span class=\"token punctuation\">(</span>merge_array<span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>E.g.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">merge_array <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"mike\"</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">:</span> <span class=\"token number\">47</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"mike\"</span><span class=\"token punctuation\">,</span> score<span class=\"token operator\">:</span> <span class=\"token number\">11</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><br>$<span class=\"token punctuation\">.</span><span class=\"token function\">mergeObjects</span><span class=\"token punctuation\">(</span>merge_array<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>$<span class=\"token punctuation\">.</span><span class=\"token function\">isNumeric</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> $<span class=\"token punctuation\">.</span><span class=\"token function\">isNumeric</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token keyword\">return</span> b<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token comment\">// Will return: { \"name\": \"mike\", \"score\": 58}</span></code></pre>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/merging-json-data-sets/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Accessible contrast with Less and Sass",
    "partialText": "\r\n      <p>Contrast is a critical factor in web design, it's important to get right because it has a strong influence on the visual aesthetic, but it's especially important for readability and accessibility of text on the page.</p>\n<p>It's not a revolutionary idea to suggest that we use Less or Sass to help choose an appropriate text color for a particular background. There are plenty of examples of this, but what is the best way?</p>\n<p>Most examples I've seen work on the general principle that, if a background color is &quot;brighter&quot; than 50% give me black text, otherwise give me white text.</p>\n<p>But what does &quot;brighter&quot; mean? It depends on the implementation. There are different ways to measure the brightness of a color. Common methods include:</p>\n<ul>\n<li>Lightness - the lightness channel of the HSL color space.</li>\n<li>Value - the value channel of the HSV color space.</li>\n<li>Luminance - the perceptual brightness of a color.</li>\n</ul>\n<p>Recently I've been experimenting with different implementations of text contrast mixins using Less and Sass. I've created examples for each method and evaluated them on their ability to meet required WCAG2 contrast ratios.</p>\n<p>I found none of the simple methods give a guaranteed accessible result, but it is possible using only Less or Sass to create a mixin that will give desired contrast ratios including WCAG2 AA or AAA level.</p>\n<h2>HSL based measurement</h2>\n<p>Unfortunately it seems <strong>the most common implementation</strong> which is based on lightness, <strong>is the worst visual performer</strong>. In the demo below <code>#7CFC00</code> is a particularly good example of where the HSL method fails.</p>\n<p data-height=\"400\" data-theme-id=\"light\" data-slug-hash=\"qjlpF\" data-default-tab=\"result\" class='codepen'>See the Pen <a href='http://codepen.io/MadeByMike/pen/qjlpF/'>Contrast black\\white - lightness (Sass)</a> by Mike (<a href='http://codepen.io/MadeByMike'>@MadeByMike</a>) on <a href='http://codepen.io'>CodePen</a>.</p>\n<script async src=\"//codepen.io/assets/embed/ei.js\"></script>\n<p>This example uses Sass, do you prefer Less? <a href=\"http://codepen.io/MadeByMike/pen/qjlpF\">Got you covered</a>!</p>\n<h2>HSV based measurement</h2>\n<p>My feeling is that HSV provides slightly better results than HSL, but it is still far from perfect. In this demo #0000CD and #8B0000 are two good examples of where HSV measurement fails.</p>\n<p data-height=\"400\" data-theme-id=\"light\" data-slug-hash=\"hqvod\" data-default-tab=\"result\" class='codepen'>See the Pen <a href='http://codepen.io/MadeByMike/pen/hqvod/'>Contrast black\\white - value (Less)</a> by Mike (<a href='http://codepen.io/MadeByMike'>@MadeByMike</a>) on <a href='http://codepen.io'>CodePen</a>.</p>\n<script async src=\"//codepen.io/assets/embed/ei.js\"></script>\nSorry Sass people, Sass has no HSV functions :(\n<h2>Luminance based measurement</h2>\n<p>Luminance is the perceived brightness of a color and as expected it was the best performer of the three methods tested.</p>\n<p>In general I'd say these results are reasonably good. The correct color is usually picked and the text is generally readable. But closer scrutiny shows that they often don't meet <a href=\"http://www.w3.org/TR/WCAG20/#visual-audio-contrast-contrast\">WCAG 2.0 requirements</a> for text contrast.</p>\n<p data-height=\"400\" data-theme-id=\"light\" data-slug-hash=\"jJFqI\" data-default-tab=\"result\" class=\"codepen\">See the Pen <a href='http://codepen.io/MadeByMike/pen/jJFqI/'>Contrast black\\white - luma (Less)</a> by Mike (<a href='http://codepen.io/MadeByMike'>@MadeByMike</a>) on <a href='http://codepen.io'>CodePen</a>.</p>\n<script async src=\"//codepen.io/assets/embed/ei.js\"></script>\n<p>This examples uses Less, is Sass more your thing? <a href=\"http://codepen.io/MadeByMike/pen/FoBjq\">Got you covered</a>!</p>\n<p>Less has built-in luminance functions but Sass requires a little extra help.</p>\n<p>Calculating luminance in Sass using the <a href=\"http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\">w3c formula for relative luminance</a> requires the <code>pow</code> function, which is available only with <a href=\"http://compass-style.org/\">compass</a>.</p>\n<p>I'm not sure exactly how Less calculates luminance but in my tests there was only one difference I could find (#9ACD32).</p>\n<h2>Measured contrast ratios</h2>\n<p>So none of the simple methods work and using only black and white text is somewhat limiting anyway. What if we could measure the contrast ratios and progressively increase the lightness and darkness until a desired contrast ratio is met?</p>\n<p>Wait, we can do that! In this demo the acceptable contrast ratio is set to 4.5 (WCAG AA compliance). If the desired contrast ratio can not be met, either black or white is returned using the luminance method.</p>\n<p>I believe this method is by far the most useful. It can take a little time to compile, although in most situations you probably won't notice and if you're after guaranteed contrast ratios, this is the only option. No more <code>text-color</code> variables!</p>\n<p data-height=\"400\" data-theme-id=\"light\" data-slug-hash=\"sDpxg\" data-default-tab=\"result\" class='codepen'>See the Pen <a href='http://codepen.io/MadeByMike/pen/sDpxg/'> Contrast - WCAG compliant (Sass)</a> by Mike (<a href='http://codepen.io/MadeByMike'>@MadeByMike</a>) on <a href='http://codepen.io'>CodePen</a>.</p>\n<script async src=\"//codepen.io/assets/embed/ei.js\"></script>\n<p>Prefer Less? <s>Sorry :( I think I may have finally found something I can do with Sass that I can't do with Less, although I haven't given up yet!</s></p>\n<p>It turns out this is possible to do with Less although I can't say I like the method. Consider this <a href=\"http://codepen.io/MadeByMike/pen/rguCF\">proof of concept</a> only.</p>\n<h2>Contrast ratios with any color scheme</h2>\n<p>By default when you pass only one color to the mixin the results are in the same tonal range as the background color. This produces a monochromatic color scheme, however the function accepts a 2nd parameter, allowing a different starting point for the text color.</p>\n<p>You can produce a range of <a href=\"http://codepen.io/MadeByMike/pen/dqxCB\">mathamatically determined color schemes</a> or you could just pick any color and let anarchy rule.</p>\n<h2>Usage</h2>\n<div class=\"special-attention\">\n<p>Again we're calculating luminance in Sass which requires the <code>pow</code> function, so you will need <a href=\"http://compass-style.org/\">compass</a>.</p>\n</div>\n<p>Drop the following functions into your Sass stylesheets.</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token keyword\">@function</span> <span class=\"token function\">luma</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token comment\">// Thanks voxpelli for a very concise implementation of luminance measure in sass</span><br>  <span class=\"token comment\">// Adapted from: https://gist.github.com/voxpelli/6304812</span><br>  <span class=\"token property\"><span class=\"token variable\">$rgba</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">red</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">green</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">blue</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\"><span class=\"token variable\">$rgba2</span></span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token keyword\">@for</span> <span class=\"token variable\">$i</span> <span class=\"token keyword\">from</span> 1 <span class=\"token keyword\">through</span> <span class=\"token selector\">3 </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\"><span class=\"token variable\">$rgb</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rgba</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token property\"><span class=\"token variable\">$rgb</span></span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$rgb</span> <span class=\"token operator\">/</span> 255<span class=\"token punctuation\">;</span><br>    <span class=\"token property\"><span class=\"token variable\">$rgb</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rgb</span> <span class=\"token operator\">&lt;</span> 0.03928<span class=\"token punctuation\">,</span> <span class=\"token variable\">$rgb</span> <span class=\"token operator\">/</span> 12.92<span class=\"token punctuation\">,</span> <span class=\"token function\">pow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rgb</span> <span class=\"token operator\">+</span> 0.055<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> 1.055<span class=\"token punctuation\">,</span> 2.4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token property\"><span class=\"token variable\">$rgba2</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rgba2</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$rgb</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token keyword\">@return</span> <span class=\"token punctuation\">(</span><br>      0.2126 <span class=\"token operator\">*</span> <span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rgba2</span><span class=\"token punctuation\">,</span> 1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> 0.7152 <span class=\"token operator\">*</span> <span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rgba2</span><span class=\"token punctuation\">,</span> 2<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> 0.0722 <span class=\"token operator\">*</span> <span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rgba2</span><span class=\"token punctuation\">,</span> 3<span class=\"token punctuation\">)</span><br>    <span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> 100<span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token keyword\">@function</span> contrast_<span class=\"token function\">ratio</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color1</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$color2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\"><span class=\"token variable\">$luma1</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">luma</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> 5<span class=\"token punctuation\">;</span><br>  <span class=\"token property\"><span class=\"token variable\">$luma2</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">luma</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> 5<span class=\"token punctuation\">;</span><br>  <span class=\"token property\"><span class=\"token variable\">$ratio</span></span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$luma1</span> <span class=\"token operator\">/</span> <span class=\"token variable\">$luma2</span><span class=\"token punctuation\">;</span><br>  <span class=\"token keyword\">@if</span> <span class=\"token selector\"><span class=\"token variable\">$luma1</span> &lt; <span class=\"token variable\">$luma2</span> </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\"><span class=\"token variable\">$ratio</span></span><span class=\"token punctuation\">:</span> 1 <span class=\"token operator\">/</span> <span class=\"token variable\">$ratio</span><span class=\"token punctuation\">;</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token keyword\">@return</span> <span class=\"token variable\">$ratio</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token keyword\">@function</span> <span class=\"token function\">text-contrast</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color</span><span class=\"token punctuation\">,</span> <span class=\"token property\"><span class=\"token variable\">$bgcolor</span></span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$color</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token property\"><span class=\"token variable\">$threshold</span></span><span class=\"token punctuation\">:</span> 4.5<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 4.5 = WCAG AA,7= WCAG AAA</span><br>  <span class=\"token property\"><span class=\"token variable\">$list</span></span><span class=\"token punctuation\">:</span> 20 30 40 50 60 70 80 90 100<span class=\"token punctuation\">;</span><br>  <span class=\"token keyword\">@each</span> <span class=\"token selector\"><span class=\"token variable\">$percent</span> in <span class=\"token variable\">$list</span> </span><span class=\"token punctuation\">{</span><br>    <span class=\"token property\"><span class=\"token variable\">$lighter</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">lighten</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$bgcolor</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$percent</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token property\"><span class=\"token variable\">$darker</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">darken</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$bgcolor</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$percent</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token property\"><span class=\"token variable\">$darker-ratio</span></span><span class=\"token punctuation\">:</span> contrast_<span class=\"token function\">ratio</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$darker</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token property\"><span class=\"token variable\">$lighter-ratio</span></span><span class=\"token punctuation\">:</span> contrast_<span class=\"token function\">ratio</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$lighter</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>    <span class=\"token keyword\">@if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$lighter-ratio</span> <span class=\"token operator\">></span> <span class=\"token variable\">$darker-ratio</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>      <span class=\"token keyword\">@if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$lighter-ratio</span> <span class=\"token operator\">></span> <span class=\"token variable\">$threshold</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>        <span class=\"token keyword\">@return</span> <span class=\"token variable\">$lighter</span><span class=\"token punctuation\">;</span><br>      <span class=\"token punctuation\">}</span><br>    <span class=\"token punctuation\">}</span><br>    <span class=\"token keyword\">@if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$darker-ratio</span> <span class=\"token operator\">></span> <span class=\"token variable\">$lighter-ratio</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>      <span class=\"token keyword\">@if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$darker-ratio</span> <span class=\"token operator\">></span> <span class=\"token variable\">$threshold</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>        <span class=\"token keyword\">@return</span> <span class=\"token variable\">$darker</span><span class=\"token punctuation\">;</span><br>      <span class=\"token punctuation\">}</span><br>    <span class=\"token punctuation\">}</span><br>  <span class=\"token punctuation\">}</span><br>  <span class=\"token keyword\">@return</span> <span class=\"token function\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">lightness</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> 51<span class=\"token punctuation\">,</span> #fff<span class=\"token punctuation\">,</span> #000<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Call the <code>text-contrast()</code> function and pass it the background color:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.my-element </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$backgroud-color</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">text-contrast</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$backgroud-color</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>Optionally, pass a second parameter to control the text color:</p>\n<pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.my-element </span><span class=\"token punctuation\">{</span><br>  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$backgroud-color</span><span class=\"token punctuation\">;</span><br>  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">text-contrast</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$backgroud-color</span><span class=\"token punctuation\">,</span> DarkSalmon<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<h3>Alternatives to compass</h3>\n<p>Need an alternative to compass? Voxpelli has a <a href=\"https://gist.github.com/voxpelli/6304812#file-_math-scss\">pure sass alternative</a> for the <code>pow</code> function.</p>\n<p>The w3c also has an alternative <a href=\"http://www.w3.org/WAI/ER/WD-AERT/#color-contrast\">formula for measuring brightness</a>. My <a href=\"http://codepen.io/MadeByMike/pen/fwrhD\">experiments with this method</a> found it is not adequate for measured contrast ratios, but the results were often reasonable.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/accessible-contrast-with-less-and-sass/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Detecting transition start",
    "partialText": "\r\n      <p>If you've worked with the css transition events in JavaScript you will know that it's a little involved due to the need for multiple browser prefixes. Luckily it's easy, if slightly verbose, to detect which transition event to use:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Dave Walsh says this is from Modernizr, but I can't find it</span><br><span class=\"token comment\">// http://davidwalsh.name/css-animation-callback</span><br><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">whichTransitionEvent</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  <span class=\"token keyword\">var</span> t<span class=\"token punctuation\">;</span><br>  <span class=\"token keyword\">var</span> el <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fakeelement\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>  <span class=\"token keyword\">var</span> transitions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><br>    transition<span class=\"token operator\">:</span> <span class=\"token string\">\"transitionend\"</span><span class=\"token punctuation\">,</span><br>    OTransition<span class=\"token operator\">:</span> <span class=\"token string\">\"oTransitionEnd\"</span><span class=\"token punctuation\">,</span><br>    MozTransition<span class=\"token operator\">:</span> <span class=\"token string\">\"transitionend\"</span><span class=\"token punctuation\">,</span><br>    WebkitTransition<span class=\"token operator\">:</span> <span class=\"token string\">\"webkitTransitionEnd\"</span><br>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>t <span class=\"token keyword\">in</span> transitions<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">[</span>t<span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>      <span class=\"token keyword\">return</span> transitions<span class=\"token punctuation\">[</span>t<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><br>    <span class=\"token punctuation\">}</span><br>  <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">var</span> transitionEvent <span class=\"token operator\">=</span> <span class=\"token function\">whichTransitionEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><br><span class=\"token comment\">// With that sorted...</span><br><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transitionEvent<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span>transitionEvent<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token comment\">// do stuff here</span><br>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>We need to check if <code>transitionEvent</code> exists before adding an event listener and whilst this isn't too hard, we could take this a step further and wrap it with a custom event <code>'transition-end'</code>. See: <a href=\"https://gist.github.com/MadeByMike/0563ca51e08a790e553b\">example gist</a>.</p>\n<p>My reason for this extra step, apart from easy of use, relates to detecting transition start.</p>\n<h2>What about transition start?</h2>\n<p>Unfortunately there is no transition start event and it might at first seem like this is not much of a problem. A css transition is usually triggered by an event such as resize or hover and these events can be captured with JavaScript. But that is not always the case, at times it is difficult if not impossible to tell when a particular transition is triggered.</p>\n<p>The following example demonstrates a likely use case with the popular Foundation library and the <a href=\"http://foundation.zurb.com/docs/components/equalizer.html\">Equalizer</a> component.</p>\n<p data-height=\"650\" data-theme-id=\"6646\" data-slug-hash=\"ImxHA\" data-default-tab=\"result\" class='codepen'>See the Pen <a href='http://codepen.io/MadeByMike/pen/ImxHA/'>Foundation Equalizer and the problem with CSS Transitions</a> by Mike (<a href='http://codepen.io/MadeByMike'>@MadeByMike</a>) on <a href='http://codepen.io'>CodePen</a>.</p>\n<script async src=\"//codepen.io/assets/embed/ei.js\"></script>\n<p>In the demo Equalizer changes the boxes so they are even height. The height is re-calculated when the browser is resized, but when the container is resized as part of a css transition the height will not be re-calculated and content will overflow the boxes.</p>\n<p>I've exaggerated the transitions in the example to demonstrate.</p>\n<p>Detecting transtionend and calling <code>$(document).foundation('equalizer','reflow');</code> will set the height correctly at the end of the transition but it is not a smooth experience.</p>\n<p>Although not the ideal method I'd like, I've come up with a solution for detecting transition start. By wrapping the transitionend event with a custom event we can use transitionend in a sneaky way to detect a transition start.</p>\n<p data-height=\"500\" data-theme-id=\"6646\" data-slug-hash=\"sBjzn\" data-default-tab=\"result\" class='codepen'>See the Pen <a href='http://codepen.io/MadeByMike/pen/sBjzn/'>Detect transition start </a> by Mike (<a href='http://codepen.io/MadeByMike'>@MadeByMike</a>) on <a href='http://codepen.io'>CodePen</a>.</p>\n<script async src=\"//codepen.io/assets/embed/ei.js\"></script>\n<p>As I said, it is not ideal. It requires some specific css with a 0.00001s transition to detect the transition start.</p>\n<p>I'm looking forward to finding a better method. If you do let me know.</p>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/detecting-transition-start/"
  },
  {
    "publisherId": "madebymike",
    "publisherName": "Mike Riethmuller",
    "specTitle": "CSS/반응형",
    "categories": [
      "frontend"
    ],
    "specUrl": "https://www.madebymike.com.au/feed.xml",
    "title": "Thoughts on design patters in CSS",
    "partialText": "\r\n      <p>Typically when we begin a new web project we start by creating a number of directories for CSS, JavaScript and other resources. This task hasn't changed much and it's a typical step for most developers. In many cases, this structure is a non-optional part of the workflow enforced by scaffolding tools like <a href=\"http://yeoman.io/\">yeoman</a>, an MVC framework or a <a href=\"http://html5boilerplate.com/\">boilerplate</a>.</p>\n<p>Reasons behind it relate to the well-established principle <a href=\"http://en.wikipedia.org/wiki/Separation_of_concerns\">separation of concerns</a>. In web development we get separation of concerns for free. It is built into the difference between HTML, CSS and JavaScript, each relating to content, presentation, and behaviour respectively.</p>\n<p>Despite the importance of this principal, I've found that simple separation of CSS, JavaScript and resources within a project folder, is increasingly inadequate - especially for larger projects, and I'm starting to think there might be a better way.</p>\n<p>This change of thinking started with <a href=\"https://github.com/stubbornella/oocss/wiki\">object oriented CSS</a>, and <a href=\"http://bem.info/\">BEM</a> methodologies. These ideas changed the way I think about different components on the screen and Brad Frost's concept of <a href=\"http://bradfrostweb.com/blog/post/atomic-web-design/\">Atomic</a> <a href=\"http://patternlab.io/about.html\">Design</a>, perfectly articulates the evolution of this thinking.</p>\n<p>These ideas changed the way I structure my CSS, but it wasn't until I started using build tools in my front-end development workflow to generate API references and documentation, that I started to realise some limitations of the typical project structure. I suspect that these limitations may become even more apparent with the take-up of <a href=\"http://css-tricks.com/modular-future-web-components\">web components</a>.</p>\n<p>One of the problems I see is that components we think of are not really isolated. If you need to remove something you need to find the scripts, the styles, each of the resources, remove import statements if you are using a CSS pre compiler and perhaps update your build script. You often still don’t know if any of the resources are shared between components.</p>\n<p>How we structure our projects is now often at odds with our thinking and how we set out API references, style guides, pattern libraries and other documentation. You have all of those right?</p>\n<p>I’m starting to suspect (and I reserve the right to be wrong) that with modern build tools we have today, we can structure projects to better reflect our modular thinking.</p>\n<p>I'm not suggesting that separation of concerns is no longer relevant, not at all, but separation can exist at a component level and while the end result might look much like a traditional project, this doesn't have to be the case for development.</p>\n<p>Recently I’ve been experimenting with having each of the styles, scripts and resources inside a unique folder per component.</p>\n<p>So far this approach has worked well for any project that involves developing a component library, which means most websites.</p>\n<p>Doing it this way you can keep better track of resources related to the component I'm working on. You can keep examples and documentation in the same folder and update them whenever you work on that component. You can even keep test libraries and other files close to the source. However the biggest advantage is you can easily and confidently remove a component simply by removing the folder.</p>\n<p>Of course, there are some limitations -it’s not always obvious what represents a component. Smaller components must be grouped together and things like mixins and resets might also represent unique components in this structure. It’s always not easy to follow a rule, sometimes just decide what works best.</p>\n<p>If including 3rd party libraries, you may have to refactor them or make exceptions when they don't fit the structure you're using -although this can be the case in any project.</p>\n<p>Advantages of projects structured around components:</p>\n<ul>\n<li>It's easy to update and remove components</li>\n<li>Components become more portable between projects</li>\n<li>It encourages modular thinking and development practise</li>\n<li>It's easy for outsiders and non-technical people to understand</li>\n<li>Faster</li>\n</ul>\n<p>Disadvantages of projects structured around components:</p>\n<ul>\n<li>More complicated build scripts</li>\n<li>Components must be largely independent of each other</li>\n<li>3rd party libraries are sometimes difficult to include</li>\n</ul>\n\r\n    ",
    "date": "2026-02-18T02:02:31.940Z",
    "url": "/writing/thoughts-on-design-patterns-in-css/"
  }
]